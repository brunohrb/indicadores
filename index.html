<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TEXNET - Dashboard Financeiro</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <style>
    :root {
      --primary: #2563eb; --success: #10b981; --warning: #f59e0b;
      --danger: #ef4444; --info: #06b6d4; --bg-primary: #ffffff;
      --bg-secondary: #f8fafc; --text-primary: #1e293b;
      --text-secondary: #64748b; --sidebar-bg: #1e293b;
      --sidebar-width: 260px; --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1); --radius-lg: 12px;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif; background:var(--bg-secondary); color:var(--text-primary); line-height:1.6; }
    .sidebar { position:fixed; left:0; top:0; width:var(--sidebar-width); height:100vh; background:var(--sidebar-bg); display:flex; flex-direction:column; z-index:1000; }
    .sidebar-header { padding:1.5rem; border-bottom:1px solid rgba(255,255,255,0.1); }
    .logo { display:flex; align-items:center; gap:0.75rem; color:white; font-size:1.25rem; font-weight:700; }
    .logo-icon { font-size:2rem; }
    .sidebar-nav { flex:1; padding:1rem; overflow-y:auto; }
    .nav-item { display:flex; align-items:center; gap:0.75rem; padding:0.75rem 1rem; color:#cbd5e1; border-radius:8px; margin-bottom:0.25rem; cursor:pointer; transition:all 0.3s; }
    .nav-item:hover { background:#334155; color:white; }
    .nav-item.active { background:var(--primary); color:white; }
    .nav-icon { font-size:1.25rem; }
    .sidebar-footer { padding:1rem 1.5rem; border-top:1px solid rgba(255,255,255,0.1); font-size:0.875rem; color:#cbd5e1; }
    .main-content { margin-left:var(--sidebar-width); min-height:100vh; }
    .header { background:var(--bg-primary); padding:1.5rem 2rem; box-shadow:var(--shadow-sm); position:sticky; top:0; z-index:100; }
    .header-top { display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem; }
    .page-title { font-size:1.5rem; font-weight:600; }
    .page-subtitle { font-size:0.875rem; color:var(--text-secondary); margin-top:0.25rem; }
    .filters-container { display:flex; gap:1rem; align-items:center; flex-wrap:wrap; }
    .filter-group { display:flex; align-items:center; gap:0.5rem; }
    .filter-label { font-size:0.875rem; color:var(--text-secondary); font-weight:500; }
    select, input[type="month"] { padding:0.5rem 1rem; border:1px solid #e2e8f0; border-radius:8px; font-size:0.875rem; background:white; cursor:pointer; transition:all 0.3s; }
    select:focus, input[type="month"]:focus { outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(37,99,235,0.1); }
    .btn { padding:0.5rem 1rem; border:none; border-radius:8px; font-size:0.875rem; font-weight:500; cursor:pointer; transition:all 0.3s; }
    .btn-primary { background:var(--primary); color:white; }
    .btn-primary:hover { background:#1d4ed8; }
    .badge { padding:0.5rem 1rem; border-radius:20px; font-size:0.875rem; font-weight:600; display:inline-flex; align-items:center; gap:0.5rem; }
    .badge-success { background:#dcfce7; color:#166534; }
    .content { padding:2rem; }
    .stats-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:1.5rem; margin-bottom:2rem; }
    .stat-card { background:var(--bg-primary); padding:1.5rem; border-radius:var(--radius-lg); box-shadow:var(--shadow-sm); transition:all 0.3s; position:relative; overflow:hidden; }
    .stat-card:hover { box-shadow:var(--shadow-md); transform:translateY(-2px); }
    .stat-card::before { content:''; position:absolute; top:0; left:0; width:4px; height:100%; background:var(--card-color); }
    .stat-header { display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:1rem; }
    .stat-title { font-size:0.875rem; color:var(--text-secondary); font-weight:500; }
    .stat-icon { width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:1.5rem; }
    .stat-value { font-size:2rem; font-weight:700; margin-bottom:0.5rem; }
    .stat-footer { display:flex; justify-content:space-between; align-items:center; font-size:0.875rem; }
    .stat-change.positive { color:var(--success); }
    .stat-change.negative { color:var(--danger); }
    .tabs { display:flex; gap:0.5rem; margin-bottom:1.5rem; border-bottom:2px solid #e2e8f0; flex-wrap:wrap; }
    .tab-btn { padding:0.75rem 1.5rem; background:none; border:none; border-bottom:2px solid transparent; margin-bottom:-2px; font-size:0.875rem; font-weight:500; color:var(--text-secondary); cursor:pointer; transition:all 0.3s; }
    .tab-btn:hover { color:var(--primary); }
    .tab-btn.active { color:var(--primary); border-bottom-color:var(--primary); }
    .chart-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(450px,1fr)); gap:1.5rem; margin-bottom:2rem; }
    .chart-card { background:var(--bg-primary); padding:1.5rem; border-radius:var(--radius-lg); box-shadow:var(--shadow-sm); }
    .chart-header { margin-bottom:1.5rem; }
    .chart-title { font-size:1.125rem; font-weight:600; }
    .chart-subtitle { font-size:0.875rem; color:var(--text-secondary); margin-top:0.25rem; }
    .chart-container { position:relative; height:300px; }
    .table-container { background:var(--bg-primary); border-radius:var(--radius-lg); box-shadow:var(--shadow-sm); overflow:hidden; margin-bottom:2rem; }
    .table-header { padding:1.5rem; border-bottom:1px solid #e2e8f0; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:1rem; }
    .table-title { font-size:1.125rem; font-weight:600; }
    #tableContent, #indicadoresTableContent { overflow-x:auto; }
    table { width:100%; border-collapse:collapse; min-width:1400px; }
    thead { background:var(--bg-secondary); }
    th { padding:1rem; text-align:left; font-size:0.875rem; font-weight:600; color:var(--text-secondary); text-transform:uppercase; letter-spacing:0.05em; white-space:nowrap; }
    th:first-child, td:first-child { position:sticky; left:0; background:var(--bg-primary); z-index:10; min-width:200px; }
    thead th:first-child { background:var(--bg-secondary); z-index:15; }
    td { padding:1rem; border-bottom:1px solid #e2e8f0; font-size:0.875rem; }
    tr:hover { background:var(--bg-secondary); }
    .value-cell { text-align:right; font-variant-numeric:tabular-nums; }
    .negative-value { color:var(--danger); }
    .positive-value { color:var(--success); }
    .total-row { background:var(--bg-secondary); font-weight:600; }
    .total-row td { padding:1.25rem 1rem; border-bottom:3px solid var(--primary); }
    .total-row td:first-child { background:var(--bg-secondary); }
    .category-row { background:#f1f5f9; font-weight:600; cursor:pointer; user-select:none; }
    .category-row:hover { background:#e2e8f0; }
    .category-row td:first-child { background:#f1f5f9; }
    .expand-icon { display:inline-block; width:16px; height:16px; transition:transform 0.2s; }
    .expand-icon.expanded { transform:rotate(90deg); }
    .sub-item { background:white; }
    .sub-item.hidden { display:none; }
    .sub-item td:first-child { padding-left:3rem; background:white; }
    .view-container { display:none; }
    .view-container.active { display:block; }
    .year-btn { padding:0.75rem 1.5rem; border:2px solid #e2e8f0; background:white; border-radius:8px; cursor:pointer; font-weight:500; transition:all 0.3s; }
    .year-btn:hover { border-color:var(--primary); }
    .year-btn.active { background:var(--primary); color:white; border-color:var(--primary); }
    .comparison-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:1.5rem; margin-bottom:2rem; }
    .comparison-card { background:var(--bg-primary); padding:1.5rem; border-radius:var(--radius-lg); box-shadow:var(--shadow-sm); }
    .comparison-card-title { font-size:1rem; font-weight:600; margin-bottom:1rem; }
    .comparison-item { display:flex; justify-content:space-between; align-items:center; padding:0.75rem 0; border-bottom:1px solid #e2e8f0; }
    .comparison-item:last-child { border-bottom:none; }
    .comparison-label { font-size:0.875rem; color:var(--text-secondary); }
    .comparison-value { font-weight:600; text-align:right; }
    .comparison-value.positive { color:var(--success); }
    .comparison-value.negative { color:var(--danger); }
    .comparison-variation { font-size:0.75rem; margin-top:0.25rem; color:var(--text-secondary); }
    .positive { background:rgba(16,185,129,0.05); }
    .negative { background:rgba(239,68,68,0.05); }
    .modal-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:2000; justify-content:center; align-items:center; }
    .modal-overlay.active { display:flex; }
    .modal-content { background:white; width:98%; max-width:2000px; max-height:95vh; border-radius:16px; overflow:hidden; display:flex; flex-direction:column; }
    .modal-header { padding:1.5rem 2rem; background:linear-gradient(135deg,var(--primary),#1d4ed8); color:white; display:flex; justify-content:space-between; align-items:center; }
    .modal-title { font-size:1.5rem; font-weight:700; }
    .modal-close { background:rgba(255,255,255,0.2); border:none; color:white; width:40px; height:40px; border-radius:50%; cursor:pointer; font-size:1.5rem; display:flex; align-items:center; justify-content:center; }
    .modal-body { padding:2rem; overflow-y:auto; flex:1; }
    .consolidado-filtro { display:flex; align-items:center; gap:0.75rem; margin-bottom:1.5rem; }
    .consolidado-filtro label { font-size:0.875rem; font-weight:500; color:var(--text-secondary); }
    .btn-detalhar { background:var(--primary); color:white; border:none; padding:0.35rem 0.75rem; border-radius:6px; font-size:0.75rem; font-weight:500; cursor:pointer; margin-left:0.5rem; display:inline-flex; align-items:center; gap:0.25rem; }
    .geogrid-container { width:100%; height:calc(100vh - 140px); background:white; border-radius:12px; overflow:hidden; position:relative; }
    .geogrid-header { padding:1.5rem 2rem; display:flex; align-items:center; gap:1rem; }
    .geogrid-icon { font-size:2rem; }
    .geogrid-iframe { width:100%; height:calc(100% - 76px); border:none; }
    .iframe-loading { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center; color:#64748b; display:none; }
    .iframe-loading.active { display:block; }
    .loading-spinner { width:50px; height:50px; border:5px solid #e2e8f0; border-top:5px solid #10b981; border-radius:50%; animation:spin 1s linear infinite; margin:0 auto 1rem; }
    @keyframes spin { 0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)} }
  </style>
</head>
<body>
  <!-- Hamburguer mobile -->
  <button id="menuToggle" onclick="toggleSidebar()" aria-label="Menu">☰</button>
  <div id="sidebarOverlay" onclick="toggleSidebar()"></div>
<!-- MARCOS: definido 1x, reutilizado com <use> -->
<svg style="display:none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <clipPath id="faceClipU"><circle cx="50" cy="33" r="32"/></clipPath>
    <symbol id="marcosSymbol" viewBox="0 0 100 165">
      <style>
        .mHead { animation:headBobU 0.5s ease-in-out infinite alternate; transform-origin:50px 33px; transition:transform 0.25s cubic-bezier(0.34,1.56,0.64,1); }
        .mBody { animation:bodyBobU 0.5s ease-in-out infinite alternate, bodyShakeU 1s ease-in-out infinite; transform-origin:50px 88px; }
        .mLA   { animation:leftArmU 0.5s ease-in-out infinite alternate; transform-origin:38px 70px; }
        .mRA   { animation:rightArmU 0.5s ease-in-out infinite alternate; transform-origin:62px 70px; }
        .mLL   { animation:leftLegU 0.5s ease-in-out infinite alternate; transform-origin:44px 106px; }
        .mRL   { animation:rightLegU 0.5s ease-in-out infinite alternate; transform-origin:56px 106px; }
        @keyframes bodyBobU   { from{transform:translateY(0)} to{transform:translateY(4px)} }
        @keyframes bodyShakeU { 0%{transform:rotate(-2deg)} 50%{transform:rotate(2deg)} 100%{transform:rotate(-2deg)} }
        @keyframes headBobU   { from{transform:translateY(0) rotate(-5deg)} to{transform:translateY(4px) rotate(5deg)} }
        @keyframes leftArmU   { from{transform:rotate(-55deg)} to{transform:rotate(20deg)} }
        @keyframes rightArmU  { from{transform:rotate(20deg)}  to{transform:rotate(-55deg)} }
        @keyframes leftLegU   { from{transform:rotate(-22deg)} to{transform:rotate(12deg)} }
        @keyframes rightLegU  { from{transform:rotate(12deg)}  to{transform:rotate(-22deg)} }
        @keyframes noteFloatA { 0%{transform:translateY(0);opacity:.7} 50%{transform:translateY(-8px);opacity:1} 100%{transform:translateY(0);opacity:.7} }
        @keyframes noteFloatB { 0%{transform:translateY(0);opacity:.5} 50%{transform:translateY(-10px);opacity:1} 100%{transform:translateY(0);opacity:.5} }
        @keyframes headPop    { from{transform:scale(1) translateY(0)} to{transform:scale(2.6) translateY(-12px)} }
  
    /* ═══════════════════════════════════════════
       RESPONSIVO MOBILE — max 768px
       ═══════════════════════════════════════════ */
    @media (max-width: 768px) {

      /* Sidebar vira menu hamburguer */
      :root { --sidebar-width: 0px; }
      .sidebar {
        transform: translateX(-260px);
        transition: transform 0.3s ease;
        width: 260px !important;
        z-index: 2000;
      }
      .sidebar.open { transform: translateX(0); }
      .main-content { margin-left: 0 !important; }

      /* Botão hamburguer */
      #menuToggle {
        display: flex !important;
        position: fixed;
        top: 1rem; left: 1rem;
        z-index: 3000;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 10px;
        width: 42px; height: 42px;
        font-size: 1.2rem;
        cursor: pointer;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      }

      /* Overlay quando sidebar aberta */
      #sidebarOverlay {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.5);
        z-index: 1999;
      }
      #sidebarOverlay.open { display: block; }

      /* Header */
      .header { padding: 1rem; padding-left: 4rem; }
      .header-top { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
      .page-title { font-size: 1.2rem; }

      /* Content padding */
      .content { padding: 1rem; }

      /* KPI cards — 1 coluna */
      .stats-grid { grid-template-columns: 1fr 1fr !important; gap: 0.75rem; margin-bottom: 1rem; }

      /* Charts — 1 coluna */
      .chart-grid { grid-template-columns: 1fr !important; gap: 1rem; }

      /* Dashboard KPI cards */
      #dashboardView > div[style*="grid"] { grid-template-columns: 1fr 1fr !important; }

      /* Tabelas com scroll horizontal */
      .table-container { overflow-x: auto; }
      table { min-width: 600px; }

      /* Tabs overflow */
      .tabs { overflow-x: auto; flex-wrap: nowrap !important; padding-bottom: 0.5rem; }
      .tab-btn { white-space: nowrap; flex-shrink: 0; }

      /* Comissão headers */
      #comissaoFinanceiroView [style*="linear-gradient"],
      #comissaoOperacionalView [style*="linear-gradient"] {
        padding: 1.25rem !important;
      }
      #comissaoFinanceiroView h1,
      #comissaoOperacionalView h1 { font-size: 1.3rem !important; }

      /* Marcos flutuante — menor no mobile */
      #marcosFloat { right: 0.75rem !important; top: 3.5rem !important; }
      #marcosFloat svg { width: 65px !important; height: 105px !important; }

      /* Marcos modal — tela cheia no mobile */
      #marcosPanel { width: 100vw !important; max-height: 80vh; border-radius: 20px 20px 0 0; }
      #marcosModal { align-items: flex-end; padding: 0; }

      /* IA modal */
      .modal-content { width: 100% !important; border-radius: 0; max-height: 100vh; }

      /* Consolidado filtros */
      .consolidado-filtro { flex-direction: column !important; align-items: flex-start !important; }

      /* Botões detalhar */
      .btn-detalhar { font-size: 0.75rem; padding: 0.4rem 0.6rem; }

      /* Cards comissão */
      .comissao-kpi-grid { grid-template-columns: 1fr 1fr !important; }
    }

    @media (max-width: 420px) {
      .stats-grid { grid-template-columns: 1fr !important; }
      #dashboardView > div[style*="grid"] { grid-template-columns: 1fr !important; }
    }

    /* Hamburguer — escondido no desktop */
    #menuToggle { display: none; }

    </style>
      <!-- HEAD -->
      <g class="mHead" id="marcosHead">
        <image href="data:image/png;base64,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" x="18" y="1" width="64" height="64" clip-path="url(#faceClipU)"/>
      </g>
      <!-- BODY -->
      <g class="mBody">
        <rect x="45" y="60" width="10" height="8" rx="3" fill="#f8c89a"/>
        <rect x="36" y="68" width="28" height="36" rx="8" fill="#ef4444"/>
        <g class="mLA"><line x1="36" y1="74" x2="16" y2="94" stroke="#ef4444" stroke-width="7" stroke-linecap="round"/><circle cx="15" cy="95" r="5" fill="#f8c89a"/></g>
        <g class="mRA">
          <line x1="64" y1="74" x2="84" y2="94" stroke="#ef4444" stroke-width="7" stroke-linecap="round"/>
          <circle cx="85" cy="95" r="5" fill="#f8c89a"/>
          <rect x="81" y="86" width="9" height="14" rx="2" fill="#4ade80"/>
          <rect x="81" y="86" width="9" height="5" rx="2" fill="#16a34a"/>
          <text x="85.5" y="93" text-anchor="middle" font-size="4" fill="white" font-weight="bold">H</text>
        </g>
        <g class="mLL"><line x1="44" y1="104" x2="36" y2="132" stroke="#1e293b" stroke-width="8" stroke-linecap="round"/><ellipse cx="35" cy="135" rx="8" ry="4" fill="#475569"/></g>
        <g class="mRL"><line x1="56" y1="104" x2="64" y2="132" stroke="#1e293b" stroke-width="8" stroke-linecap="round"/><ellipse cx="65" cy="135" rx="8" ry="4" fill="#475569"/></g>
        <text x="8"  y="58" font-size="11" fill="#f59e0b" style="animation:noteFloatA 1.2s ease-in-out infinite">♪</text>
        <text x="80" y="54" font-size="13" fill="#f59e0b" style="animation:noteFloatB 1s ease-in-out infinite 0.3s">♫</text>
      </g>
    </symbol>
  </defs>
</svg>
<style>
  .marcos-use-btn { background:transparent;border:none;padding:0;cursor:pointer;display:inline-flex;align-items:center;transition:transform 0.2s; }
  .marcos-use-btn:hover { transform:scale(1.08); }
  .marcos-use-btn:hover #marcosHead, .marcos-use-btn:hover .mHead { animation:headPop 0.4s ease-in-out infinite alternate !important; transform-origin:50px 33px; }
</style>
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <div class="logo"><img src="data:image/png;base64,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" alt="TEXNET" style="height:40px;width:auto;display:block"></div>
    </div>
    <nav class="sidebar-nav">
      <div class="nav-item active" onclick="selectMenu(this,'dashboard')"><span class="nav-icon">💰</span><span>Dashboard</span></div>
      <div class="nav-item" onclick="selectMenu(this,'consolidado')"><span class="nav-icon">📋</span><span>Fluxo de Caixa</span></div>
      <div class="nav-item" onclick="selectMenu(this,'powerbi')"><span class="nav-icon">📊</span><span>Relatório Power BI</span></div>
      <div class="nav-item" onclick="selectMenu(this,'ia-estrategica')"><span class="nav-icon">🤖</span><span>Estratégico</span></div>
      <div class="nav-item" onclick="selectMenu(this,'diretoria')"><span class="nav-icon">⚙️</span><span>Parâmetros</span></div>
      <div class="nav-item" onclick="selectMenu(this,'comissao-financeiro')"><span class="nav-icon">💼</span><span>Comissão Financeiro</span></div>
      <div class="nav-item" onclick="selectMenu(this,'comissao-operacional')" style="white-space:nowrap"><span class="nav-icon">📈</span><span>Comissão Operacional</span></div>
    </nav>
    <div class="sidebar-footer">Sistema Financeiro TEXNET<br>© 2026 - v3.0</div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="header" id="mainHeader">
      <div class="header-top">
        <div><h1 class="page-title">Dashboard Financeiro</h1><p class="page-subtitle">Visão consolidada e fluxo de caixa detalhado</p></div>
        <span class="badge badge-success">✓ Atualizado</span>
      </div>
      <!-- viewType hidden — navegação feita pelo sidebar -->
      <select id="viewType" onchange="changeView()" style="display:none">
        <option value="dashboard">Dashboard Geral</option>
        <option value="consolidado">Fluxo de Caixa</option>
        <option value="comparativo">Comparativo Anual</option>
        <option value="powerbi">Relatório Power BI</option>
        <option value="ia-estrategica">Estratégico</option>
        <option value="diretoria">Parâmetros</option>
        <option value="comissao-financeiro">Comissão Financeiro</option>
        <option value="comissao-operacional">Comissão Operacional</option>
      </select>
    </div>

    <div class="content">
      <!-- Dashboard View -->
      <div id="dashboardView" class="view-container active">
        <!-- Filtro mês/ano — sem botão, muda automaticamente -->
        <div style="display:flex;align-items:center;gap:1.25rem;padding:1.5rem 2rem 0;flex-wrap:wrap">
          <h2 style="margin:0;font-size:1.3rem;color:#1e293b">💰 Dashboard</h2>
          <div style="display:flex;align-items:center;gap:0.5rem;background:white;border:1px solid #e2e8f0;border-radius:10px;padding:0.4rem 0.75rem">
            <label style="font-size:0.82rem;color:#64748b;font-weight:600">📅 Mês:</label>
            <select id="dashMesFiltro" onchange="renderizarGraficos()" style="border:none;font-weight:700;font-size:0.9rem;color:#1e293b;background:transparent;cursor:pointer;outline:none">
              <option value="0">Janeiro</option><option value="1">Fevereiro</option><option value="2">Março</option>
              <option value="3">Abril</option><option value="4">Maio</option><option value="5">Junho</option>
              <option value="6">Julho</option><option value="7">Agosto</option><option value="8">Setembro</option>
              <option value="9">Outubro</option><option value="10">Novembro</option><option value="11">Dezembro</option>
            </select>
          </div>
          <div style="display:flex;align-items:center;gap:0.5rem;background:white;border:1px solid #e2e8f0;border-radius:10px;padding:0.4rem 0.75rem">
            <label style="font-size:0.82rem;color:#64748b;font-weight:600">🗓 Ano:</label>
            <select id="dashAnoFiltro" onchange="renderizarGraficos()" style="border:none;font-weight:700;font-size:0.9rem;color:#1e293b;background:transparent;cursor:pointer;outline:none">
              <option value="2026">2026</option><option value="2025">2025</option>
            </select>
          </div>
          <span id="dashPeriodoLabel" style="font-size:0.82rem;color:#64748b;font-style:italic"></span>
        </div>

        <!-- KPI Cards com tooltip de detalhamento -->
        <style>
          .dash-card { position:relative; background:white; border-radius:14px; box-shadow:0 2px 12px rgba(0,0,0,0.07); padding:1.25rem 1.5rem; border-top:4px solid var(--dash-color,#2563eb); cursor:default; transition:box-shadow 0.2s; }
          .dash-card:hover { box-shadow:0 6px 24px rgba(0,0,0,0.13); }
          .dash-card:hover .dash-tooltip { display:block; }
          .dash-tooltip { display:none; position:absolute; z-index:100; top:calc(100% + 8px); left:0; min-width:280px; max-width:360px; background:white; border-radius:12px; box-shadow:0 8px 32px rgba(0,0,0,0.18); padding:1rem; border:1px solid #e2e8f0; font-size:0.82rem; }
          .dash-tooltip-row { display:flex; justify-content:space-between; padding:0.3rem 0; border-bottom:1px solid #f1f5f9; gap:1rem; }
          .dash-tooltip-row:last-child { border-bottom:none; font-weight:700; }
          .dash-tooltip-title { font-size:0.75rem; font-weight:700; color:#64748b; text-transform:uppercase; letter-spacing:0.04em; margin-bottom:0.5rem; padding-bottom:0.4rem; border-bottom:2px solid #e2e8f0; }
        </style>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.25rem;padding:1.25rem 2rem 0">

          <!-- Receitas -->
          <div class="dash-card" style="--dash-color:#10b981">
            <div style="display:flex;justify-content:space-between;align-items:flex-start">
              <div>
                <div style="font-size:0.78rem;color:#64748b;font-weight:600;margin-bottom:0.4rem">💰 RECEITAS TOTAIS</div>
                <div style="font-size:1.65rem;font-weight:800;color:#10b981" id="dash_receitas">—</div>
              </div>
              <div style="font-size:1.8rem">💰</div>
            </div>
            <div style="margin-top:0.5rem;font-size:0.78rem;color:#64748b">
              <span id="dash_receitas_var" style="font-weight:700"></span> vs mês anterior
            </div>
            <div class="dash-tooltip">
              <div class="dash-tooltip-title">📋 Detalhamento Receitas</div>
              <div id="dash_tooltip_receitas"></div>
            </div>
          </div>

          <!-- Despesas -->
          <div class="dash-card" style="--dash-color:#ef4444">
            <div style="display:flex;justify-content:space-between;align-items:flex-start">
              <div>
                <div style="font-size:0.78rem;color:#64748b;font-weight:600;margin-bottom:0.4rem">💸 DESPESAS TOTAIS</div>
                <div style="font-size:1.65rem;font-weight:800;color:#ef4444" id="dash_custos">—</div>
                <div style="font-size:0.72rem;color:#94a3b8;margin-top:0.2rem">Impostos + Custos + Despesas Operac.</div>
              </div>
              <div style="font-size:1.8rem">💸</div>
            </div>
            <div style="margin-top:0.5rem;font-size:0.78rem;color:#64748b">
              <span id="dash_custos_var" style="font-weight:700"></span> vs mês anterior
            </div>
            <div class="dash-tooltip">
              <div class="dash-tooltip-title">📋 Detalhamento Despesas</div>
              <div id="dash_tooltip_despesas"></div>
            </div>
          </div>

          <!-- EBITDA Ajustado -->
          <div class="dash-card" style="--dash-color:#2563eb">
            <div style="display:flex;justify-content:space-between;align-items:flex-start">
              <div>
                <div style="font-size:0.78rem;color:#64748b;font-weight:600;margin-bottom:0.4rem">📊 EBITDA AJUSTADO</div>
                <div style="font-size:1.65rem;font-weight:800;color:#2563eb" id="dash_ebitda">—</div>
              </div>
              <div style="font-size:1.8rem">📊</div>
            </div>
            <div style="margin-top:0.5rem;font-size:0.78rem;color:#64748b">
              Margem: <strong id="dash_ebitda_pct" style="color:#2563eb"></strong>
            </div>
            <div class="dash-tooltip">
              <div class="dash-tooltip-title">📋 Composição EBITDA</div>
              <div id="dash_tooltip_ebitda"></div>
            </div>
          </div>

          <!-- Impostos -->
          <div class="dash-card" style="--dash-color:#f59e0b">
            <div style="display:flex;justify-content:space-between;align-items:flex-start">
              <div>
                <div style="font-size:0.78rem;color:#64748b;font-weight:600;margin-bottom:0.4rem">🏛️ IMPOSTOS</div>
                <div style="font-size:1.65rem;font-weight:800;color:#f59e0b" id="dash_impostos">—</div>
              </div>
              <div style="font-size:1.8rem">🏛️</div>
            </div>
            <div style="margin-top:0.5rem;font-size:0.78rem;color:#64748b">
              <strong id="dash_impostos_pct" style="color:#d97706"></strong> das receitas
            </div>
            <div class="dash-tooltip">
              <div class="dash-tooltip-title">📋 Detalhamento Impostos</div>
              <div id="dash_tooltip_impostos"></div>
            </div>
          </div>

        </div>

        <!-- Charts -->
        <div class="chart-grid" style="padding:1.25rem 2rem">
          <div class="chart-card"><div class="chart-header"><h3 class="chart-title">Composição das Receitas</h3><p class="chart-subtitle" id="dash_sub_rec">Distribuição por categoria</p></div><div class="chart-container"><canvas id="receitasChart"></canvas></div></div>
          <div class="chart-card"><div class="chart-header"><h3 class="chart-title">Distribuição de Despesas</h3><p class="chart-subtitle" id="dash_sub_desp">Por tipo</p></div><div class="chart-container"><canvas id="despesasChart"></canvas></div></div>
          <div class="chart-card"><div class="chart-header"><h3 class="chart-title">Evolução Mensal 2026</h3><p class="chart-subtitle">Receitas vs Custos+Despesas</p></div><div class="chart-container"><canvas id="comparativoReceitasChart"></canvas></div></div>
          <div class="chart-card"><div class="chart-header"><h3 class="chart-title">Top 10 Custos</h3><p class="chart-subtitle" id="dash_sub_custos">Maiores custos operacionais</p></div><div class="chart-container"><canvas id="custosChart"></canvas></div></div>
        </div>
      <!-- Marcos flutuante no Dashboard -->
      <div id="marcosFloat" style="position:fixed;top:4.5rem;right:1.5rem;z-index:500;cursor:pointer;filter:drop-shadow(0 4px 12px rgba(0,0,0,0.25));transition:transform 0.2s" onclick="abrirMarcos('dashboard')" title="Falar com Marcos" onmouseover="this.style.transform='scale(1.15)'" onmouseout="this.style.transform=''">
        <svg width="90" height="145" viewBox="0 0 100 165"><use href="#marcosSymbol"/></svg>
      </div>
      </div>

      <!-- Consolidado View -->
      <div id="consolidadoView" class="view-container">
        <div style="display:flex;align-items:center;gap:1rem;padding:2rem 2rem 0;flex-wrap:wrap;margin-bottom:1rem;">
          <h2 style="margin:0;">Fluxo de Caixa - 2026</h2>
          <a href="https://onedrive.live.com/?id=BAF9B60FA66D2B29!s31443c64c5b15a40b66793f9e4bc0c03&cid=BAF9B60FA66D2B29"
             target="_blank"
             style="padding:0.35rem 0.85rem;background:#0078d4;color:white;border-radius:7px;font-size:0.78rem;font-weight:600;text-decoration:none;">
            ☁️ OneDrive
          </a>
          <label style="padding:0.35rem 0.85rem;background:#059669;color:white;border-radius:7px;font-size:0.78rem;font-weight:600;cursor:pointer;">
            📂 Upload XLSX
            <input type="file" id="consolidadoCsvInput" accept=".xlsx,.xls" style="display:none" onchange="consolidadoParseXlsx(this)">
          </label>
          <span id="syncStatusMsg" style="font-size:0.75rem;color:#64748b"></span>
          <div id="syncProgressBar" style="display:none;flex:1;min-width:120px;">
            <div style="background:#e2e8f0;border-radius:99px;height:5px;overflow:hidden;">
              <div id="syncProgressFill" style="background:#059669;height:100%;width:0%;transition:width 0.4s;border-radius:99px;"></div>
            </div>
            <div id="syncProgressMsg" style="font-size:0.72rem;color:#64748b;margin-top:0.2rem;"></div>
          </div>
        </div>
        <div style="padding:0 2rem;">

          <div class="consolidado-filtro" style="flex-wrap:wrap;gap:1rem;">
            <div style="display:flex;align-items:center;gap:0.75rem;">
              <label for="consolidadoPeriodo">Período:</label>
              <input type="month" id="consolidadoPeriodo" value="2026-01" onchange="onConsolidadoPeriodoChange()">
            </div>
            <div style="display:flex;align-items:center;gap:0.75rem;">
              <label for="consolidadoAnoFiltro" style="font-size:0.875rem;font-weight:500;color:var(--text-secondary)">Ano (resumo anual):</label>
              <select id="consolidadoAnoFiltro" style="padding:0.4rem 0.7rem;border:1px solid #cbd5e1;border-radius:8px;font-size:0.9rem;color:#1e293b;background:white">
                <option value="2026">2026</option>
                <option value="2025">2025</option>
                <option value="2024">2024</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <div class="table-header">
              <h3 class="table-title">Detalhamento Financeiro</h3>
              <div class="tabs" style="flex-wrap:wrap;gap:0.4rem;">
                <button class="tab-btn active" onclick="showTab('receitas',this)">Receitas</button>
                <button class="tab-btn" onclick="showTab('impostos',this)">Impostos</button>
                <button class="tab-btn" onclick="showTab('custos',this)">Custos</button>
                <button class="tab-btn" onclick="showTab('despesas',this)">Despesas Operac.</button>
                <button class="tab-btn" onclick="showTab('ebitda',this)">EBITDA</button>
                <button class="tab-btn" onclick="showTab('ajustes',this)">Ajustes de Caixa</button>
                <button class="tab-btn" onclick="showTab('bancos',this)">Bancos</button>
                <button class="btn-detalhar" onclick="abrirModalTudoConsolidado()" style="margin-left:0.5rem;">📊 Ver Tudo Consolidado</button>
                <button class="btn-detalhar" onclick="abrirModalConsolidadoAnual()" style="margin-left:0.25rem;background:linear-gradient(135deg,#7c3aed,#5b21b6);">📅 Consolidado Anual</button>
              </div>
            </div>
            <div id="tableContent"></div>
          </div>
        </div>
      </div>

      <!-- Comparativo View -->
      <div id="comparativoView" class="view-container">
        <div style="padding:2rem">
          <h2 style="margin-bottom:1.5rem;">Comparativo Anual</h2>
          <div style="display:flex;gap:1rem;margin-bottom:2rem;">
            <button class="year-btn active" onclick="selectYear(2026,event)">2026</button>
            <button class="year-btn" onclick="selectYear(2025,event)">2025</button>
            <button class="year-btn" onclick="selectYear(2024,event)">2024</button>
          </div>
          <div class="comparison-grid" id="comparisonGrid"></div>
          <div class="table-container">
            <div class="table-header">
              <h3 class="table-title">Detalhamento por Categoria</h3>
              <div class="tabs">
                <button class="tab-btn active" onclick="showCompTab('receitas-comp',this)">Receitas</button>
                <button class="tab-btn" onclick="showCompTab('custos-comp',this)">Custos</button>
                <button class="tab-btn" onclick="showCompTab('despesas-comp',this)">Despesas</button>
                <button class="tab-btn" onclick="showCompTab('ebitda-comp',this)">EBITDA</button>
              </div>
            </div>
            <div id="compTableContent"></div>
          </div>
        </div>
      </div>

      <!-- Indicadores View -->
      <!-- PowerBI View -->
      <div id="powerbiView" class="view-container">
        <div class="geogrid-container" style="margin:2rem">
          <div class="geogrid-header" style="background:linear-gradient(135deg,#f7ba2c,#ea5353);color:white;">
            <span class="geogrid-icon">📊</span>
            <div><h2 style="margin:0">Relatório Power BI</h2><p style="margin:0;font-size:0.875rem;opacity:0.9">Dashboard de análise de dados</p></div>
          </div>
          <div class="iframe-loading active" id="pbiLoading"><div class="loading-spinner"></div><p>Carregando...</p></div>
          <iframe class="geogrid-iframe" src="https://app.powerbi.com/reportEmbed?reportId=f4daaf6e-02a4-4702-9fcf-8e5b462d43f7&autoAuth=true&ctid=b6f5c3aa-17cb-4bce-8eb6-8b30b93166e8&actionBarEnabled=true" onload="document.getElementById('pbiLoading').classList.remove('active')" loading="lazy"></iframe>
        </div>
      </div>

      <!-- IA View -->
      <div id="iaEstrategicaView" class="view-container">
        <div style="max-width:1400px;margin:0 auto;padding:2rem">

          <!-- Header -->
          <div style="background:linear-gradient(135deg,#1a1a2e,#16213e,#0f3460);padding:2rem 2.5rem;border-radius:20px;color:white;margin-bottom:1.5rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem">
            <div>
              <h1 style="margin:0;font-size:2rem">🤖 IA Estratégica</h1>
              <p style="margin:0.3rem 0 0;opacity:0.85;font-size:0.9rem">Análises inteligentes com dados reais da TEXNET • <span style="background:rgba(255,255,255,0.15);padding:0.15rem 0.6rem;border-radius:20px;font-size:0.8rem">GPT-4o</span></p>
            </div>
            <div style="display:flex;align-items:center;gap:0.6rem;background:rgba(255,255,255,0.12);border-radius:12px;padding:0.5rem 1rem">
              <span style="font-size:0.8rem;color:rgba(255,255,255,0.7);white-space:nowrap">🔑 OpenAI Key:</span>
              <input type="password" id="openaiApiKey" placeholder="sk-proj-..." style="background:transparent;border:none;color:white;font-size:0.82rem;width:220px;outline:none" oninput="iaKeyStatus()">
              <button onclick="salvarApiKey()" style="background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.4);color:white;border-radius:6px;padding:0.25rem 0.8rem;font-size:0.78rem;cursor:pointer;font-weight:600">💾</button>
              <span id="iaKeyBadge" style="font-size:0.75rem;color:rgba(255,255,255,0.65)"></span>
            </div>
          </div>

          <!-- Seletor período -->
          <div style="background:white;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.06);padding:1rem 1.5rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:1.5rem;flex-wrap:wrap">
            <span style="font-size:0.85rem;color:#64748b;font-weight:600">📅 Período de análise:</span>
            <select id="iaMesFiltro" style="padding:0.4rem 0.75rem;border:1px solid #e2e8f0;border-radius:8px;font-size:0.9rem;font-weight:600;color:#1e293b">
              <option value="0">Janeiro</option><option value="1" selected>Fevereiro</option><option value="2">Março</option>
              <option value="3">Abril</option><option value="4">Maio</option><option value="5">Junho</option>
              <option value="6">Julho</option><option value="7">Agosto</option><option value="8">Setembro</option>
              <option value="9">Outubro</option><option value="10">Novembro</option><option value="11">Dezembro</option>
            </select>
            <select id="iaAnoFiltro" style="padding:0.4rem 0.75rem;border:1px solid #e2e8f0;border-radius:8px;font-size:0.9rem;font-weight:600;color:#1e293b">
              <option value="2026">2026</option><option value="2025">2025</option>
            </select>
            <span style="font-size:0.78rem;color:#94a3b8">Os dados do período serão analisados pelo Claude com inteligência real</span>
          </div>

          <!-- Módulos -->
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.25rem;margin-bottom:1.5rem">
            <div onclick="iaAnalisar('cenario')" class="ia-card" style="border-top-color:#3b82f6">
              <div style="font-size:2rem;margin-bottom:0.6rem">📊</div>
              <div style="font-weight:700;font-size:0.95rem;color:#1e293b;margin-bottom:0.3rem">Análise de Cenário</div>
              <p style="margin:0;font-size:0.8rem;color:#64748b">Visão completa: receitas, margens, custos e destaques do período.</p>
            </div>
            <div onclick="iaAnalisar('estrategias')" class="ia-card" style="border-top-color:#10b981">
              <div style="font-size:2rem;margin-bottom:0.6rem">🎯</div>
              <div style="font-weight:700;font-size:0.95rem;color:#1e293b;margin-bottom:0.3rem">Montar Estratégias</div>
              <p style="margin:0;font-size:0.8rem;color:#64748b">Recomendações acionáveis baseadas nos seus dados reais.</p>
            </div>
            <div onclick="iaAnalisar('orcamento')" class="ia-card" style="border-top-color:#f59e0b">
              <div style="font-size:2rem;margin-bottom:0.6rem">💰</div>
              <div style="font-weight:700;font-size:0.95rem;color:#1e293b;margin-bottom:0.3rem">Orçamento Trimestral</div>
              <p style="margin:0;font-size:0.8rem;color:#64748b">Projeções para os próximos 3 meses com base na evolução atual.</p>
            </div>
            <div onclick="iaAnalisar('mes')" class="ia-card" style="border-top-color:#8b5cf6">
              <div style="font-size:2rem;margin-bottom:0.6rem">📅</div>
              <div style="font-weight:700;font-size:0.95rem;color:#1e293b;margin-bottom:0.3rem">Análise do Mês</div>
              <p style="margin:0;font-size:0.8rem;color:#64748b">Relatório detalhado: pontos positivos, negativos e oportunidades.</p>
            </div>
            <div onclick="iaAnalisar('previsoes')" class="ia-card" style="border-top-color:#06b6d4">
              <div style="font-size:2rem;margin-bottom:0.6rem">🔮</div>
              <div style="font-weight:700;font-size:0.95rem;color:#1e293b;margin-bottom:0.3rem">Previsões</div>
              <p style="margin:0;font-size:0.8rem;color:#64748b">Tendências de receita, churn, crescimento e EBITDA.</p>
            </div>
            <div onclick="iaAnalisar('alertas')" class="ia-card" style="border-top-color:#ef4444">
              <div style="font-size:2rem;margin-bottom:0.6rem">⚠️</div>
              <div style="font-weight:700;font-size:0.95rem;color:#1e293b;margin-bottom:0.3rem">Alertas Inteligentes</div>
              <p style="margin:0;font-size:0.8rem;color:#64748b">Anomalias, desvios de meta e riscos priorizados por severidade.</p>
            </div>
          </div>

          <!-- Chat livre -->
          <div style="background:white;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,0.07);padding:1.5rem;margin-bottom:1.5rem">
            <div style="font-weight:700;color:#1e293b;margin-bottom:0.75rem;font-size:0.95rem">💬 Pergunte qualquer coisa sobre os seus dados</div>
            <div style="display:flex;gap:0.75rem">
              <input id="iaPergunta" type="text" placeholder="Ex: Qual custo mais cresceu? Qual mês teve melhor EBITDA? O churn está controlado?" style="flex:1;padding:0.7rem 1rem;border:1px solid #e2e8f0;border-radius:10px;font-size:0.9rem;outline:none;transition:border 0.2s" onfocus="this.style.borderColor='#8b5cf6'" onblur="this.style.borderColor='#e2e8f0'" onkeydown="if(event.key==='Enter')iaAnalisar('chat')">
              <button onclick="iaAnalisar('chat')" style="padding:0.7rem 1.5rem;background:linear-gradient(135deg,#1a1a2e,#0f3460);color:white;border:none;border-radius:10px;font-weight:700;cursor:pointer;font-size:0.9rem;white-space:nowrap">Perguntar →</button>
            </div>
          </div>

          <!-- Loading com streaming visual -->
          <div id="iaLoading" style="display:none;background:white;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,0.07);padding:2rem;text-align:center">
            <div style="display:inline-flex;gap:6px;align-items:center;margin-bottom:0.75rem">
              <div class="ia-dot" style="animation-delay:0s"></div>
              <div class="ia-dot" style="animation-delay:0.2s"></div>
              <div class="ia-dot" style="animation-delay:0.4s"></div>
            </div>
            <p style="margin:0;color:#64748b;font-size:0.9rem" id="iaLoadingMsg">Claude está analisando seus dados...</p>
          </div>

          <!-- Resultado com markdown rendering -->
          <div id="iaResultado" style="display:none;background:white;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,0.07);overflow:hidden">
            <div style="background:linear-gradient(135deg,#1a1a2e,#0f3460);padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center">
              <div style="color:white;font-weight:700;font-size:1rem" id="iaResultadoTitulo">Resultado</div>
              <div style="display:flex;gap:0.5rem">
                <button onclick="iaCopiar()" style="background:rgba(255,255,255,0.15);border:1px solid rgba(255,255,255,0.3);color:white;border-radius:7px;padding:0.3rem 0.8rem;cursor:pointer;font-size:0.8rem">📋 Copiar</button>
                <button onclick="document.getElementById('iaResultado').style.display='none'" style="background:rgba(255,255,255,0.15);border:1px solid rgba(255,255,255,0.3);color:white;border-radius:7px;padding:0.3rem 0.8rem;cursor:pointer;font-size:0.8rem">✕</button>
              </div>
            </div>
            <div id="iaResultadoTexto" style="padding:1.75rem;line-height:1.8;color:#1e293b;font-size:0.9rem;max-height:600px;overflow-y:auto"></div>
          </div>

        </div>

        <style>
          .ia-card { background:white;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,0.07);padding:1.5rem;cursor:pointer;border-top:4px solid #ccc;transition:all 0.2s; }
          .ia-card:hover { transform:translateY(-4px);box-shadow:0 10px 28px rgba(0,0,0,0.14); }
          .ia-dot { width:10px;height:10px;background:#8b5cf6;border-radius:50%;animation:iaBounce 0.8s infinite alternate; }
          @keyframes iaBounce { from{transform:translateY(0);opacity:0.4} to{transform:translateY(-10px);opacity:1} }
          #iaResultadoTexto h1,#iaResultadoTexto h2,#iaResultadoTexto h3 { color:#1e293b;margin:1.2rem 0 0.5rem; }
          #iaResultadoTexto h2 { font-size:1.05rem;border-bottom:2px solid #e2e8f0;padding-bottom:0.4rem; }
          #iaResultadoTexto h3 { font-size:0.95rem;color:#374151; }
          #iaResultadoTexto strong { color:#0f3460; }
          #iaResultadoTexto ul,#iaResultadoTexto ol { padding-left:1.5rem;margin:0.5rem 0; }
          #iaResultadoTexto li { margin-bottom:0.4rem; }
          #iaResultadoTexto p { margin:0.6rem 0; }
          #iaResultadoTexto table { width:100%;border-collapse:collapse;margin:0.75rem 0;font-size:0.85rem; }
          #iaResultadoTexto th { background:#f1f5f9;padding:0.5rem 0.75rem;text-align:left;font-weight:700; }
          #iaResultadoTexto td { padding:0.4rem 0.75rem;border-bottom:1px solid #f1f5f9; }
          #iaResultadoTexto code { background:#f1f5f9;padding:0.15rem 0.4rem;border-radius:4px;font-size:0.85rem; }
          #iaResultadoTexto blockquote { border-left:3px solid #8b5cf6;padding-left:1rem;color:#64748b;margin:0.75rem 0; }
        </style>
      </div>
      <!-- Parâmetros View -->
      <div id="diretoriaView" class="view-container" style="display:none">
    <div style="max-width:1200px;margin:0 auto;padding:2rem">

      <!-- Header -->
      <div style="background:linear-gradient(135deg,#1e3a8a,#2563eb);padding:2.5rem;border-radius:20px;color:white;margin-bottom:2rem;text-align:center">
        <h1 style="margin:0;font-size:2.5rem">⚙️ Parâmetros</h1>
        <p style="margin:0.75rem 0 0;font-size:1.1rem;opacity:0.92">Central de índices, metas e parâmetros — base para gráficos, indicadores e cálculos automáticos</p>
      </div>

      <!-- SEÇÃO 1: Carregar PDF da Diretoria -->
      <div style="background:white;border-radius:16px;padding:2rem;box-shadow:0 4px 15px rgba(0,0,0,0.08);margin-bottom:1.5rem">
        <h3 style="margin:0 0 0.5rem;color:#1e3a8a;display:flex;align-items:center;gap:0.5rem">
          <span style="background:#dbeafe;color:#2563eb;border-radius:50%;width:32px;height:32px;display:inline-flex;align-items:center;justify-content:center;font-weight:700;flex-shrink:0">1</span>
          Carregar PDF da Diretoria
        </h3>
        <p style="margin:0 0 1.5rem 2.5rem;color:#64748b;font-size:0.9rem">Selecione o PDF exportado do Power BI (modelo "Visão de Tabela") para extrair dados operacionais automaticamente.</p>
        <div id="diretoriaDrop" onclick="document.getElementById('diretoriaPdfInput').click()" style="border:2.5px dashed #93c5fd;border-radius:12px;padding:2.5rem;text-align:center;cursor:pointer;background:#f8fafc;transition:all 0.3s" onmouseover="this.style.borderColor='#2563eb';this.style.background='#eff6ff'" onmouseout="this.style.borderColor='#93c5fd';this.style.background='#f8fafc'">
          <div style="font-size:3rem;margin-bottom:0.75rem">📄</div>
          <p style="margin:0;font-weight:600;color:#1e3a8a">Clique para selecionar o PDF</p>
          <p style="margin:0.25rem 0 0;font-size:0.85rem;color:#94a3b8">Arquivo PDF exportado do Power BI</p>
        </div>
        <input type="file" id="diretoriaPdfInput" accept=".pdf" style="display:none" onchange="diretoriaCarregarPdf(this)">
        <div id="diretoriaLoadingOCR" style="display:none;margin-top:1.5rem;text-align:center;padding:1.5rem;background:#eff6ff;border-radius:10px">
          <div style="font-size:2rem;margin-bottom:0.5rem">⏳</div>
          <div id="diretoriaOCRStatus" style="font-weight:600;color:#1d4ed8">Lendo PDF...</div>
          <div style="margin-top:0.5rem;background:#dbeafe;border-radius:8px;height:8px;overflow:hidden"><div id="diretoriaOCRBar" style="background:#2563eb;height:100%;width:0%;transition:width 0.3s"></div></div>
        </div>
        <div id="diretoriaPdfInfo" style="display:none;margin-top:1rem;padding:1rem;background:#f0fdf4;border-radius:8px;border:1px solid #86efac">
          <span id="diretoriaPdfNome" style="font-weight:600;color:#166534"></span><span style="color:#166534"> ✓ lido com sucesso</span>
        </div>
      </div>

      <!-- SEÇÃO 2: Dados extraídos -->
      <div id="diretoriaPreviewSection" style="display:none;background:white;border-radius:16px;padding:2rem;box-shadow:0 4px 15px rgba(0,0,0,0.08);margin-bottom:1.5rem">
        <h3 style="margin:0 0 0.5rem;color:#1e3a8a;display:flex;align-items:center;gap:0.5rem">
          <span style="background:#dbeafe;color:#2563eb;border-radius:50%;width:32px;height:32px;display:inline-flex;align-items:center;justify-content:center;font-weight:700;flex-shrink:0">2</span>
          Dados Lidos — Revise e Corrija se Necessário
        </h3>
        <p style="margin:0 0 1.5rem 2.5rem;color:#64748b;font-size:0.9rem">Revise os valores extraídos antes de salvar. Você pode editar qualquer campo clicando nele.</p>
        <div id="diretoriaMesAno" style="background:#eff6ff;padding:0.75rem 1rem;border-radius:8px;font-weight:700;color:#1e3a8a;margin-bottom:1.5rem;display:flex;gap:2rem;flex-wrap:wrap;align-items:center">
          <span>📅 Mês: <select id="dirMes" onchange="diretoriaDadosExtraidos=null;diretoriaVerificarMesAno()" style="border:none;background:transparent;font-weight:700;color:#1e3a8a;font-size:1rem">
            <option value="0">Janeiro</option><option value="1">Fevereiro</option><option value="2">Março</option>
            <option value="3">Abril</option><option value="4">Maio</option><option value="5">Junho</option>
            <option value="6">Julho</option><option value="7">Agosto</option><option value="8">Setembro</option>
            <option value="9">Outubro</option><option value="10">Novembro</option><option value="11">Dezembro</option>
          </select></span>
          <span>🗓 Ano: <input id="dirAno" type="number" value="2026" onchange="diretoriaDadosExtraidos=null;diretoriaVerificarMesAno()" style="border:none;background:transparent;font-weight:700;color:#1e3a8a;font-size:1rem;width:70px"></span>
          <span id="dirStorageInfo" style="font-size:0.82rem;color:#64748b;font-weight:400"></span>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem" id="diretoriaDataGrid"></div>
        <div style="margin-top:2rem;padding-top:1.5rem;border-top:2px solid #e2e8f0">
          <button onclick="diretoriaCarregarInformacoes()" id="btnCarregarInfo"
            style="width:100%;padding:1.2rem;background:linear-gradient(135deg,#2563eb,#1e3a8a);color:white;border:none;border-radius:12px;font-size:1.05rem;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:0.6rem;transition:opacity 0.2s"
            onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
            💾 Carregar Informações
          </button>
          <div id="dirSalvoMsg" style="display:none;margin-top:1rem;padding:0.9rem 1.25rem;border-radius:10px;text-align:center;font-weight:600;font-size:0.95rem"></div>
        </div>
      </div>

      <!-- SEÇÃO 3: Parâmetros da Comissão -->
      <div style="background:white;border-radius:16px;padding:2rem;box-shadow:0 4px 15px rgba(0,0,0,0.08);margin-bottom:1.5rem">
        <h3 style="margin:0 0 1.5rem;color:#1e293b;font-size:1.1rem;display:flex;align-items:center;gap:0.5rem">
          <span style="font-size:1.2rem">⚙️</span> Parâmetros da Comissão (editáveis)
        </h3>

        <!-- Cards de taxas (grid 4 colunas) -->
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:1rem;margin-bottom:2rem">

          <!-- Meta % Juros -->
          <div style="border:1px solid #e2e8f0;border-radius:12px;padding:1.25rem">
            <div style="font-size:0.82rem;color:#64748b;margin-bottom:0.75rem;font-weight:500">Meta % Juros (mín.)</div>
            <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem">
              <input type="text" data-format="pct" id="param_metaJuros" value="1.90"
                style="width:90px;padding:0.5rem 0.75rem;border:2px solid #2563eb;border-radius:8px;font-size:1.1rem;font-weight:700;text-align:center"
                onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <span style="color:#64748b;font-weight:600">%</span>
            </div>
            <div style="font-size:0.75rem;color:#94a3b8">Porcentagem mínima Juros/Faturamento para ganhar comissão</div>
          </div>

          <!-- Taxa Comissão Juros -->
          <div style="border:1px solid #e2e8f0;border-radius:12px;padding:1.25rem">
            <div style="font-size:0.82rem;color:#64748b;margin-bottom:0.75rem;font-weight:500">Taxa Comissão Juros</div>
            <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem">
              <input type="text" data-format="pct" id="param_txComissaoJuros" value="1.10"
                style="width:90px;padding:0.5rem 0.75rem;border:2px solid #2563eb;border-radius:8px;font-size:1.1rem;font-weight:700;text-align:center"
                onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <span style="color:#64748b;font-weight:600">%</span>
            </div>
            <div style="font-size:0.75rem;color:#94a3b8">Taxa aplicada sobre os Juros quando meta é atingida</div>
          </div>

          <!-- Taxa Recorrência -->
          <div style="border:1px solid #e2e8f0;border-radius:12px;padding:1.25rem">
            <div style="font-size:0.82rem;color:#64748b;margin-bottom:0.75rem;font-weight:500">Taxa Recorrência</div>
            <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem">
              <input type="text" data-format="pct" id="param_txRecorrencia" value="14.00"
                style="width:90px;padding:0.5rem 0.75rem;border:2px solid #2563eb;border-radius:8px;font-size:1.1rem;font-weight:700;text-align:center"
                onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <span style="color:#64748b;font-weight:600">%</span>
            </div>
            <div style="font-size:0.75rem;color:#94a3b8">Taxa aplicada sobre Resultado Líquido (Diretoria)</div>
          </div>

          <!-- Limite Máximo Tarifas -->
          <div style="border:1px solid #e2e8f0;border-radius:12px;padding:1.25rem">
            <div style="font-size:0.82rem;color:#64748b;margin-bottom:0.75rem;font-weight:500">Limite Máximo Tarifas</div>
            <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem">
              <input type="text" data-format="pct" id="param_limTarifas" value="0.38"
                style="width:90px;padding:0.5rem 0.75rem;border:2px solid #2563eb;border-radius:8px;font-size:1.1rem;font-weight:700;text-align:center"
                onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <span style="color:#64748b;font-weight:600">%</span>
            </div>
            <div style="font-size:0.75rem;color:#94a3b8">Tarifas/Faturamento deve ficar ABAIXO desse limite</div>
          </div>

          <!-- Taxa Comissão Eficiência -->
          <div style="border:1px solid #e2e8f0;border-radius:12px;padding:1.25rem">
            <div style="font-size:0.82rem;color:#64748b;margin-bottom:0.75rem;font-weight:500">Taxa Bancária</div>
            <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem">
              <input type="text" data-format="pct" id="param_txEficiencia" value="0.015"
                style="width:90px;padding:0.5rem 0.75rem;border:2px solid #2563eb;border-radius:8px;font-size:1.1rem;font-weight:700;text-align:center"
                onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <span style="color:#64748b;font-weight:600">%</span>
            </div>
            <div style="font-size:0.75rem;color:#94a3b8">Taxa bancária sobre o Faturamento</div>
          </div>

          <!-- Taxa EBITDA Mensal -->
          <div style="border:1px solid #e2e8f0;border-radius:12px;padding:1.25rem">
            <div style="font-size:0.82rem;color:#64748b;margin-bottom:0.75rem;font-weight:500">Taxa EBITDA Mensal</div>
            <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem">
              <input type="text" data-format="pct" id="param_txEbitdaMensal" value="0.10"
                style="width:90px;padding:0.5rem 0.75rem;border:2px solid #2563eb;border-radius:8px;font-size:1.1rem;font-weight:700;text-align:center"
                onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <span style="color:#64748b;font-weight:600">%</span>
            </div>
            <div style="font-size:0.75rem;color:#94a3b8">Taxa aplicada sobre EBITDA quando margem ≥ meta mensal</div>
          </div>

          <!-- Taxa Bônus Trimestral -->
          <div style="border:1px solid #e2e8f0;border-radius:12px;padding:1.25rem">
            <div style="font-size:0.82rem;color:#64748b;margin-bottom:0.75rem;font-weight:500">Taxa Bônus Trimestral</div>
            <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem">
              <input type="text" data-format="pct" id="param_txBonusTrim" value="0.20"
                style="width:90px;padding:0.5rem 0.75rem;border:2px solid #2563eb;border-radius:8px;font-size:1.1rem;font-weight:700;text-align:center"
                onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <span style="color:#64748b;font-weight:600">%</span>
            </div>
            <div style="font-size:0.75rem;color:#94a3b8">Taxa aplicada sobre EBITDA trimestral quando meta é batida</div>
          </div>

        </div>

        <!-- Meta % EBITDA por Mês -->
        <div style="background:#fffbeb;border:1px solid #fde68a;border-radius:12px;padding:1.5rem;margin-bottom:1.5rem">
          <h4 style="margin:0 0 1rem;color:#92400e;font-size:0.95rem;display:flex;align-items:center;gap:0.5rem">
            <span>🎯</span> Meta % EBITDA por Mês (editável)
          </h4>
          <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:0.75rem">
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Jan</div>
              <input type="text" data-format="pct" id="metaEbitda_jan" value="33.29" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Fev</div>
              <input type="text" data-format="pct" id="metaEbitda_fev" value="28.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Mar</div>
              <input type="text" data-format="pct" id="metaEbitda_mar" value="27.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Abr</div>
              <input type="text" data-format="pct" id="metaEbitda_abr" value="0.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Mai</div>
              <input type="text" data-format="pct" id="metaEbitda_mai" value="0.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Jun</div>
              <input type="text" data-format="pct" id="metaEbitda_jun" value="0.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Jul</div>
              <input type="text" data-format="pct" id="metaEbitda_jul" value="0.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Ago</div>
              <input type="text" data-format="pct" id="metaEbitda_ago" value="0.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Set</div>
              <input type="text" data-format="pct" id="metaEbitda_set" value="0.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Out</div>
              <input type="text" data-format="pct" id="metaEbitda_out" value="0.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Nov</div>
              <input type="text" data-format="pct" id="metaEbitda_nov" value="0.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
            <div style="text-align:center">
              <div style="font-size:0.78rem;font-weight:600;color:#475569;margin-bottom:0.4rem">Dez</div>
              <input type="text" data-format="pct" id="metaEbitda_dez" value="0.00" style="width:100%;padding:0.5rem 0.25rem;border:1px solid #fde68a;border-radius:6px;text-align:center;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              <div style="font-size:0.7rem;color:#94a3b8;margin-top:0.2rem">%</div>
            </div>
          </div>
        </div>

        <!-- Meta EBITDA Trimestral -->
        <div style="background:#fffbeb;border:1px solid #fde68a;border-radius:12px;padding:1.5rem;margin-bottom:1.5rem">
          <h4 style="margin:0 0 1rem;color:#92400e;font-size:0.95rem;display:flex;align-items:center;gap:0.5rem">
            <span>🏆</span> Meta EBITDA Trimestral (R$)
          </h4>
          <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:1rem">
            <div>
              <label style="display:block;font-size:0.82rem;color:#64748b;font-weight:500;margin-bottom:0.4rem">Q1 (Jan-Mar)</label>
              <input type="text" data-format="brl" id="metaTrim_q1" value="2401769.91" style="width:100%;padding:0.6rem 0.75rem;border:1px solid #fde68a;border-radius:8px;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
            </div>
            <div>
              <label style="display:block;font-size:0.82rem;color:#64748b;font-weight:500;margin-bottom:0.4rem">Q2 (Abr-Jun)</label>
              <input type="text" data-format="brl" id="metaTrim_q2" value="0" style="width:100%;padding:0.6rem 0.75rem;border:1px solid #fde68a;border-radius:8px;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
            </div>
            <div>
              <label style="display:block;font-size:0.82rem;color:#64748b;font-weight:500;margin-bottom:0.4rem">Q3 (Jul-Set)</label>
              <input type="text" data-format="brl" id="metaTrim_q3" value="0" style="width:100%;padding:0.6rem 0.75rem;border:1px solid #fde68a;border-radius:8px;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
            </div>
            <div>
              <label style="display:block;font-size:0.82rem;color:#64748b;font-weight:500;margin-bottom:0.4rem">Q4 (Out-Dez)</label>
              <input type="text" data-format="brl" id="metaTrim_q4" value="0" style="width:100%;padding:0.6rem 0.75rem;border:1px solid #fde68a;border-radius:8px;font-weight:700;font-size:0.9rem;background:white" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
            </div>
          </div>
        </div>

        <!-- ===== PARÂMETROS OPERACIONAIS ===== -->
        <div style="background:white;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);padding:1.75rem;margin-bottom:1.5rem">
          <h3 style="margin:0 0 1.25rem;color:#1e293b;font-size:1.05rem">🏆 Parâmetros — Comissão Operacional</h3>

          <!-- Metas mensais -->
          <div style="margin-bottom:1.25rem">
            <h4 style="margin:0 0 0.75rem;color:#475569;font-size:0.88rem;text-transform:uppercase;letter-spacing:0.05em">📊 Metas Mensais (indicadores)</h4>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:0.75rem">
              <div style="background:#f8fafc;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#64748b;display:block;margin-bottom:0.3rem">Meta OS Suporte PF (%)</label>
                <input type="text" data-format="pct" id="op_metaOsPf" value="5.00" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #e2e8f0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f8fafc;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#64748b;display:block;margin-bottom:0.3rem">Meta OS Suporte PJ (%)</label>
                <input type="text" data-format="pct" id="op_metaOsPj" value="10.00" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #e2e8f0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f8fafc;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#64748b;display:block;margin-bottom:0.3rem">Meta Churn PF (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaChurnPf" value="2.200" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #e2e8f0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f8fafc;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#64748b;display:block;margin-bottom:0.3rem">Meta Churn PJ (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaChurnPj" value="1.150" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #e2e8f0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f8fafc;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#64748b;display:block;margin-bottom:0.3rem">Meta Retiradas (%) — mín</label>
                <input type="text" data-format="pct" id="op_metaRetiradas" value="90.00" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #e2e8f0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f8fafc;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#64748b;display:block;margin-bottom:0.3rem">Ticket Médio PF (R$)</label>
                <input type="text" data-format="brl" id="op_ticketPf" value="88" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #e2e8f0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f8fafc;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#64748b;display:block;margin-bottom:0.3rem">Ticket Médio PJ (R$)</label>
                <input type="text" data-format="brl" id="op_ticketPj" value="303" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #e2e8f0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f8fafc;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#64748b;display:block;margin-bottom:0.3rem">Equipamento R$ (por retirada)</label>
                <input type="number" step="1" id="op_equipamento" value="250" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #e2e8f0;border-radius:6px;font-weight:700" onchange="salvarParams()">
              </div>
            </div>
          </div>

          <!-- Prêmios mensais -->
          <div style="margin-bottom:1.25rem">
            <h4 style="margin:0 0 0.75rem;color:#475569;font-size:0.88rem;text-transform:uppercase;letter-spacing:0.05em">💰 Prêmios Mensais (% sobre Ebitda ou Resultado)</h4>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:0.75rem">
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio OS PF (% Ebitda)</label>
                <input type="text" data-format="pct" id="op_premioOsPf" value="0.06" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio OS PJ (% Ebitda)</label>
                <input type="text" data-format="pct" id="op_premioOsPj" value="0.06" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Churn PF (% Ebitda)</label>
                <input type="text" data-format="pct" id="op_premioChurnPf" value="0.06" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Churn PJ (% Ebitda)</label>
                <input type="text" data-format="pct" id="op_premioChurnPj" value="0.06" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Retiradas (% Ebitda)</label>
                <input type="text" data-format="pct" id="op_premioRetiradas" value="0.80" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Resultado Positivo (%)</label>
                <input type="text" data-format="pct" id="op_premioResPos" value="7.00" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fff7f7;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#7f1d1d;display:block;margin-bottom:0.3rem">Desconto Resultado Negativo (%)</label>
                <input type="text" data-format="pct" id="op_premioResNeg" value="2.00" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fecaca;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Ebitda Móvel (% Ebitda)</label>
                <input type="text" data-format="pct" id="op_premioEbitdaMov" value="0.10" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
            </div>
          </div>

          <!-- Metas e prêmios trimestrais operacionais -->
          <div>
            <h4 style="margin:0 0 0.75rem;color:#475569;font-size:0.88rem;text-transform:uppercase;letter-spacing:0.05em">🏅 Metas Trimestrais Operacionais</h4>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:0.75rem">
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Resultado Acum. Trimestral (R$)</label>
                <input type="text" data-format="brl" id="op_metaResultTrim" value="60000" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Churn Fin. Trimestral (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaChurnFinTrim" value="1.650" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Mat-Equip Q1 (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaMatEquip_q1" value="8.43" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Mat-Equip Q2 (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaMatEquip_q2" value="8.74" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Mat-Equip Q3 (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaMatEquip_q3" value="7.31" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Mat-Equip Q4 (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaMatEquip_q4" value="7.52" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Folha Q1 (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaFolha_q1" value="23.63" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Folha Q2 (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaFolha_q2" value="24.45" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Folha Q3 (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaFolha_q3" value="25.65" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#fefce8;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#713f12;display:block;margin-bottom:0.3rem">Meta Folha Q4 (%) — máx</label>
                <input type="text" data-format="pct" id="op_metaFolha_q4" value="28.27" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #fde68a;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Resultado Trim (% Ebitda acum.)</label>
                <input type="text" data-format="pct" id="op_premioResultTrim" value="0.10" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Churn Fin Trim (% Ebitda acum.)</label>
                <input type="text" data-format="pct" id="op_premioChurnFinTrim" value="0.10" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Mat-Equip Trim (% Ebitda acum.)</label>
                <input type="text" data-format="pct" id="op_premioMatEquipTrim" value="0.05" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Folha Trim (% Ebitda acum.)</label>
                <input type="text" data-format="pct" id="op_premioFolhaTrim" value="0.07" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
              <div style="background:#f0fdf4;border-radius:10px;padding:0.875rem 1rem">
                <label style="font-size:0.78rem;color:#064e3b;display:block;margin-bottom:0.3rem">Prêmio Ebitda Trim (% Ebitda acum.)</label>
                <input type="text" data-format="pct" id="op_premioEbitdaTrim" value="0.20" style="width:100%;padding:0.4rem 0.6rem;border:1px solid #bbf7d0;border-radius:6px;font-weight:700" onchange="salvarParams()" onfocus="paramFocus(this)" onblur="paramBlur(this)">
              </div>
            </div>
          </div>
        </div>

        <!-- Botão salvar -->
        <div style="display:flex;justify-content:flex-end">
          <button onclick="salvarParams()" style="padding:0.75rem 2.5rem;background:linear-gradient(135deg,#2563eb,#1e3a8a);color:white;border:none;border-radius:10px;font-size:0.95rem;font-weight:700;cursor:pointer;display:flex;align-items:center;gap:0.5rem;transition:opacity 0.2s" onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
            💾 Salvar Parâmetros
          </button>
        </div>
        <div id="paramSalvoMsg" style="display:none;margin-top:0.75rem;text-align:right;color:#059669;font-weight:600;font-size:0.88rem">✓ Parâmetros salvos!</div>
      </div>

    </div>
      </div>

      <!-- COMISSÃO FINANCEIRO VIEW -->
      <div id="comissaoFinanceiroView" class="view-container" style="display:none">
    <div style="max-width:1400px;margin:0 auto;padding:2rem">

      <!-- Header -->
      <div style="background:linear-gradient(135deg,#1e3a8a,#7c3aed,#059669);padding:2rem 2.5rem;border-radius:20px;color:white;margin-bottom:1.5rem">
        <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem">
          <div>
            <h1 style="margin:0;font-size:2rem">💼 Comissão Financeiro</h1>
            <p style="margin:0.4rem 0 0;opacity:0.85;font-size:0.95rem">Matriz de Resultado 2026 — Calculada automaticamente com base nos parâmetros e dados do sistema</p>
          </div>
          <div style="display:flex;align-items:center;gap:1rem;flex-wrap:wrap">
            <button class="marcos-use-btn" onclick="abrirMarcos('financeiro')" title="Marcos"><svg width="90" height="145" viewBox="0 0 100 165"><use href="#marcosSymbol"/></svg></button>
            <div style="background:rgba(255,255,255,0.15);border-radius:10px;padding:0.5rem 1rem;display:flex;align-items:center;gap:0.75rem">
              <label style="font-size:0.85rem;font-weight:600;opacity:0.9">📅 Mês:</label>
              <select id="comissaoMesFiltro" onchange="renderComissao()" style="background:transparent;border:none;color:white;font-weight:700;font-size:0.95rem;cursor:pointer">
                <option value="0" style="color:#1e293b">Janeiro</option>
                <option value="1" style="color:#1e293b">Fevereiro</option>
                <option value="2" style="color:#1e293b">Março</option>
                <option value="3" style="color:#1e293b">Abril</option>
                <option value="4" style="color:#1e293b">Maio</option>
                <option value="5" style="color:#1e293b">Junho</option>
                <option value="6" style="color:#1e293b">Julho</option>
                <option value="7" style="color:#1e293b">Agosto</option>
                <option value="8" style="color:#1e293b">Setembro</option>
                <option value="9" style="color:#1e293b">Outubro</option>
                <option value="10" style="color:#1e293b">Novembro</option>
                <option value="11" style="color:#1e293b">Dezembro</option>
              </select>
            </div>
            <div style="background:rgba(255,255,255,0.15);border-radius:10px;padding:0.5rem 1rem;display:flex;align-items:center;gap:0.75rem">
              <label style="font-size:0.85rem;font-weight:600;opacity:0.9">🗓 Ano:</label>
              <select id="comissaoAnoFiltro" onchange="renderComissao()" style="background:transparent;border:none;color:white;font-weight:700;font-size:0.95rem;cursor:pointer">
                <option value="2026" style="color:#1e293b">2026</option>
                <option value="2025" style="color:#1e293b">2025</option>
              </select>
            </div>
            <button onclick="renderComissao()" style="padding:0.55rem 1.2rem;background:rgba(255,255,255,0.2);border:2px solid rgba(255,255,255,0.6);color:white;border-radius:8px;cursor:pointer;font-weight:600;font-size:0.85rem">🔄 Atualizar</button>
          </div>
        </div>
      </div>

      <!-- Cards de Resumo (5 indicadores base) -->
      <div id="comissaoCardsResumo" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;margin-bottom:1.5rem"></div>

      <!-- Aviso fonte Diretoria -->
      <div id="comissaoAvisoDiretoria" style="display:none;background:#fef3c7;border:1px solid #fde68a;border-radius:10px;padding:0.85rem 1.25rem;margin-bottom:1.5rem;font-size:0.85rem;color:#92400e">
        ⚠️ <strong>Dados da Diretoria não encontrados</strong> para este mês/ano. Recorrência e Reajuste usarão valor <strong>R$ 0</strong>. Para corrigir, faça o upload do PDF na aba <strong>Parâmetros</strong>.
      </div>

      <!-- Banner mês fechado -->
      <div id="comissaoMesFechadoBanner" style="display:none"></div>

      <!-- MATRIZ DE INDICADORES -->
      <div style="background:white;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);padding:1.75rem;margin-bottom:1.5rem">
        <h3 style="margin:0 0 1.5rem;color:#1e293b;font-size:1.05rem;display:flex;align-items:center;gap:0.5rem">
          📊 Matriz de Indicadores
          <span id="comissaoMesLabel" style="background:#dbeafe;color:#1e40af;font-size:0.8rem;padding:0.2rem 0.6rem;border-radius:20px;font-weight:600;margin-left:0.5rem"></span>
        </h3>
        <div id="comissaoMatriz" style="display:flex;flex-direction:column;gap:1rem"></div>
      </div>

      <!-- BÔNUS TRIMESTRAL -->
      <div style="background:white;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);padding:1.75rem;margin-bottom:1.5rem">
        <h3 style="margin:0 0 1.5rem;color:#1e293b;font-size:1.05rem">🏆 Bônus Trimestral (EBITDA Acumulado)</h3>
        <div id="comissaoBonusTrim" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem"></div>
      </div>

      <!-- TOTAL GERAL -->
      <div id="comissaoTotalGeral" style="border-radius:16px;padding:1.75rem;margin-bottom:1.5rem"></div>

      <!-- Rodapé fontes -->
      <div style="background:#f8fafc;border-radius:12px;padding:1rem 1.5rem;border-left:4px solid #2563eb;font-size:0.82rem;color:#475569">
        <strong style="color:#1e293b">📌 Fontes:</strong>
        <span style="background:#D1FAE5;padding:0.15rem 0.5rem;border-radius:4px;color:#065F46;font-weight:600;margin:0 0.5rem">🟢 Consolidado</span>Faturamento, Juros, Tarifas, EBITDA
        <span style="background:#DBEAFE;padding:0.15rem 0.5rem;border-radius:4px;color:#1E40AF;font-weight:600;margin:0 0.5rem">🔵 Diretoria (PDF)</span>Resultado Líquido, Reajuste
        <span style="background:#FEF3C7;padding:0.15rem 0.5rem;border-radius:4px;color:#92400E;font-weight:600;margin:0 0.5rem">🟡 Parâmetros</span>Taxas e metas
      </div>

    </div><!-- end comissaoFinanceiroView inner -->
      </div><!-- end comissaoFinanceiroView -->

      <!-- ============================================================ -->
      <!-- COMISSÃO OPERACIONAL VIEW                                     -->
      <!-- ============================================================ -->
      <div id="comissaoOperacionalView" class="view-container" style="display:none">
        <div style="max-width:1400px;margin:0 auto;padding:2rem">

          <!-- Header -->
          <div style="background:linear-gradient(135deg,#1e3a8a,#0369a1,#059669);padding:2rem 2.5rem;border-radius:20px;color:white;margin-bottom:1.5rem">
            <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem">
              <div>
                <h1 style="margin:0;font-size:2rem">🏆 Comissão Operacional</h1>
                <p style="margin:0.4rem 0 0;opacity:0.85;font-size:0.95rem">Matriz de Resultado 2026 — Indicadores e comissões calculados automaticamente</p>
              </div>
              <div style="display:flex;align-items:center;gap:1rem;flex-wrap:wrap">
                <button class="marcos-use-btn" onclick="abrirMarcos('operacional')" title="Marcos"><svg width="90" height="145" viewBox="0 0 100 165"><use href="#marcosSymbol"/></svg></button>
                <div style="background:rgba(255,255,255,0.15);border-radius:10px;padding:0.5rem 1rem;display:flex;align-items:center;gap:0.75rem">
                  <label style="font-size:0.85rem;font-weight:600;opacity:0.9">📅 Mês:</label>
                  <select id="opMesFiltro" onchange="renderComissaoOp()" style="background:transparent;border:none;color:white;font-weight:700;font-size:0.95rem;cursor:pointer">
                    <option value="0" style="color:#1e293b">Janeiro</option>
                    <option value="1" style="color:#1e293b">Fevereiro</option>
                    <option value="2" style="color:#1e293b">Março</option>
                    <option value="3" style="color:#1e293b">Abril</option>
                    <option value="4" style="color:#1e293b">Maio</option>
                    <option value="5" style="color:#1e293b">Junho</option>
                    <option value="6" style="color:#1e293b">Julho</option>
                    <option value="7" style="color:#1e293b">Agosto</option>
                    <option value="8" style="color:#1e293b">Setembro</option>
                    <option value="9" style="color:#1e293b">Outubro</option>
                    <option value="10" style="color:#1e293b">Novembro</option>
                    <option value="11" style="color:#1e293b">Dezembro</option>
                  </select>
                </div>
                <div style="background:rgba(255,255,255,0.15);border-radius:10px;padding:0.5rem 1rem;display:flex;align-items:center;gap:0.75rem">
                  <label style="font-size:0.85rem;font-weight:600;opacity:0.9">🗓 Ano:</label>
                  <select id="opAnoFiltro" onchange="renderComissaoOp()" style="background:transparent;border:none;color:white;font-weight:700;font-size:0.95rem;cursor:pointer">
                    <option value="2026" style="color:#1e293b">2026</option>
                    <option value="2025" style="color:#1e293b">2025</option>
                  </select>
                </div>
                <button onclick="renderComissaoOp()" style="padding:0.55rem 1.2rem;background:rgba(255,255,255,0.2);border:2px solid rgba(255,255,255,0.6);color:white;border-radius:8px;cursor:pointer;font-weight:600;font-size:0.85rem">🔄 Atualizar</button>
              </div>
            </div>
          </div>

          <!-- INDICADORES OPERACIONAIS -->
          <div style="background:white;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);padding:1.75rem;margin-bottom:1.5rem">
            <h3 style="margin:0 0 1.25rem;color:#1e293b;font-size:1.05rem;display:flex;align-items:center;gap:0.5rem">
              📊 Indicadores Operacionais
              <span id="opMesLabel" style="background:#dbeafe;color:#1e40af;font-size:0.8rem;padding:0.2rem 0.6rem;border-radius:20px;font-weight:600;margin-left:0.5rem"></span>
            </h3>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem" id="opIndicadores"></div>
          </div>

          <!-- NOVOS NEGÓCIOS E CANCELAMENTOS -->
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.25rem;margin-bottom:1.5rem">
            <div style="background:white;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);padding:1.75rem">
              <h3 style="margin:0 0 1.25rem;color:#065f46;font-size:1rem;display:flex;align-items:center;gap:0.5rem">🟢 Novos Negócios</h3>
              <div id="opNovosNegocios"></div>
            </div>
            <div style="background:white;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);padding:1.75rem">
              <h3 style="margin:0 0 1.25rem;color:#991b1b;font-size:1rem;display:flex;align-items:center;gap:0.5rem">🔴 Cancelamentos</h3>
              <div id="opCancelamentos"></div>
            </div>
          </div>

          <!-- RESULTADO LÍQUIDO -->
          <div id="opResultadoCard" style="margin-bottom:1.5rem"></div>

          <!-- COMISSÕES MENSAIS -->
          <div style="background:white;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);padding:1.75rem;margin-bottom:1.5rem">
            <h3 style="margin:0 0 1.25rem;color:#1e293b;font-size:1.05rem">💰 Comissões Mensais</h3>
            <div id="opComissoesMensais"></div>
            <div id="opTotalMensal" style="margin-top:1rem"></div>
          </div>

          <!-- BÔNUS TRIMESTRAL -->
          <div style="background:white;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);padding:1.75rem;margin-bottom:1.5rem">
            <h3 style="margin:0 0 1.25rem;color:#1e293b;font-size:1.05rem">🏅 Bônus Trimestral</h3>
            <p style="color:#64748b;font-size:0.85rem;margin:0 0 1.25rem">Avaliado ao final de cada trimestre (Mar, Jun, Set, Dez) com base nos acumulados.</p>
            <div id="opBonusTrimestral" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem"></div>
          </div>

          <!-- Rodapé fontes -->
          <div style="background:#f8fafc;border-radius:12px;padding:1rem 1.5rem;border-left:4px solid #0369a1;font-size:0.82rem;color:#475569">
            <strong style="color:#1e293b">📌 Fontes:</strong>
            <span style="background:#D1FAE5;padding:0.15rem 0.5rem;border-radius:4px;color:#065F46;font-weight:600;margin:0 0.5rem">🟢 Sistema</span>OS, Churn, Novos, Cancelamentos, Retiradas
            <span style="background:#DBEAFE;padding:0.15rem 0.5rem;border-radius:4px;color:#1E40AF;font-weight:600;margin:0 0.5rem">🔵 Fluxo de Caixa</span>Faturamento e EBITDA Ajustado
            <span style="background:#FEF3C7;padding:0.15rem 0.5rem;border-radius:4px;color:#92400E;font-weight:600;margin:0 0.5rem">🟡 Parâmetros Operacionais</span>Metas e taxas de prêmio
          </div>

        </div>
      </div>



    </div><!-- end .content -->
  </div><!-- end .main-content -->

  <!-- Modal detalhamento (fora do main para overlay correto) -->
  <div id="dailyModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header"><h2 class="modal-title" id="modalTitle">Detalhamento</h2><button class="modal-close" onclick="fecharModal()">×</button></div>
      <div class="modal-body"><div id="modalTableContent"></div></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    // ==================== SUPABASE CONFIG ====================
    const SB_URL  = 'https://rgdagcvpgdlefmiywurz.supabase.co';
    const SB_KEY  = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnZGFnY3ZwZ2RsZWZtaXl3dXJ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE5Mzk3MjUsImV4cCI6MjA4NzUxNTcyNX0.IT0nPkVhOODgFYLqnAwVjdtP_2PTeBPq0Aj0yB7jpKQ';
    const sb = supabase.createClient(SB_URL, SB_KEY);

    // Log visual no canto da tela para debug
    function sbLog(msg, tipo='info') {
      const colors = { ok:'#059669', erro:'#dc2626', info:'#2563eb', warn:'#d97706' };
      const div = document.createElement('div');
      div.style.cssText = `position:fixed;bottom:${10 + document.querySelectorAll('.sb-log').length*42}px;right:10px;background:white;border-left:4px solid ${colors[tipo]};padding:6px 12px;border-radius:6px;font-size:0.75rem;box-shadow:0 2px 8px rgba(0,0,0,0.15);z-index:99999;max-width:320px;word-break:break-all`;
      div.className = 'sb-log';
      div.textContent = `[Supabase] ${msg}`;
      document.body.appendChild(div);
      setTimeout(() => { div.remove(); document.querySelectorAll('.sb-log').forEach((el,i)=>el.style.bottom=(10+i*42)+'px'); }, 6000);
    }

    // Wrapper key→value sobre a tabela app_storage
    const sbStorage = {
      async get(key) {
        try {
          const { data, error } = await sb.from('app_storage').select('value').eq('key', key).maybeSingle();
          if (error) { sbLog(`GET "${key}" erro: ${error.message}`, 'erro'); throw error; }
          return data ? data.value : null;
        } catch(e) {
          sbLog(`GET "${key}" falhou: ${e.message}`, 'erro');
          return localStorage.getItem(key);
        }
      },
      async set(key, value) {
        try {
          const { error } = await sb.from('app_storage').upsert({ key, value, updated_at: new Date().toISOString() }, { onConflict: 'key' });
          if (error) { sbLog(`SET "${key}" erro: ${error.message}`, 'erro'); throw error; }
          sbLog(`SET "${key}" ✓`, 'ok');
        } catch(e) {
          sbLog(`SET "${key}" falhou: ${e.message} — usando localStorage`, 'warn');
          localStorage.setItem(key, value);
        }
      },
      async remove(key) {
        try {
          const { error } = await sb.from('app_storage').delete().eq('key', key);
          if (error) { sbLog(`DEL "${key}" erro: ${error.message}`, 'erro'); throw error; }
        } catch(e) {
          sbLog(`DEL "${key}" falhou: ${e.message}`, 'warn');
          localStorage.removeItem(key);
        }
      },
      // Testa a conexão e estrutura da tabela
      async testar() {
        sbLog('Testando conexão...', 'info');
        try {
          const { data, error } = await sb.from('app_storage').select('key').limit(1);
          if (error) { sbLog(`Tabela não acessível: ${error.message}`, 'erro'); return false; }
          sbLog('Conexão OK! Tabela app_storage acessível ✓', 'ok');
          return true;
        } catch(e) { sbLog(`Falha de conexão: ${e.message}`, 'erro'); return false; }
      }
    };

    // Testa automaticamente ao carregar
    window.addEventListener('load', () => sbStorage.testar());
    // =========================================================

    let consolidadoMesSelecionado = '01';
    let anoSelecionadoComparativo = 2026;
    let diretoriaDadosExtraidos = null;

    // ==================== DADOS FINANCEIROS ====================
    const dadosFinanceiros = {
      receitas: [
        { nome:"Link Pessoa Física",jan:1463928.46,fev:1235675.95,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:2699604.41 },
        { nome:"Link Pessoa Jurídica",jan:1189771.05,fev:788162.94,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:1977933.99 },
        { nome:"Juros/Multa",jan:56504.43,fev:38890.31,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:95394.74 },
        { nome:"Taxa de instalação",jan:7135.13,fev:2266.66,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:9401.79 },
        { nome:"Eventos",jan:3150.0,fev:3497.01,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:6647.01 },
        { nome:"Multa fidelidade e equipamento",jan:663.87,fev:1139.97,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:1803.84 },
        { nome:"Rendimentos financeiros",jan:2160.49,fev:2472.71,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:4633.2 },
        { nome:"V. Ativos imobilizados",jan:0,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:0.0 },
        { nome:"Vendas canceladas e estornos",jan:-2757.11,fev:-572.13,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:-3329.24 }
      ],
      impostos: [
        { nome:"ICMS",jan:88221.38,fev:99080.62,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:187302.0 },
        { nome:"COFINS",jan:52907.2,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:52907.2 },
        { nome:"PIS",jan:11417.3,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:11417.3 },
        { nome:"IRPJ",jan:70847.45,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:70847.45 },
        { nome:"CSLL",jan:27665.08,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:27665.08 },
        { nome:"ISS",jan:5745.14,fev:6285.8,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:12030.94 },
        { nome:"ISS Retido",jan:1218.24,fev:1267.39,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:2485.63 },
        { nome:"Simples Nacional",jan:1626.28,fev:1343.8,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:2970.08 },
        { nome:"FUST/FUNTTEL",jan:17091.99,fev:12526.67,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:29618.66 }
      ],
      custos: [
        { nome:"Kit Instalação",jan:152053.14,fev:174266.31,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:326319.45 },
        { nome:"Materiais de Rede",jan:49341.66,fev:22670.74,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:72012.4 },
        { nome:"Links de Dados / Voip",jan:57341.58,fev:56833.25,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:114174.83 },
        { nome:"Vtal",jan:62847.53,fev:64036.63,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:126884.16 },
        { nome:"Alugueis de Postes",jan:17793.58,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:17793.58 },
        { nome:"Alugueis de Torre e POP",jan:14480.49,fev:10440.56,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:24921.05 },
        { nome:"Custo com SVA",jan:13393.41,fev:13393.41,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:26786.82 },
        { nome:"Energia / POP",jan:29532.99,fev:11047.02,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:40580.01 },
        { nome:"Manutenção POP",jan:2795.5,fev:691.69,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:3487.19 },
        { nome:"Comissões de vendas",jan:38831.33,fev:29272.77,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:68104.1 },
        { nome:"Combustivel técnico",jan:31157.92,fev:32876.03,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:64033.95 },
        { nome:"Manut. Veículo",jan:17987.66,fev:14486.91,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:32474.57 },
        { nome:"Folha - Direta",jan:709835.26,fev:561211.24,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:1271046.5 },
        { nome:"Telefonia",jan:4632.76,fev:4393.22,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:9025.98 },
        { nome:"Man. Equipamento",jan:779.28,fev:140.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:919.28 },
        { nome:"Ferramentas",jan:8224.74,fev:6483.02,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:14707.76 },
        { nome:"Moveis e equipamentos escritório TI",jan:1241.88,fev:1233.53,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:2475.41 },
        { nome:"Tercerização de Serv. (Instalações)",jan:0.0,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:0.0 },
        { nome:"Custos Lastmile",jan:34330.68,fev:33940.41,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:68271.09 }
      ],
      despesas: [
        { nome:"Marketing",jan:54183.69,fev:51344.74,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:105528.43 },
        { nome:"Serv. Terceiros, jurídicos e consultorias",jan:39654.73,fev:29887.23,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:69541.96 },
        { nome:"Viagens/Estadia",jan:0.0,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:0.0 },
        { nome:"Segurança Trabalho/ EPI",jan:332.5,fev:2041.42,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:2373.92 },
        { nome:"Desp. Aluguel de escritório",jan:25978.9,fev:26994.1,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:52973.0 },
        { nome:"Desp. Reformas empresa",jan:3552.5,fev:2193.71,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:5746.21 },
        { nome:"Material de uso, consumo e papelaria",jan:2463.51,fev:327.8,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:2791.31 },
        { nome:"Combustivel Adm",jan:954.05,fev:801.72,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:1755.77 },
        { nome:"Despesas e taxas com Veiculos",jan:955.76,fev:13047.56,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:14003.32 },
        { nome:"Despesas Tributárias/ Taxas legais",jan:3609.38,fev:571.43,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:4180.81 },
        { nome:"Despesas Judiciais",jan:606.02,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:606.02 },
        { nome:"Treinamentos",jan:0.0,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0,nov:0.0,dez:0.0,total:0.0 },
        { nome:"Pró-Labore",jan:200000.0,fev:200000.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:400000.0 },
        { nome:"Sistema",jan:18131.16,fev:21847.41,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:39978.57 },
        { nome:"Taxas Boleto",jan:9409.45,fev:6727.14,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:16136.59 },
        { nome:"Enérgia Elétrica escritório",jan:2307.66,fev:4977.36,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:7285.02 },
        { nome:"Despesas Diversas / Estacionamento",jan:1412.13,fev:3715.51,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:5127.64 },
        { nome:"Tarifas bancárias",jan:1402.08,fev:30.82,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:1432.9 }
      ],
      ebitda: [
        { nome:"EBITDA",jan:832261.35,fev:549104.45,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:1381365.8 }
      ],
      ebitda_ajustado: [
        { nome:"IRPJ (Previsão)",jan:20713.14,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:20713.14 },
        { nome:"CSSL (Previsão)",jan:8176.73,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:8176.73 },
        { nome:"Trimestral",jan:98512.53,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:98512.53 },
        { nome:"Compra de Provedor",jan:11708.33,fev:11708.33,mar:11708.33,abr:11708.33,mai:11708.33,jun:11708.33,jul:11708.33,ago:11708.33,set:11708.33,out:11708.33,nov:11708.33,dez:11708.33,total:140499.96 },
        { nome:"Credito ICMS",jan:0,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:0 },
        { nome:"Ajuste (Mark/Equip)",jan:0,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:0 },
        { nome:"Datora",jan:0,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:0 },
        { nome:"Inclusão 2",jan:0,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:0 },
        { nome:"Inclusão 3",jan:0,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:0 },
        { nome:"Inclusão 4",jan:0,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:0 },
        { nome:"Inclusão 5",jan:0,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:0 },
        { nome:"Ajuste (Postes)",jan:30497.32,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:30497.32 },
        { nome:"Ajuste Vtal Fora",jan:14996.53,fev:0,mar:0,abr:0,mai:0,jun:0,jul:0,ago:0,set:0,out:0,nov:0,dez:0,total:14996.53 },
        { nome:"EBITDA (Ajustado)",jan:844681.83,fev:537396.12,mar:-11708.33,abr:-11708.33,mai:-11708.33,jun:-11708.33,jul:-11708.33,ago:-11708.33,set:-11708.33,out:-11708.33,nov:-11708.33,dez:-11708.33,total:1264994.65 }
      ],
      ajustes: [
        { nome:"Investimento",jan:26980.22,fev:59809.14,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:86789.36 },
        { nome:"Compra de veículos",jan:8448.44,fev:57977.36,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:66425.8 },
        { nome:"Invest. técnico e administrativo",jan:18531.78,fev:1831.78,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:20363.56 },
        { nome:"Aq. de provedor",jan:0.0,fev:0.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:0.0 },
        { nome:"Empr/Finac/Parcel",jan:417745.56,fev:396693.89,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:814439.45 },
        { nome:"Investimentos POP",jan:35186.47,fev:73528.4,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:108714.87 },
        { nome:"Empréstimos para giro",jan:44067.64,fev:22495.76,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:66563.4 },
        { nome:"Reneg. Débitos",jan:0.0,fev:1000.0,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:1000.0 },
        { nome:"Sócios ou Retiradas",jan:293512.31,fev:299669.73,mar:0.0,abr:0.0,mai:0.0,jun:0.0,jul:0.0,ago:0.0,set:0.0,out:0.0,nov:0.0,dez:0.0,total:593182.04 }
      ]
    };

    const dadosComparativos = {
      2026:{receitas:2851389.90,custos:1700000,despesas:700000,ebitda:938703.66,ebitdaAjustado:852829.83},
      2025:{receitas:2500000,custos:1500000,despesas:600000,ebitda:850000,ebitdaAjustado:750000},
      2024:{receitas:2200000,custos:1400000,despesas:550000,ebitda:750000,ebitdaAjustado:650000}
    };

    function formatCurrency(v) {
      if (v===null||v===undefined) return '-';
      return new Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL',minimumFractionDigits:2}).format(v);
    }

    function selectMenu(el,view) {
      document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('active'));
      el.classList.add('active');
      document.getElementById('viewType').value = view;
      changeView();
    }

    function changeView() {
      const v = document.getElementById('viewType').value;
      document.querySelectorAll('.view-container').forEach(c=>{c.classList.remove('active');c.style.display='none';});
      document.getElementById('marcosFloat').style.display = (v==='dashboard') ? 'block' : 'none';
      const hideHeader = ['consolidado','comparativo','powerbi','ia-estrategica','diretoria','comissao-financeiro','comissao-operacional'];
      document.getElementById('mainHeader').style.display = hideHeader.includes(v) ? 'none' : 'block';
      const show = id => { const el=document.getElementById(id); el.style.display='block'; el.classList.add('active'); };
      if (v==='dashboard') { show('dashboardView'); renderizarGraficos(); document.getElementById('marcosFloat').style.display='block'; }
      else if (v==='consolidado') { show('consolidadoView'); showTab('receitas'); }
      else if (v==='comparativo') { show('comparativoView'); renderComparisonCards(); renderCompTab('receitas-comp'); }
      else if (v==='powerbi') show('powerbiView');
      else if (v==='ia-estrategica') { show('iaEstrategicaView'); carregarApiKey(); }
      else if (v==='diretoria') { show('diretoriaView'); carregarParams(); diretoriaCarregarUltimoMes(); }
      else if (v==='comissao-financeiro') { show('comissaoFinanceiroView'); carregarParams().then(()=>renderComissao()); }
      else if (v==='comissao-operacional') { show('comissaoOperacionalView'); carregarParams().then(()=>renderComissaoOp()); }
    }

    function updatePeriod() {}
    function applyFilters() { alert('Filtros aplicados!\nPeríodo: '+document.getElementById('periodFilter').value); }
    function fecharModal() { document.getElementById('dailyModal').classList.remove('active'); }
    function iaCopiar() {
      const el = document.getElementById('iaResultadoTexto');
      const text = el ? el.innerText : '';
      navigator.clipboard.writeText(text).catch(()=>{});
    }

    function iaMarkdown(text) {
      let h = text
        .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
        .replace(/###\s(.+)/g,'<h3>$1</h3>')
        .replace(/##\s(.+)/g,'<h2>$1</h2>')
        .replace(/#\s(.+)/g,'<h1>$1</h1>')
        .replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>')
        .replace(/\*(.+?)\*/g,'<em>$1</em>')
        .replace(/`(.+?)`/g,'<code>$1</code>');
      const paraLines = h.split('\n');
      let out = [];
      let inList = false;
      for(const line of paraLines) {
        const li = line.match(/^[\*\-]\s(.+)/);
        const li2 = line.match(/^\d+\.\s(.+)/);
        if(li||li2) {
          if(!inList) { out.push('<ul>'); inList=true; }
          out.push('<li>'+(li?li[1]:li2[1])+'</li>');
        } else {
          if(inList) { out.push('</ul>'); inList=false; }
          if(line.startsWith('>')) out.push('<blockquote>'+line.slice(1).trim()+'</blockquote>');
          else if(line.startsWith('<h')||line.startsWith('<ul')||line.startsWith('</ul')) out.push(line);
          else if(line.trim()==='') out.push('<br>');
          else out.push('<p>'+line+'</p>');
        }
      }
      if(inList) out.push('</ul>');
      return out.join('');
    }
    function iaMontarContexto(mesKey, mesNome, statusMes) {
      const df = dadosFinanceiros;
      const fc = v => 'R$ '+Number(v).toLocaleString('pt-BR',{minimumFractionDigits:2,maximumFractionDigits:2});
      const fp = v => (Number(v)*100).toFixed(2).replace('.',',')+' %';
      const meses = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
      const receitas = df.receitas?.reduce((s,r)=>s+(r[mesKey]||0),0)||0;
      const custos   = df.custos?.reduce((s,r)=>s+(r[mesKey]||0),0)||0;
      const despesas = df.despesas?.reduce((s,r)=>s+(r[mesKey]||0),0)||0;
      const impostos = df.impostos?.reduce((s,r)=>s+(r[mesKey]||0),0)||0;
      const ebitdaItem = df.ebitda_ajustado?.find(r=>r.nome==='EBITDA (Ajustado)');
      const ebitda = ebitdaItem ? (ebitdaItem[mesKey]||0) : 0;
      const lines = [];
      lines.push('EMPRESA: TEXNET (Provedor de Internet - ISP)');
      lines.push('PERIODO DE ANALISE: '+mesNome+'/2026');
      lines.push('STATUS DOS DADOS: '+statusMes);
      lines.push('');
      lines.push('=== RESUMO FINANCEIRO ===');
      lines.push('Receitas Totais: '+fc(receitas));
      lines.push('Impostos: '+fc(impostos)+' ('+fp(receitas>0?impostos/receitas:0)+' da receita)');
      lines.push('Custos Operacionais: '+fc(custos));
      lines.push('Despesas Operacionais: '+fc(despesas));
      lines.push('Total Despesas: '+fc(impostos+custos+despesas));
      lines.push('EBITDA Ajustado: '+fc(ebitda)+' | Margem: '+fp(receitas>0?ebitda/receitas:0));
      lines.push('');
      lines.push('=== DETALHAMENTO RECEITAS ===');
      (df.receitas||[]).filter(r=>(r[mesKey]||0)>0).forEach(r=>lines.push('  '+r.nome+': '+fc(r[mesKey])));
      lines.push('');
      lines.push('=== IMPOSTOS ===');
      (df.impostos||[]).filter(r=>(r[mesKey]||0)>0).forEach(r=>lines.push('  '+r.nome+': '+fc(r[mesKey])));
      lines.push('');
      lines.push('=== TOP 10 CUSTOS ===');
      [...(df.custos||[])].sort((a,b)=>(b[mesKey]||0)-(a[mesKey]||0)).slice(0,10).forEach(c=>lines.push('  '+c.nome+': '+fc(c[mesKey]||0)));
      lines.push('');
      lines.push('=== DESPESAS OPERACIONAIS ===');
      (df.despesas||[]).filter(d=>(d[mesKey]||0)>0).forEach(d=>lines.push('  '+d.nome+': '+fc(d[mesKey])));
      lines.push('');
      lines.push('=== EVOLUCAO ANUAL (receitas acumuladas por mes) ===');
      meses.forEach(m=>{ const v=df.receitas?.reduce((s,r)=>s+(r[m]||0),0)||0; if(v>0) lines.push('  '+m.toUpperCase()+': '+fc(v)); });
      return lines.join('\n');
    }

    async function iaAnalisar(tipo) {
      const mesIdx  = parseInt(document.getElementById('iaMesFiltro')?.value||'1');
      const MESES   = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
      const MESES_N = ['Janeiro','Fevereiro','Marco','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
      const mesKey  = MESES[mesIdx];
      const mesNome = MESES_N[mesIdx];

      // Detecta se o mês é o atual ou passado
      const hoje = new Date();
      const anoAtual = hoje.getFullYear();
      const mesAtualIdx = hoje.getMonth();
      const isMesAtual = (parseInt(document.getElementById('iaAnoFiltro')?.value||'2026') === anoAtual) && (mesIdx === mesAtualIdx);
      const isMesFuturo = (parseInt(document.getElementById('iaAnoFiltro')?.value||'2026') === anoAtual) && (mesIdx > mesAtualIdx);
      const statusMes = isMesFuturo ? 'MES FUTURO (sem dados reais ainda)' : isMesAtual ? ('MES EM ANDAMENTO — dados parciais ate o dia '+hoje.getDate()+'/'+String(hoje.getMonth()+1).padStart(2,'0')) : 'MES FECHADO (dados completos)';

      const contexto = iaMontarContexto(mesKey, mesNome, statusMes);

      const systemPrompt = 'Voce e um analista financeiro senior especialista em provedores de internet (ISP) brasileiro. '
        + 'REGRAS OBRIGATORIAS: '
        + '1) Responda SEMPRE em portugues do Brasil com markdown formatado e emojis estrategicos. '
        + '2) Cite SEMPRE os numeros reais dos dados fornecidos — nunca invente valores. '
        + '3) STATUS DO PERIODO ANALISADO: '+statusMes+'. '
        + (isMesAtual ? 'MUITO IMPORTANTE: os dados deste mes sao PARCIAIS (mes ainda em andamento). NUNCA compare com meses fechados como se fosse queda — sempre mencione que o mes esta em andamento e os valores tendem a crescer ate o fechamento. ' : '')
        + (isMesFuturo ? 'ATENCAO: este mes ainda nao ocorreu. Baseie-se apenas em tendencias historicas dos meses anteriores para projecoes. ' : '')
        + '4) Para meses fechados: compare com benchmarks do setor ISP (margem EBITDA saudavel: 25-35%, churn saudavel: abaixo de 2%). '
        + '5) Seja direto e objetivo — executivos nao querem rodeios.';

      const prompts = {
        cenario:     'Com base nos dados financeiros da TEXNET, faca uma ANALISE DE CENARIO: resumo executivo, situacao financeira, principais receitas, analise dos custos, margem EBITDA vs benchmark ISP (25-35%), pontos de atencao e conclusao. Use markdown com secoes claras.\n\nDADOS:\n'+contexto,
        estrategias: 'Com base nos dados da TEXNET, desenvolva ESTRATEGIAS CONCRETAS para: 1) crescimento de receita, 2) reducao dos 3 maiores custos, 3) melhoria da margem EBITDA, 4) eficiencia operacional. Para cada estrategia: acao especifica, impacto esperado, prazo e dificuldade.\n\nDADOS:\n'+contexto,
        orcamento:   'Com base na evolucao dos dados da TEXNET, projete um ORCAMENTO PARA O PROXIMO TRIMESTRE com tabela de receitas/custos/EBITDA por mes, taxa de crescimento com justificativa, premissas e riscos.\n\nDADOS:\n'+contexto,
        mes:         'Elabore um RELATORIO COMPLETO DE FECHAMENTO DO MES com: resumo executivo, destaques positivos (min 3), pontos de atencao (min 3), analise de cada grupo de custo vs padroes ISP, e recomendacoes concretas para o proximo mes.\n\nDADOS:\n'+contexto,
        previsoes:   'Com base nos dados historicos da TEXNET, elabore PREVISOES para os proximos 3 meses: tendencia de receita, comportamento dos custos, projecao de EBITDA, riscos e oportunidades, e um semaforo de saude financeira (verde/amarelo/vermelho).\n\nDADOS:\n'+contexto,
        alertas:     'Analise os dados e gere ALERTAS INTELIGENTES priorizados: CRITICO (acao imediata), ATENCAO (monitorar), POSITIVO (destaques). Verifique: custos acima do padrao ISP, margem EBITDA fora do benchmark 25-35%, concentracao de receita, anomalias.\n\nDADOS:\n'+contexto,
        chat: ''
      };

      let userPrompt = prompts[tipo];
      if(tipo === 'chat') {
        const pergunta = document.getElementById('iaPergunta').value.trim();
        if(!pergunta) { alert('Digite sua pergunta antes de enviar.'); return; }
        userPrompt = 'Responda objetivamente com base nos dados financeiros abaixo.\n\nDADOS:\n'+contexto+'\n\nPERGUNTA: '+pergunta;
      }

      const titulos = {
        cenario: '📊 Analise de Cenario — '+mesNome+'/2026',
        estrategias: '🎯 Estrategias Recomendadas',
        orcamento: '💰 Orcamento Trimestral',
        mes: '📅 Relatorio de '+mesNome+'/2026',
        previsoes: '🔮 Previsoes Proximos Meses',
        alertas: '⚠️ Alertas Inteligentes',
        chat: '💬 Resposta GPT-4o'
      };

      const apiKey = localStorage.getItem('openaiKey') || '';
      if(!apiKey || !apiKey.startsWith('sk-')) {
        document.getElementById('openaiApiKey')?.focus();
        alert('Cole sua API Key do ChatGPT no campo no topo e clique 💾');
        return;
      }

      document.getElementById('iaLoading').style.display='block';
      document.getElementById('iaResultado').style.display='none';
      document.getElementById('iaLoadingMsg').textContent = 'GPT-4o analisando os dados de '+mesNome+'/2026...';

      try {
        const response = await fetch('https://api.openai.com/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer '+apiKey
          },
          body: JSON.stringify({
            model: 'gpt-4o',
            max_tokens: 2000,
            temperature: 0.7,
            messages: [{role:'system',content:systemPrompt},{role:'user',content:userPrompt}]
          })
        });

        if(!response.ok) {
          const err = await response.json().catch(()=>({}));
          throw new Error(err.error?.message || 'Erro HTTP '+response.status);
        }

        const data = await response.json();
        const texto = data.choices?.[0]?.message?.content || 'Sem resposta.';

        document.getElementById('iaLoading').style.display='none';
        document.getElementById('iaResultadoTitulo').textContent = titulos[tipo] || 'Resultado';
        document.getElementById('iaResultadoTexto').innerHTML = iaMarkdown(texto);
        document.getElementById('iaResultado').style.display='block';
        document.getElementById('iaResultado').scrollIntoView({behavior:'smooth',block:'start'});

      } catch(e) {
        document.getElementById('iaLoading').style.display='none';
        document.getElementById('iaResultadoTitulo').textContent = 'Erro';
        document.getElementById('iaResultadoTexto').textContent = 'Erro: '+e.message;
        document.getElementById('iaResultado').style.display='block';
      }
    }

    function iaKeyStatus() {
      const v = document.getElementById('openaiApiKey')?.value || '';
      const badge = document.getElementById('iaKeyBadge');
      if(badge) badge.textContent = v.startsWith('sk-') ? '✓ válida' : '';
    }
    function salvarApiKey() {
      const v = (document.getElementById('openaiApiKey')?.value || '').trim();
      if(!v.startsWith('sk-')) { alert('Key inválida — deve começar com sk-'); return; }
      localStorage.setItem('openaiKey', v);
      const badge = document.getElementById('iaKeyBadge');
      if(badge) { badge.textContent = '✓ salva!'; setTimeout(()=>{badge.textContent='✓ pronto';},1500); }
    }
    async function carregarApiKey() {
      const k = localStorage.getItem('openaiKey');
      const el = document.getElementById('openaiApiKey');
      const badge = document.getElementById('iaKeyBadge');
      if(k && el) { el.value = k; if(badge) badge.textContent = '✓ pronto'; }
    }
    function onConsolidadoPeriodoChange() {
      const [ano,mes] = document.getElementById('consolidadoPeriodo').value.split('-');
      consolidadoMesSelecionado = mes;
      consolidadoAnoSelecionado = ano;
      document.querySelector('#consolidadoView h2').innerText = 'Fluxo de Caixa - '+ano;
      showTab('receitas');
    }

    const MONTHS = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
    const MTHS_L = ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];

    // Dados diários extraídos da planilha
    const dadosDiarios = {
      'JAN/26': {
      "receitas": [{"nome":"Link Pessoa Física","valores":{"dia_1":18490.49,"dia_2":73584.34,"dia_3":24444.98,"dia_4":19226.01,"dia_5":153731.9,"dia_6":79364.24,"dia_7":74939.99,"dia_8":61382.16,"dia_9":72314.52,"dia_10":36164.5,"dia_11":12990.18,"dia_12":100216.1,"dia_13":57733.98,"dia_14":42441.74,"dia_15":74528.01,"dia_16":49717.59,"dia_17":16632.81,"dia_18":10813.16,"dia_19":52250.31,"dia_20":81383.88,"dia_21":43048.5,"dia_22":31823.28,"dia_23":24541.81,"dia_24":14676.12,"dia_25":13372.35,"dia_26":59350.48,"dia_27":38567.01,"dia_28":24774.73,"dia_29":24982.53,"dia_30":49145.23,"dia_31":27295.53},"total":1463928.46},
            {"nome":"Link Pessoa Jurídica","valores":{"dia_1":0.0,"dia_2":2413.88,"dia_3":362.32,"dia_4":179.53,"dia_5":29855.8,"dia_6":102006.14,"dia_7":10098.24,"dia_8":10304.25,"dia_9":25551.65,"dia_10":2030.52,"dia_11":640.94,"dia_12":46627.59,"dia_13":162710.64,"dia_14":21072.7,"dia_15":31460.63,"dia_16":109222.44,"dia_17":109.9,"dia_18":183.56,"dia_19":14894.89,"dia_20":56018.0,"dia_21":134195.5,"dia_22":24515.87,"dia_23":14575.8,"dia_24":230.8,"dia_25":731.3,"dia_26":74637.71,"dia_27":253333.63,"dia_28":37875.55,"dia_29":14886.28,"dia_30":8957.97,"dia_31":87.02},"total":1189771.05},
            {"nome":"Juros/Multa","valores":{"dia_1":422.29,"dia_2":1533.56,"dia_3":626.95,"dia_4":515.07,"dia_5":4963.59,"dia_6":3873.97,"dia_7":2843.68,"dia_8":1928.78,"dia_9":3318.48,"dia_10":987.61,"dia_11":290.11,"dia_12":2266.62,"dia_13":1898.71,"dia_14":2452.3,"dia_15":1852.27,"dia_16":2036.48,"dia_17":608.01,"dia_18":366.69,"dia_19":2728.17,"dia_20":2411.1,"dia_21":1746.8,"dia_22":1974.16,"dia_23":1366.32,"dia_24":473.62,"dia_25":378.63,"dia_26":3509.36,"dia_27":2152.75,"dia_28":1720.61,"dia_29":1382.02,"dia_30":2730.01,"dia_31":1145.71},"total":56504.43},
            {"nome":"Taxa de instalação","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":200.0,"dia_6":590.0,"dia_7":100.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":200.0,"dia_16":200.0,"dia_17":0.0,"dia_18":0.0,"dia_19":400.0,"dia_20":400.0,"dia_21":2600.0,"dia_22":350.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":150.0,"dia_27":1725.34,"dia_28":0.0,"dia_29":219.79,"dia_30":0.0,"dia_31":0.0},"total":7135.13},
            {"nome":"Eventos","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":650.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":2500.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":3150.0},
            {"nome":"Multa fidelidade e equipamento","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":242.73,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":25.47,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":251.79,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":143.88,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":663.87},
            {"nome":"Rendimentos financeiros","valores":{"dia_1":0.0,"dia_2":118.32,"dia_3":0.0,"dia_4":0.0,"dia_5":139.38,"dia_6":47.9,"dia_7":218.24,"dia_8":17.84,"dia_9":19.43,"dia_10":0.0,"dia_11":0.0,"dia_12":22.5,"dia_13":15.39,"dia_14":17.56,"dia_15":46.2,"dia_16":138.02,"dia_17":0.0,"dia_18":0.0,"dia_19":174.02,"dia_20":239.73,"dia_21":79.29,"dia_22":53.42,"dia_23":77.82,"dia_24":0.0,"dia_25":0.0,"dia_26":136.08,"dia_27":106.91,"dia_28":140.23,"dia_29":139.99,"dia_30":212.22,"dia_31":0.0},"total":2160.49},
            {"nome":"V. Ativos imobilizados","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Vendas canceladas e estornos","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":-290.1,"dia_6":-48.75,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":-103.04,"dia_14":0.0,"dia_15":-69.9,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":-2101.67,"dia_20":0.0,"dia_21":-43.75,"dia_22":-99.9,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":-2757.11}
      ],
      "impostos": [{"nome":"ICMS","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":88221.38,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":88221.38},
            {"nome":"COFINS","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":52907.2,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":52907.2},
            {"nome":"PIS","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":11417.3,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":11417.3},
            {"nome":"IRPJ","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":70847.45,"dia_31":0.0},"total":70847.45},
            {"nome":"CSLL","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":27665.08,"dia_31":0.0},"total":27665.08},
            {"nome":"ISS","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":5745.14,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":5745.14},
            {"nome":"ISS Retido","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":1218.24,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":1218.24},
            {"nome":"Simples Nacional","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":1626.28,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":1626.28},
            {"nome":"FUST/FUNTTEL","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":11394.66,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":5697.33,"dia_30":0.0,"dia_31":0.0},"total":17091.99}
      ],
      "custos": [{"nome":"Kit Instalação","valores":{"dia_1":0.0,"dia_2":2142.43,"dia_3":0.0,"dia_4":0.0,"dia_5":4578.39,"dia_6":1197.14,"dia_7":0.0,"dia_8":3919.17,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":6892.34,"dia_13":299.81,"dia_14":0.0,"dia_15":3199.33,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":10947.25,"dia_20":243.41,"dia_21":417.25,"dia_22":834.5,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":639.33,"dia_27":29774.87,"dia_28":15945.62,"dia_29":0.0,"dia_30":71022.3,"dia_31":0.0},"total":152053.14},
            {"nome":"Materiais de Rede","valores":{"dia_1":0.0,"dia_2":785.0,"dia_3":0.0,"dia_4":0.0,"dia_5":730.0,"dia_6":0.0,"dia_7":0.0,"dia_8":3432.28,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":1246.25,"dia_13":450.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":124.4,"dia_20":0.0,"dia_21":380.0,"dia_22":0.0,"dia_23":31340.93,"dia_24":0.0,"dia_25":0.0,"dia_26":472.5,"dia_27":7592.55,"dia_28":0.0,"dia_29":2787.75,"dia_30":0.0,"dia_31":0.0},"total":49341.66},
            {"nome":"Links de Dados / Voip","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":848.86,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":471.04,"dia_14":0.0,"dia_15":5430.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":5218.84,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":24285.15,"dia_24":0.0,"dia_25":0.0,"dia_26":19682.02,"dia_27":0.0,"dia_28":0.0,"dia_29":1405.67,"dia_30":0.0,"dia_31":0.0},"total":57341.58},
            {"nome":"Vtal","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":62847.53,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":62847.53},
            {"nome":"Alugueis de Postes","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":17793.58,"dia_31":0.0},"total":17793.58},
            {"nome":"Alugueis de Torre e POP","valores":{"dia_1":0.0,"dia_2":4603.75,"dia_3":0.0,"dia_4":0.0,"dia_5":2987.87,"dia_6":0.0,"dia_7":1200.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":700.0,"dia_13":350.0,"dia_14":0.0,"dia_15":100.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":1570.0,"dia_21":1800.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":500.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":668.87,"dia_31":0.0},"total":14480.49},
            {"nome":"Custo com SVA","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":13393.41,"dia_31":0.0},"total":13393.41},
            {"nome":"Energia / POP","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":221.53,"dia_13":5770.78,"dia_14":0.0,"dia_15":6870.64,"dia_16":39.83,"dia_17":0.0,"dia_18":0.0,"dia_19":238.35,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":15584.75,"dia_27":807.11,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":29532.99},
            {"nome":"Manutenção POP","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":400.0,"dia_9":1075.5,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":570.0,"dia_17":0.0,"dia_18":0.0,"dia_19":750.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":2795.5},
            {"nome":"Comissões de vendas","valores":{"dia_1":0.0,"dia_2":4902.08,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":3589.8,"dia_7":0.0,"dia_8":0.0,"dia_9":15583.16,"dia_10":0.0,"dia_11":0.0,"dia_12":299.8,"dia_13":1087.59,"dia_14":159.9,"dia_15":539.4,"dia_16":3249.5,"dia_17":0.0,"dia_18":0.0,"dia_19":59.9,"dia_20":120.0,"dia_21":0.0,"dia_22":0.0,"dia_23":9112.4,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":127.8,"dia_31":0.0},"total":38831.33},
            {"nome":"Combustivel técnico","valores":{"dia_1":0.0,"dia_2":17331.74,"dia_3":0.0,"dia_4":0.0,"dia_5":100.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":13606.18,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":120.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":31157.92},
            {"nome":"Manut. Veículo","valores":{"dia_1":0.0,"dia_2":3284.42,"dia_3":0.0,"dia_4":0.0,"dia_5":750.79,"dia_6":602.46,"dia_7":694.76,"dia_8":0.0,"dia_9":645.3,"dia_10":0.0,"dia_11":0.0,"dia_12":419.27,"dia_13":152.0,"dia_14":0.0,"dia_15":329.6,"dia_16":3259.5,"dia_17":0.0,"dia_18":0.0,"dia_19":1142.28,"dia_20":200.0,"dia_21":519.33,"dia_22":0.0,"dia_23":886.8,"dia_24":0.0,"dia_25":0.0,"dia_26":1507.3,"dia_27":60.0,"dia_28":2413.5,"dia_29":639.0,"dia_30":481.35,"dia_31":0.0},"total":17987.66},
            {"nome":"Folha - Direta","valores":{"dia_1":0.0,"dia_2":19596.16,"dia_3":0.0,"dia_4":0.0,"dia_5":5365.6,"dia_6":7312.26,"dia_7":295149.54,"dia_8":2937.81,"dia_9":6323.94,"dia_10":0.0,"dia_11":0.0,"dia_12":5737.52,"dia_13":1389.6,"dia_14":7852.73,"dia_15":2170.16,"dia_16":2197.98,"dia_17":0.0,"dia_18":0.0,"dia_19":60617.87,"dia_20":185577.62,"dia_21":50.0,"dia_22":2500.0,"dia_23":250.0,"dia_24":0.0,"dia_25":0.0,"dia_26":33150.57,"dia_27":1007.66,"dia_28":2652.05,"dia_29":66466.59,"dia_30":1529.6,"dia_31":0.0},"total":709835.26},
            {"nome":"Telefonia","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":3620.08,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":827.51,"dia_17":0.0,"dia_18":0.0,"dia_19":185.17,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":4632.76},
            {"nome":"Man. Equipamento","valores":{"dia_1":0.0,"dia_2":379.28,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":100.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":300.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":779.28},
            {"nome":"Ferramentas","valores":{"dia_1":0.0,"dia_2":5900.08,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":1982.16,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":302.5,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":40.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":8224.74},
            {"nome":"Moveis e equipamentos escritório TI","valores":{"dia_1":0.0,"dia_2":-353.21,"dia_3":0.0,"dia_4":0.0,"dia_5":617.5,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":77.57,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":900.02,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":1241.88},
            {"nome":"Tercerização de Serv. (Instalações)","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Custos Lastmile","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":400.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":2377.42,"dia_13":1163.04,"dia_14":0.0,"dia_15":4070.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":4654.56,"dia_20":8550.54,"dia_21":0.0,"dia_22":0.0,"dia_23":2184.8,"dia_24":0.0,"dia_25":0.0,"dia_26":6820.52,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":4109.8,"dia_31":0.0},"total":34330.68}
      ],
      "despesas_operacionais": [{"nome":"Marketing","valores":{"dia_1":0.0,"dia_2":4021.95,"dia_3":0.0,"dia_4":0.0,"dia_5":20109.4,"dia_6":4306.28,"dia_7":0.0,"dia_8":1065.0,"dia_9":4899.0,"dia_10":0.0,"dia_11":0.0,"dia_12":6770.98,"dia_13":875.0,"dia_14":777.19,"dia_15":1799.0,"dia_16":1420.0,"dia_17":0.0,"dia_18":0.0,"dia_19":177.45,"dia_20":112.44,"dia_21":0.0,"dia_22":450.0,"dia_23":4200.0,"dia_24":0.0,"dia_25":0.0,"dia_26":1600.0,"dia_27":600.0,"dia_28":0.0,"dia_29":0.0,"dia_30":1000.0,"dia_31":0.0},"total":54183.69},
            {"nome":"Serv. Terceiros, jurídicos e consultorias","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":2449.75,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":645.0,"dia_10":0.0,"dia_11":0.0,"dia_12":11120.05,"dia_13":7000.0,"dia_14":426.2,"dia_15":5490.0,"dia_16":200.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":786.23,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":11000.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":537.5,"dia_31":0.0},"total":39654.73},
            {"nome":"Viagens/Estadia","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Segurança Trabalho/ EPI","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":332.5,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":332.5},
            {"nome":"Desp. Aluguel de escritório","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":582.75,"dia_6":0.0,"dia_7":0.0,"dia_8":24741.15,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":65.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":590.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":25978.9},
            {"nome":"Desp. Reformas empresa","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":446.72,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":70.0,"dia_15":2155.78,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":880.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":3552.5},
            {"nome":"Material de uso, consumo e papelaria","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":405.0,"dia_14":0.0,"dia_15":1346.06,"dia_16":404.05,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":308.4,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":2463.51},
            {"nome":"Combustivel Adm","valores":{"dia_1":0.0,"dia_2":486.96,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":467.09,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":954.05},
            {"nome":"Despesas e taxas com Veiculos","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":741.61,"dia_20":214.15,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":955.76},
            {"nome":"Despesas Tributárias/ Taxas legais","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":479.7,"dia_20":0.0,"dia_21":0.0,"dia_22":108.39,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":2750.0,"dia_28":271.29,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":3609.38},
            {"nome":"Despesas Judiciais","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":606.02,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":606.02},
            {"nome":"Treinamentos","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Pró-Labore","valores":{"dia_1":0.0,"dia_2":2809.14,"dia_3":0.0,"dia_4":0.0,"dia_5":81152.21,"dia_6":66885.0,"dia_7":18923.84,"dia_8":3372.61,"dia_9":26857.2,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":200000.0},
            {"nome":"Sistema","valores":{"dia_1":0.0,"dia_2":39.9,"dia_3":0.0,"dia_4":0.0,"dia_5":189.9,"dia_6":3316.26,"dia_7":1086.01,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":5007.57,"dia_13":978.0,"dia_14":0.0,"dia_15":746.6,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":6766.92,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":18131.16},
            {"nome":"Taxas Boleto","valores":{"dia_1":8.88,"dia_2":45.24,"dia_3":17.76,"dia_4":15.12,"dia_5":347.37,"dia_6":763.04,"dia_7":1859.72,"dia_8":180.25,"dia_9":173.73,"dia_10":19.68,"dia_11":5.76,"dia_12":265.34,"dia_13":698.19,"dia_14":149.01,"dia_15":184.38,"dia_16":513.45,"dia_17":14.64,"dia_18":7.92,"dia_19":122.15,"dia_20":314.58,"dia_21":566.16,"dia_22":123.44,"dia_23":87.37,"dia_24":12.0,"dia_25":13.68,"dia_26":123.29,"dia_27":621.4,"dia_28":91.71,"dia_29":56.49,"dia_30":110.55,"dia_31":1897.15},"total":9409.45},
            {"nome":"Enérgia Elétrica escritório","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":2307.66,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":2307.66},
            {"nome":"Despesas Diversas / Estacionamento","valores":{"dia_1":0.0,"dia_2":170.75,"dia_3":0.0,"dia_4":0.0,"dia_5":54.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":167.34,"dia_13":31.0,"dia_14":18.0,"dia_15":0.0,"dia_16":19.99,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":10.0,"dia_23":821.05,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":120.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":1412.13},
            {"nome":"Tarifas bancárias","valores":{"dia_1":0.0,"dia_2":183.85,"dia_3":0.0,"dia_4":0.0,"dia_5":444.62,"dia_6":378.68,"dia_7":17.57,"dia_8":13.47,"dia_9":5.44,"dia_10":0.0,"dia_11":0.0,"dia_12":13.57,"dia_13":122.14,"dia_14":13.35,"dia_15":6.85,"dia_16":17.47,"dia_17":0.0,"dia_18":0.0,"dia_19":6.74,"dia_20":5.44,"dia_21":10.63,"dia_22":2.72,"dia_23":18.88,"dia_24":0.0,"dia_25":0.0,"dia_26":17.01,"dia_27":12.39,"dia_28":5.54,"dia_29":105.72,"dia_30":0.0,"dia_31":0.0},"total":1402.08}
      ],
      "despesas_financeiras": [{"nome":"EBITDA","valores":{"dia_1":18903.9,"dia_2":11320.58,"dia_3":25416.49,"dia_4":19905.49,"dia_5":67293.7,"dia_6":97725.31,"dia_7":-230731.29,"dia_8":33571.29,"dia_9":44146.95,"dia_10":39162.95,"dia_11":13915.47,"dia_12":21065.0,"dia_13":200605.46,"dia_14":56517.92,"dia_15":57198.48,"dia_16":148595.25,"dia_17":17336.08,"dia_18":11355.49,"dia_19":-17171.26,"dia_20":-153933.85,"dia_21":177002.97,"dia_22":54587.78,"dia_23":-96950.13,"dia_24":15368.54,"dia_25":14468.6,"dia_26":47696.32,"dia_27":251771.26,"dia_28":43275.29,"dia_29":-35547.94,"dia_30":-148241.86,"dia_31":26631.11},"total":832261.35}],
      "ajustes_caixa": [{"nome":"Investimento","valores":{"dia_1":0.0,"dia_2":1900.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":5443.58,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":1265.56,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":1671.08,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":16700.0,"dia_31":0.0},"total":26980.22},
            {"nome":"Empr/Finac/Parcel","valores":{"dia_1":0.0,"dia_2":9191.86,"dia_3":0.0,"dia_4":0.0,"dia_5":587.24,"dia_6":5400.0,"dia_7":0.0,"dia_8":0.0,"dia_9":30167.92,"dia_10":0.0,"dia_11":0.0,"dia_12":25904.73,"dia_13":9635.28,"dia_14":4923.16,"dia_15":68870.76,"dia_16":4189.94,"dia_17":0.0,"dia_18":0.0,"dia_19":5802.98,"dia_20":12199.33,"dia_21":3946.79,"dia_22":72257.12,"dia_23":14922.5,"dia_24":0.0,"dia_25":0.0,"dia_26":72839.1,"dia_27":4166.25,"dia_28":13397.48,"dia_29":2053.33,"dia_30":57289.79,"dia_31":0.0},"total":417745.56},
            {"nome":"Impostos","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":44979.14,"dia_31":0.0},"total":44979.14},
            {"nome":"Sócios ou Retiradas","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":8116.8,"dia_10":0.0,"dia_11":0.0,"dia_12":24333.54,"dia_13":9635.28,"dia_14":279.08,"dia_15":54020.61,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":12199.33,"dia_21":2081.79,"dia_22":72257.12,"dia_23":14013.02,"dia_24":0.0,"dia_25":0.0,"dia_26":69701.36,"dia_27":4166.25,"dia_28":13397.48,"dia_29":0.0,"dia_30":9310.65,"dia_31":0.0},"total":293512.31}
      ]
      },
      'FEV/26': {
      "receitas": [{"nome":"Link Pessoa Física","valores":{"dia_1":18184.37,"dia_2":96736.12,"dia_3":82457.85,"dia_4":67146.92,"dia_5":96160.62,"dia_6":75821.63,"dia_7":25361.08,"dia_8":18778.52,"dia_9":93497.82,"dia_10":114221.41,"dia_11":59115.93,"dia_12":42174.05,"dia_13":45532.27,"dia_14":17145.79,"dia_15":17148.85,"dia_16":638.71,"dia_17":13461.79,"dia_18":76241.95,"dia_19":62132.97,"dia_20":80628.21,"dia_21":21493.56,"dia_22":12338.72,"dia_23":66015.11,"dia_24":33241.7,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":1235675.95},
            {"nome":"Link Pessoa Jurídica","valores":{"dia_1":0.0,"dia_2":15859.74,"dia_3":21422.69,"dia_4":19260.08,"dia_5":24208.54,"dia_6":78594.82,"dia_7":229.1,"dia_8":131.06,"dia_9":16314.01,"dia_10":56170.39,"dia_11":146880.99,"dia_12":48995.64,"dia_13":25480.83,"dia_14":345.0,"dia_15":278.04,"dia_16":17349.48,"dia_17":139.6,"dia_18":27736.72,"dia_19":95607.43,"dia_20":51082.51,"dia_21":167.9,"dia_22":0.0,"dia_23":141908.37,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":788162.94},
            {"nome":"Juros/Multa","valores":{"dia_1":453.97,"dia_2":2642.06,"dia_3":1983.14,"dia_4":2676.09,"dia_5":1725.26,"dia_6":1965.21,"dia_7":969.43,"dia_8":485.14,"dia_9":3601.36,"dia_10":2234.93,"dia_11":1991.99,"dia_12":1946.24,"dia_13":1903.88,"dia_14":728.54,"dia_15":426.47,"dia_16":511.67,"dia_17":494.8,"dia_18":2268.62,"dia_19":3640.92,"dia_20":3426.87,"dia_21":1085.53,"dia_22":636.99,"dia_23":1091.2,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":38890.31},
            {"nome":"Taxa de instalação","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":200.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":1200.0,"dia_10":200.0,"dia_11":66.66,"dia_12":0.0,"dia_13":600.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":2266.66},
            {"nome":"Eventos","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":2500.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":997.01,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":3497.01},
            {"nome":"Multa fidelidade e equipamento","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":202.47,"dia_4":0.0,"dia_5":0.0,"dia_6":194.85,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":332.01,"dia_11":230.79,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":179.85,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":1139.97},
            {"nome":"Rendimentos financeiros","valores":{"dia_1":0.0,"dia_2":212.6,"dia_3":165.93,"dia_4":155.86,"dia_5":175.36,"dia_6":186.88,"dia_7":0.0,"dia_8":0.0,"dia_9":148.71,"dia_10":87.82,"dia_11":102.99,"dia_12":123.08,"dia_13":115.86,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.01,"dia_19":525.67,"dia_20":248.29,"dia_21":0.0,"dia_22":0.0,"dia_23":119.81,"dia_24":103.84,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":2472.71},
            {"nome":"V. Ativos imobilizados","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Vendas canceladas e estornos","valores":{"dia_1":0.0,"dia_2":-67.47,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":-118.6,"dia_10":0.0,"dia_11":-187.19,"dia_12":-105.98,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":-92.89,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":-572.13}
      ],
      "impostos": [{"nome":"ICMS","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":99080.62,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":99080.62},
            {"nome":"COFINS","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"PIS","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"IRPJ","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"CSLL","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"ISS","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":6285.8,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":6285.8},
            {"nome":"ISS Retido","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":1267.39,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":1267.39},
            {"nome":"Simples Nacional","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":1343.8,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":1343.8},
            {"nome":"FUST/FUNTTEL","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":12526.67,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":12526.67}
      ],
      "custos": [{"nome":"Kit Instalação","valores":{"dia_1":0.0,"dia_2":2737.22,"dia_3":35991.69,"dia_4":2139.9,"dia_5":93348.64,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":2936.25,"dia_10":2196.4,"dia_11":299.81,"dia_12":3367.5,"dia_13":12681.12,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":15355.2,"dia_20":1127.25,"dia_21":0.0,"dia_22":0.0,"dia_23":2085.33,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":174266.31},
            {"nome":"Materiais de Rede","valores":{"dia_1":0.0,"dia_2":4533.83,"dia_3":0.0,"dia_4":399.5,"dia_5":3431.46,"dia_6":100.0,"dia_7":0.0,"dia_8":0.0,"dia_9":430.0,"dia_10":816.25,"dia_11":0.0,"dia_12":0.0,"dia_13":8367.5,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":4592.2,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":22670.74},
            {"nome":"Links de Dados / Voip","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":12973.53,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":471.04,"dia_12":0.0,"dia_13":18753.53,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":24635.15,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":56833.25},
            {"nome":"Vtal","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":64036.63,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":64036.63},
            {"nome":"Alugueis de Postes","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Alugueis de Torre e POP","valores":{"dia_1":0.0,"dia_2":2608.34,"dia_3":0.0,"dia_4":0.0,"dia_5":2981.88,"dia_6":930.34,"dia_7":0.0,"dia_8":0.0,"dia_9":1200.0,"dia_10":700.0,"dia_11":0.0,"dia_12":0.0,"dia_13":450.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":1570.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":10440.56},
            {"nome":"Custo com SVA","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":13393.41,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":13393.41},
            {"nome":"Energia / POP","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":1761.17,"dia_10":2524.57,"dia_11":860.62,"dia_12":746.72,"dia_13":5153.94,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":11047.02},
            {"nome":"Manutenção POP","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":352.69,"dia_10":0.0,"dia_11":339.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":691.69},
            {"nome":"Comissões de vendas","valores":{"dia_1":0.0,"dia_2":259.7,"dia_3":0.0,"dia_4":6648.57,"dia_5":1939.2,"dia_6":329.6,"dia_7":0.0,"dia_8":0.0,"dia_9":17012.48,"dia_10":0.0,"dia_11":0.0,"dia_12":1652.55,"dia_13":1011.77,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":418.9,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":29272.77},
            {"nome":"Combustivel técnico","valores":{"dia_1":0.0,"dia_2":15837.8,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":17038.23,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":32876.03},
            {"nome":"Manut. Veículo","valores":{"dia_1":0.0,"dia_2":2943.33,"dia_3":180.0,"dia_4":0.0,"dia_5":756.49,"dia_6":3035.0,"dia_7":0.0,"dia_8":0.0,"dia_9":2090.02,"dia_10":0.0,"dia_11":0.0,"dia_12":1150.47,"dia_13":3282.28,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":419.32,"dia_20":630.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":14486.91},
            {"nome":"Folha - Direta","valores":{"dia_1":0.0,"dia_2":410.04,"dia_3":3182.67,"dia_4":1288.0,"dia_5":5100.0,"dia_6":313107.63,"dia_7":0.0,"dia_8":0.0,"dia_9":6381.86,"dia_10":3374.4,"dia_11":1169.66,"dia_12":2413.57,"dia_13":4931.23,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":64202.31,"dia_20":155197.87,"dia_21":0.0,"dia_22":0.0,"dia_23":452.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":561211.24},
            {"nome":"Telefonia","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":3506.71,"dia_11":59.0,"dia_12":119.99,"dia_13":707.52,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":4393.22},
            {"nome":"Man. Equipamento","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":140.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":140.0},
            {"nome":"Ferramentas","valores":{"dia_1":0.0,"dia_2":3008.85,"dia_3":660.0,"dia_4":656.25,"dia_5":110.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":789.38,"dia_10":740.0,"dia_11":0.0,"dia_12":0.0,"dia_13":302.5,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":20.8,"dia_20":195.24,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":6483.02},
            {"nome":"Moveis e equipamentos escritório TI","valores":{"dia_1":0.0,"dia_2":813.99,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":419.54,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":1233.53},
            {"nome":"Tercerização de Serv. (Instalações)","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Custos Lastmile","valores":{"dia_1":0.0,"dia_2":2585.87,"dia_3":0.0,"dia_4":0.0,"dia_5":1550.78,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":3450.19,"dia_11":0.0,"dia_12":300.0,"dia_13":4529.34,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":4550.0,"dia_21":0.0,"dia_22":0.0,"dia_23":16974.23,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":33940.41}
      ],
      "despesas_operacionais": [{"nome":"Marketing","valores":{"dia_1":0.0,"dia_2":29963.88,"dia_3":0.0,"dia_4":0.0,"dia_5":4306.28,"dia_6":357.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":12229.58,"dia_11":0.0,"dia_12":0.0,"dia_13":1645.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":1166.0,"dia_20":1677.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":51344.74},
            {"nome":"Serv. Terceiros, jurídicos e consultorias","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":2449.75,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":2410.05,"dia_11":2400.0,"dia_12":7500.0,"dia_13":12916.2,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":25.0,"dia_20":786.23,"dia_21":0.0,"dia_22":0.0,"dia_23":1400.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":29887.23},
            {"nome":"Viagens/Estadia","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Segurança Trabalho/ EPI","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":1392.0,"dia_10":0.0,"dia_11":487.0,"dia_12":0.0,"dia_13":162.42,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":2041.42},
            {"nome":"Desp. Aluguel de escritório","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":582.75,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":26346.35,"dia_10":65.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":26994.1},
            {"nome":"Desp. Reformas empresa","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":446.72,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":832.91,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":20.0,"dia_20":894.08,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":2193.71},
            {"nome":"Material de uso, consumo e papelaria","valores":{"dia_1":0.0,"dia_2":169.8,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":15.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":143.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":327.8},
            {"nome":"Combustivel Adm","valores":{"dia_1":0.0,"dia_2":489.43,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":20.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":292.29,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":801.72},
            {"nome":"Despesas e taxas com Veiculos","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":430.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":214.15,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":11954.33,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":449.08,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":13047.56},
            {"nome":"Despesas Tributárias/ Taxas legais","valores":{"dia_1":0.0,"dia_2":324.63,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":259.8,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":-13.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":571.43},
            {"nome":"Despesas Judiciais","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Treinamentos","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Pró-Labore","valores":{"dia_1":0.0,"dia_2":44133.2,"dia_3":100613.0,"dia_4":42917.99,"dia_5":12335.81,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":200000.0},
            {"nome":"Sistema","valores":{"dia_1":0.0,"dia_2":1091.7,"dia_3":0.0,"dia_4":0.0,"dia_5":3705.13,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":1134.45,"dia_10":6257.64,"dia_11":0.0,"dia_12":0.0,"dia_13":2855.12,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":6803.37,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":21847.41},
            {"nome":"Taxas Boleto","valores":{"dia_1":6.24,"dia_2":122.45,"dia_3":388.69,"dia_4":197.7,"dia_5":222.68,"dia_6":526.74,"dia_7":18.24,"dia_8":10.8,"dia_9":192.98,"dia_10":2375.62,"dia_11":715.8,"dia_12":139.58,"dia_13":145.44,"dia_14":10.32,"dia_15":11.28,"dia_16":12.72,"dia_17":9.6,"dia_18":198.76,"dia_19":530.08,"dia_20":234.96,"dia_21":9.84,"dia_22":6.48,"dia_23":587.46,"dia_24":52.68,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":6727.14},
            {"nome":"Enérgia Elétrica escritório","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":4977.36,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":4977.36},
            {"nome":"Despesas Diversas / Estacionamento","valores":{"dia_1":0.0,"dia_2":39.9,"dia_3":0.0,"dia_4":0.0,"dia_5":10.0,"dia_6":285.65,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":133.06,"dia_11":31.94,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":114.0,"dia_20":2187.5,"dia_21":0.0,"dia_22":0.0,"dia_23":913.46,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":3715.51},
            {"nome":"Tarifas bancárias","valores":{"dia_1":0.0,"dia_2":-358.94,"dia_3":131.85,"dia_4":10.73,"dia_5":10.74,"dia_6":13.46,"dia_7":0.0,"dia_8":0.0,"dia_9":18.66,"dia_10":24.21,"dia_11":108.57,"dia_12":6.73,"dia_13":12.05,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":13.35,"dia_19":16.26,"dia_20":8.15,"dia_21":0.0,"dia_22":0.0,"dia_23":15.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":30.82}
      ],
      "despesas_financeiras": [{"nome":"EBITDA","valores":{"dia_1":18632.1,"dia_2":3668.03,"dia_3":-34715.82,"dia_4":34533.59,"dia_5":-21475.34,"dia_6":-162097.03,"dia_7":26541.37,"dia_8":19383.92,"dia_9":-11645.77,"dia_10":112363.02,"dia_11":202256.73,"dia_12":74903.01,"dia_13":-38796.13,"dia_14":18209.01,"dia_15":17842.08,"dia_16":18487.14,"dia_17":14086.59,"dia_18":106215.04,"dia_19":79383.23,"dia_20":-159305.34,"dia_21":22737.15,"dia_22":12969.23,"dia_23":161635.78,"dia_24":33292.86,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":549104.45}],
      "ajustes_caixa": [{"nome":"Investimento","valores":{"dia_1":0.0,"dia_2":1900.0,"dia_3":0.0,"dia_4":0.0,"dia_5":51200.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":3611.8,"dia_10":0.0,"dia_11":1831.78,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":1265.56,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":59809.14},
            {"nome":"Empr/Finac/Parcel","valores":{"dia_1":0.0,"dia_2":13371.34,"dia_3":587.23,"dia_4":0.0,"dia_5":8846.13,"dia_6":24182.54,"dia_7":0.0,"dia_8":0.0,"dia_9":29546.52,"dia_10":12075.93,"dia_11":14184.74,"dia_12":163285.78,"dia_13":59237.31,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":45262.36,"dia_19":8680.0,"dia_20":7114.69,"dia_21":0.0,"dia_22":0.0,"dia_23":10319.32,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":396693.89},
            {"nome":"Impostos","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":0.0,"dia_6":0.0,"dia_7":0.0,"dia_8":0.0,"dia_9":0.0,"dia_10":0.0,"dia_11":0.0,"dia_12":0.0,"dia_13":0.0,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":0.0,"dia_19":0.0,"dia_20":0.0,"dia_21":0.0,"dia_22":0.0,"dia_23":0.0,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":0.0},
            {"nome":"Sócios ou Retiradas","valores":{"dia_1":0.0,"dia_2":0.0,"dia_3":0.0,"dia_4":0.0,"dia_5":3446.13,"dia_6":24182.54,"dia_7":0.0,"dia_8":0.0,"dia_9":23565.22,"dia_10":10623.18,"dia_11":12143.75,"dia_12":161899.0,"dia_13":18243.83,"dia_14":0.0,"dia_15":0.0,"dia_16":0.0,"dia_17":0.0,"dia_18":30094.0,"dia_19":1400.0,"dia_20":4752.76,"dia_21":0.0,"dia_22":0.0,"dia_23":9319.32,"dia_24":0.0,"dia_25":0.0,"dia_26":0.0,"dia_27":0.0,"dia_28":0.0,"dia_29":0.0,"dia_30":0.0,"dia_31":0.0},"total":299669.73}
      ]
      }
    };


    function showTab(cat,el) {
      document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
      if(el) el.classList.add('active');
      renderTable(cat);
    }

    function toggleCategoria(categoria) {
      const rows = document.querySelectorAll(`.sub-${categoria}`);
      const icon = document.querySelector(`.expand-${categoria}`);
      rows.forEach(r => r.classList.toggle('hidden'));
      if (icon) icon.classList.toggle('expanded');
    }

    function renderTable(categoria) {
      const data = dadosFinanceiros[categoria];

      let html = `
        <table>
          <thead>
            <tr>
              <th>Categoria</th>
              <th class="value-cell">Jan/26</th>
              <th class="value-cell">Fev/26</th>
              <th class="value-cell">Mar/26</th>
              <th class="value-cell">Abr/26</th>
              <th class="value-cell">Mai/26</th>
              <th class="value-cell">Jun/26</th>
              <th class="value-cell">Jul/26</th>
              <th class="value-cell">Ago/26</th>
              <th class="value-cell">Set/26</th>
              <th class="value-cell">Out/26</th>
              <th class="value-cell">Nov/26</th>
              <th class="value-cell">Dez/26</th>
              <th class="value-cell">Total 2026</th>
            </tr>
          </thead>
          <tbody>
      `;

      /* ===================== EBITDA ===================== */
      if (categoria === 'ebitda') {
        const meses = ['jan', 'fev', 'mar', 'abr', 'mai', 'jun', 'jul', 'ago', 'set', 'out', 'nov', 'dez'];
        const ebitdaBase = dadosFinanceiros.ebitda[0];
        const ebitdaMensal = meses.map(mes => ebitdaBase[mes] || 0);
        const ebitdaTotal = ebitdaMensal.reduce((sum, val) => sum + val, 0);

        // Ajustes = todos exceto "EBITDA (Ajustado)"
        const ajustes = dadosFinanceiros.ebitda_ajustado.filter(i => i.nome !== 'EBITDA (Ajustado)');

        // EBITDA (Ajustado) usa o valor DIRETO da planilha, não recalculado
        const ebitdaAjItem = dadosFinanceiros.ebitda_ajustado.find(i => i.nome === 'EBITDA (Ajustado)');
        const ebitdaAjMensal = meses.map(mes => ebitdaAjItem ? (ebitdaAjItem[mes] || 0) : 0);
        const ebitdaAjTotal  = ebitdaAjMensal.reduce((s,v) => s+v, 0);

        html += `
          <tr class="category-row" onclick="toggleCategoria('ebitda')">
            <td>
              <div class="category-header">
                <span class="expand-icon expand-ebitda">▶</span>
                <strong>EBITDA</strong>
              </div>
            </td>
            ${ebitdaMensal.map(valor => `<td class="value-cell"><strong>${formatCurrency(valor)}</strong></td>`).join('')}
            <td class="value-cell"><strong>${formatCurrency(ebitdaTotal)}</strong></td>
          </tr>
        `;
        ajustes.forEach(item => {
          html += `
            <tr class="sub-item sub-ebitda hidden">
              <td>${item.nome}</td>
              ${meses.map(mes => `<td class="value-cell">${item[mes] ? formatCurrency(item[mes]) : '-'}</td>`).join('')}
              <td class="value-cell">${formatCurrency(item.total || 0)}</td>
            </tr>
          `;
        });
        html += `
          <tr class="category-row" onclick="toggleCategoria('ebitda-ajustado')">
            <td>
              <div class="category-header">
                <span class="expand-icon expand-ebitda-ajustado">▶</span>
                <strong>EBITDA (Ajustado)</strong>
              </div>
            </td>
            ${ebitdaAjMensal.map(valor => `<td class="value-cell"><strong>${formatCurrency(valor)}</strong></td>`).join('')}
            <td class="value-cell"><strong>${formatCurrency(ebitdaAjTotal)}</strong></td>
          </tr>
          <tr class="sub-item sub-ebitda-ajustado hidden">
            <td>EBITDA (Ajustado)</td>
            ${ebitdaAjMensal.map(valor => `<td class="value-cell">${formatCurrency(valor)}</td>`).join('')}
            <td class="value-cell">${formatCurrency(ebitdaAjTotal)}</td>
          </tr>
          <tr class="sub-item sub-ebitda-ajustado hidden">
            <td>Folha / Receita Total</td>
            <td class="value-cell">31,05%</td>
            <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
          </tr>
          <tr class="sub-item sub-ebitda-ajustado hidden">
            <td>Rescisão / Folha</td>
            <td class="value-cell">0,40%</td>
            <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
          </tr>
          <tr class="sub-item sub-ebitda-ajustado hidden">
            <td>Folha / Receita Total - 2024</td>
            <td class="value-cell">22,80%</td>
            <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
          </tr>
        `;
      }
      /* ===================== OUTRAS CATEGORIAS ===================== */
      else {
        const totalJan = data.reduce((acc, i) => acc + (i.jan || 0), 0);
        const totalFev = data.reduce((acc, i) => acc + (i.fev || 0), 0);
        const totalAno = data.reduce((acc, i) => acc + (i.total || 0), 0);

        html += `
          <tr class="category-row" onclick="toggleCategoria('${categoria}')">
            <td>
              <div class="category-header">
                <span class="expand-icon expand-${categoria}">▶</span>
                <strong>${categoria.toUpperCase()}</strong>
              </div>
            </td>
            <td class="value-cell month-cell" onclick="event.stopPropagation();abrirModalDiario('JAN/26', '${categoria}')"><strong>${formatCurrency(totalJan)}</strong></td>
            <td class="value-cell month-cell" onclick="event.stopPropagation();abrirModalDiario('FEV/26', '${categoria}')"><strong>${formatCurrency(totalFev)}</strong></td>
            <td class="value-cell">-</td>
            <td class="value-cell">-</td>
            <td class="value-cell">-</td>
            <td class="value-cell">-</td>
            <td class="value-cell">-</td>
            <td class="value-cell">-</td>
            <td class="value-cell">-</td>
            <td class="value-cell">-</td>
            <td class="value-cell">-</td>
            <td class="value-cell">-</td>
            <td class="value-cell"><strong>${formatCurrency(totalAno)}</strong></td>
          </tr>
        `;
        data.forEach(item => {
          html += `
            <tr class="sub-item sub-${categoria} hidden">
              <td>${item.nome}</td>
              <td class="value-cell">${item.jan ? formatCurrency(item.jan) : '-'}</td>
              <td class="value-cell">${item.fev ? formatCurrency(item.fev) : '-'}</td>
              <td class="value-cell">-</td>
              <td class="value-cell">-</td>
              <td class="value-cell">-</td>
              <td class="value-cell">-</td>
              <td class="value-cell">-</td>
              <td class="value-cell">-</td>
              <td class="value-cell">-</td>
              <td class="value-cell">-</td>
              <td class="value-cell">-</td>
              <td class="value-cell">-</td>
              <td class="value-cell"><strong>${formatCurrency(item.total)}</strong></td>
            </tr>
          `;
        });
      }

      html += `</tbody></table>`;
      document.getElementById('tableContent').innerHTML = html;
    }

    function abrirModalDiario(mes, categoria) {
      const modal = document.getElementById('dailyModal');
      const modalTitle = document.getElementById('modalTitle');
      const modalContent = document.getElementById('modalTableContent');
      const meses = { 'JAN/26': 'Janeiro 2026', 'FEV/26': 'Fevereiro 2026', 'MAR/26': 'Março 2026' };
      modalTitle.textContent = `Detalhamento Diário — ${meses[mes] || mes} — ${categoria.toUpperCase()}`;
      if (!dadosDiarios[mes]) {
        modalContent.innerHTML = '<p style="text-align:center;padding:2rem;color:#64748b;">Dados diários não disponíveis para este mês.</p>';
        modal.classList.add('active'); return;
      }
      // Mapeia categorias do showTab para as chaves em dadosDiarios
      const catMap = { 'despesas': 'despesas_operacionais', 'ebitda': 'despesas_financeiras', 'ebitda_ajustado': 'despesas_financeiras' };
      const chave = catMap[categoria] || categoria;
      let dadosCategoria = dadosDiarios[mes][chave] || [];
      if (dadosCategoria.length === 0) {
        modalContent.innerHTML = '<p style="text-align:center;padding:2rem;color:#64748b;">Nenhum dado encontrado para esta categoria neste mês.</p>';
        modal.classList.add('active'); return;
      }
      // Detecta quantos dias tem o mês
      const diasPorMes = { 'JAN':31,'FEV':28,'MAR':31,'ABR':30,'MAI':31,'JUN':30,'JUL':31,'AGO':31,'SET':30,'OUT':31,'NOV':30,'DEZ':31 };
      const mesAbrev = mes.split('/')[0];
      const numDias = diasPorMes[mesAbrev] || 31;
      let html = '<table class="daily-table"><thead><tr><th>Item</th>';
      for (let dia = 1; dia <= numDias; dia++) html += `<th class="day-header">${dia}</th>`;
      html += '<th class="day-header">TOTAL</th></tr></thead><tbody>';
      dadosCategoria.forEach(item => {
        html += '<tr>';
        html += `<td><strong>${item.nome}</strong></td>`;
        for (let dia = 1; dia <= numDias; dia++) {
          const valor = item.valores[`dia_${dia}`] || 0;
          const cor = valor < 0 ? 'color:#b91c1c;' : '';
          html += `<td class="day-value" style="${cor}">${valor === 0 ? '-' : formatCurrency(valor)}</td>`;
        }
        const cor = item.total < 0 ? 'color:#b91c1c;' : '';
        html += `<td class="day-value" style="${cor}"><strong>${formatCurrency(item.total)}</strong></td></tr>`;
      });
      html += '<tr class="total-row"><td>TOTAL</td>';
      for (let dia = 1; dia <= numDias; dia++) {
        let totalDia = dadosCategoria.reduce((acc, item) => acc + (item.valores[`dia_${dia}`] || 0), 0);
        html += `<td class="day-value">${totalDia === 0 ? '-' : formatCurrency(totalDia)}</td>`;
      }
      const totalGeral = dadosCategoria.reduce((acc, item) => acc + item.total, 0);
      const corTotal = totalGeral < 0 ? 'color:#b91c1c;' : '';
      html += `<td class="day-value" style="${corTotal}"><strong>${formatCurrency(totalGeral)}</strong></td></tr>`;
      html += '</tbody></table>';
      modalContent.innerHTML = html;
      modal.classList.add('active');
    }

    function abrirModalTudoConsolidado() {
      const modal = document.getElementById('dailyModal');
      const modalTitle = document.getElementById('modalTitle');
      const modalContent = document.getElementById('modalTableContent');
      // Usa o mês selecionado no filtro de período do Consolidado
      const [anoSel, mesSel] = (document.getElementById('consolidadoPeriodo')?.value || '2026-01').split('-');
      const MESES_ABREV_KEY = ['JAN','FEV','MAR','ABR','MAI','JUN','JUL','AGO','SET','OUT','NOV','DEZ'];
      const MESES_NOME_FULL = ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
      const mesIdx = parseInt(mesSel) - 1;
      const mes = MESES_ABREV_KEY[mesIdx] + '/' + anoSel.slice(2);
      modalTitle.textContent = `Fluxo de Caixa Detalhado — ${MESES_NOME_FULL[mesIdx]} ${anoSel}`;
      if (!dadosDiarios[mes]) {
        modalContent.innerHTML = '<p style="text-align:center;padding:2rem;color:#64748b;">Dados não disponíveis.</p>';
        modal.classList.add('active'); return;
      }
      const categorias = [
        { chave: 'receitas', nome: 'RECEITAS' },
        { chave: 'impostos', nome: 'IMPOSTOS' },
        { chave: 'custos', nome: 'CUSTOS' },
        { chave: 'despesas_operacionais', nome: 'DESPESAS OPERACIONAIS' },
        { chave: 'despesas_financeiras', nome: 'DESPESAS FINANCEIRAS' },
        { chave: 'ajustes_caixa', nome: 'AJUSTES DE CAIXA' }
      ];
      let html = '<table class="daily-table"><thead><tr><th>Categoria / Subcategoria</th>';
      for (let dia = 1; dia <= 31; dia++) html += `<th class="day-header">${dia}</th>`;
      html += '<th class="day-header">TOTAL</th></tr></thead><tbody>';
      let totalGeralTudo = 0;
      let totaisDiarios = {};
      for (let dia = 1; dia <= 31; dia++) totaisDiarios[`dia_${dia}`] = 0;
      categorias.forEach(catInfo => {
        const dadosCategoria = dadosDiarios[mes][catInfo.chave] || [];
        if (dadosCategoria.length > 0) {
          html += `<tr style="background:#e0f2fe;font-weight:700;"><td colspan="33" style="padding:1rem;font-size:1rem;">${catInfo.nome}</td></tr>`;
          dadosCategoria.forEach(item => {
            html += '<tr>';
            html += `<td style="padding-left:2rem;">${item.nome}</td>`;
            for (let dia = 1; dia <= 31; dia++) {
              const valor = item.valores[`dia_${dia}`] || 0;
              html += `<td class="day-value">${valor === 0 ? '-' : formatCurrency(valor)}</td>`;
              totaisDiarios[`dia_${dia}`] += valor;
            }
            html += `<td class="day-value"><strong>${formatCurrency(item.total)}</strong></td></tr>`;
            totalGeralTudo += item.total;
          });
          const totalCategoria = dadosCategoria.reduce((acc, item) => acc + item.total, 0);
          html += '<tr style="background:#f1f5f9;font-weight:600;">';
          html += `<td style="padding-left:1rem;">SUBTOTAL ${catInfo.nome}</td>`;
          for (let dia = 1; dia <= 31; dia++) {
            let totalDiaCategoria = dadosCategoria.reduce((acc, item) => acc + (item.valores[`dia_${dia}`] || 0), 0);
            html += `<td class="day-value">${totalDiaCategoria === 0 ? '-' : formatCurrency(totalDiaCategoria)}</td>`;
          }
          html += `<td class="day-value">${formatCurrency(totalCategoria)}</td></tr>`;
        }
      });
      html += '<tr class="total-row" style="background:#2563eb;color:white;"><td><strong>TOTAL GERAL</strong></td>';
      for (let dia = 1; dia <= 31; dia++) {
        html += `<td class="day-value" style="color:white;">${totaisDiarios[`dia_${dia}`] === 0 ? '-' : formatCurrency(totaisDiarios[`dia_${dia}`])}</td>`;
      }
      html += `<td class="day-value" style="color:white;"><strong>${formatCurrency(totalGeralTudo)}</strong></td></tr>`;
      html += '</tbody></table>';
      modalContent.innerHTML = html;
      modal.classList.add('active');
    }

    function abrirModalConsolidadoAnual() {
      const modal = document.getElementById('dailyModal');
      const modalTitle = document.getElementById('modalTitle');
      const modalContent = document.getElementById('modalTableContent');
      const ano = document.getElementById('consolidadoAnoFiltro')?.value || '2026';
      modalTitle.textContent = `Consolidado Anual — ${ano}`;

      const MESES   = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
      const LABELS  = ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];

      const categorias = [
        { chave:'receitas',           nome:'RECEITAS' },
        { chave:'impostos',           nome:'IMPOSTOS' },
        { chave:'custos',             nome:'CUSTOS' },
        { chave:'despesas',           nome:'DESPESAS OPERACIONAIS' },
        { chave:'ebitda',             nome:'EBITDA' },
        { chave:'ebitda_ajustado',    nome:'EBITDA AJUSTADO' },
        { chave:'ajustes',            nome:'AJUSTES DE CAIXA' },
        { chave:'bancos',             nome:'BANCOS' },
      ];

      // Cabeçalho
      let html = `<table class="daily-table"><thead><tr>
        <th style="min-width:220px;text-align:left;padding:0.75rem 1rem;">Categoria / Subcategoria</th>`;
      LABELS.forEach(l => { html += `<th class="day-header">${l}</th>`; });
      html += `<th class="day-header" style="background:#1e3a8a;color:white;">TOTAL</th></tr></thead><tbody>`;

      // Totais gerais por mês
      const totalGeralMes = {};
      MESES.forEach(m => totalGeralMes[m] = 0);
      let totalGeralAno = 0;

      categorias.forEach(catInfo => {
        const itens = dadosFinanceiros[catInfo.chave] || [];
        if (itens.length === 0) return;

        // Linha de categoria
        html += `<tr style="background:#e0f2fe;font-weight:700;">
          <td colspan="${MESES.length + 2}" style="padding:0.75rem 1rem;font-size:0.95rem;letter-spacing:0.03em;">${catInfo.nome}</td></tr>`;

        // Totais da categoria por mês
        const subtotalMes = {};
        MESES.forEach(m => subtotalMes[m] = 0);
        let subtotalAno = 0;

        itens.forEach(item => {
          html += `<tr><td style="padding:0.5rem 0.75rem 0.5rem 2rem;font-size:0.85rem;">${item.nome}</td>`;
          let rowTotal = 0;
          MESES.forEach(m => {
            const v = item[m] || 0;
            subtotalMes[m] += v;
            rowTotal += v;
            const cor = v < 0 ? 'color:#b91c1c;' : '';
            html += `<td class="day-value" style="${cor}">${v === 0 ? '<span style="color:#cbd5e1">—</span>' : formatCurrency(v)}</td>`;
          });
          // usa total do objeto se existir, senão soma dos meses
          const tot = item.total !== undefined ? item.total : rowTotal;
          subtotalAno += tot;
          const corTot = tot < 0 ? 'color:#b91c1c;' : '';
          html += `<td class="day-value" style="font-weight:700;${corTot}">${formatCurrency(tot)}</td></tr>`;
        });

        // Linha de subtotal da categoria
        html += `<tr style="background:#f1f5f9;font-weight:700;border-top:2px solid #e2e8f0;">
          <td style="padding:0.6rem 0.75rem 0.6rem 1rem;font-size:0.85rem;">SUBTOTAL ${catInfo.nome}</td>`;
        MESES.forEach(m => {
          const v = subtotalMes[m];
          const cor = v < 0 ? 'color:#b91c1c;' : 'color:#1e3a8a;';
          html += `<td class="day-value" style="${cor}">${v === 0 ? '—' : formatCurrency(v)}</td>`;
          totalGeralMes[m] += v;
        });
        html += `<td class="day-value" style="color:#1e3a8a;font-weight:800;">${formatCurrency(subtotalAno)}</td></tr>`;
        totalGeralAno += subtotalAno;

        // Espaço visual entre categorias
        html += `<tr style="height:6px;background:#f8fafc;"><td colspan="${MESES.length + 2}"></td></tr>`;
      });

      // Linha de total geral
      html += `<tr style="background:linear-gradient(135deg,#1e3a8a,#2563eb);color:white;font-weight:800;font-size:0.95rem;">
        <td style="padding:0.9rem 1rem;">TOTAL GERAL ${ano}</td>`;
      MESES.forEach(m => {
        const v = totalGeralMes[m];
        html += `<td class="day-value" style="color:white;">${v === 0 ? '—' : formatCurrency(v)}</td>`;
      });
      html += `<td class="day-value" style="color:white;font-size:1.05rem;">${formatCurrency(totalGeralAno)}</td></tr>`;
      html += `</tbody></table>`;

      modalContent.innerHTML = html;
      modal.classList.add('active');
    }

    function showCompTab(cat,el) {
      document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
      if(el) el.classList.add('active');
      renderCompTab(cat);
    }

    function renderCompTab(cat) {
      const map = {'receitas-comp':['receitas','Receitas Totais'],'custos-comp':['custos','Custos Totais'],'despesas-comp':['despesas','Despesas Totais'],'ebitda-comp':['ebitda','EBITDA']};
      const [key,label] = map[cat]||['receitas','Receitas'];
      const v26=dadosComparativos[2026][key],v25=dadosComparativos[2025][key],v24=dadosComparativos[2024][key];
      const var2524=((v25-v24)/v24*100).toFixed(1),var2625=((v26-v25)/v25*100).toFixed(1);
      document.getElementById('compTableContent').innerHTML = `<table style="min-width:700px"><thead><tr><th>${label}</th><th class="value-cell">2024</th><th class="value-cell">2025</th><th class="value-cell">2026</th><th class="value-cell">Var 25/24</th><th class="value-cell">Var 26/25</th></tr></thead><tbody>
        <tr class="total-row"><td>${label}</td><td class="value-cell">${formatCurrency(v24)}</td><td class="value-cell">${formatCurrency(v25)}</td><td class="value-cell">${formatCurrency(v26)}</td>
        <td class="value-cell ${v25>v24?'positive-value':'negative-value'}">+${var2524}%</td>
        <td class="value-cell ${v26>v25?'positive-value':'negative-value'}">+${var2625}%</td></tr>
      </tbody></table>`;
    }

    function renderComparisonCards() {
      const anos = [2024,2025,2026];
      const indicadores = [{k:'receitas',l:'Receitas'},{k:'custos',l:'Custos'},{k:'despesas',l:'Despesas'},{k:'ebitda',l:'EBITDA'},{k:'ebitdaAjustado',l:'EBITDA Aj.'}];
      let html = '';
      indicadores.forEach(({k,l}) => {
        html += `<div class="comparison-card"><div class="comparison-card-title">${l}</div>`;
        anos.forEach(ano => {
          const v = dadosComparativos[ano][k];
          const vp = ano>2024?dadosComparativos[ano-1][k]:null;
          const var_ = vp?((v-vp)/vp*100).toFixed(1):null;
          html += `<div class="comparison-item"><span class="comparison-label">${ano}</span><div><div class="comparison-value ${v>=(vp||v)?'positive':'negative'}">${formatCurrency(v)}</div>${var_?`<div class="comparison-variation">+${var_}%</div>`:''}</div></div>`;
        });
        html += '</div>';
      });
      document.getElementById('comparisonGrid').innerHTML = html;
    }

    function selectYear(y,ev) {
      anoSelecionadoComparativo = y;
      document.querySelectorAll('.year-btn').forEach(b=>b.classList.remove('active'));
      ev.target.classList.add('active');
      renderComparisonCards();
      renderCompTab('receitas-comp');
    }

    // ==================== CHARTS ====================
    let charts = {};
    function renderizarGraficos() {
      Object.values(charts).forEach(c=>c.destroy&&c.destroy());
      charts = {};

      const MESES   = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
      const MESES_N = ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
      const mesIdx  = parseInt(document.getElementById('dashMesFiltro')?.value ?? 0);
      const mesKey  = MESES[mesIdx];
      const mesAnterior = mesIdx > 0 ? MESES[mesIdx-1] : null;
      const mesNome = MESES_N[mesIdx];
      const ano     = document.getElementById('dashAnoFiltro')?.value ?? '2026';
      const fc = v => v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
      const fp = v => (v*100).toFixed(1).replace('.',',')+'%';

      // Label período
      const lbl = document.getElementById('dashPeriodoLabel');
      if(lbl) lbl.textContent = mesNome+'/'+ano;

      const df = dadosFinanceiros;

      // === KPIs ===
      const receitas  = df.receitas?.reduce((s,r)=>s+(r[mesKey]||0),0) || 0;
      const custos    = df.custos?.reduce((s,r)=>s+(r[mesKey]||0),0) || 0;
      const despesas  = df.despesas?.reduce((s,r)=>s+(r[mesKey]||0),0) || 0;
      const impostos  = df.impostos?.reduce((s,r)=>s+(r[mesKey]||0),0) || 0;
      const ebitdaItem= df.ebitda_ajustado?.find(r=>r.nome==='EBITDA (Ajustado)');
      const ebitda    = ebitdaItem ? (ebitdaItem[mesKey]||0) : 0;
      const custoTotal= custos + despesas;

      // Vs mês anterior
      const recAnterior = mesAnterior ? (df.receitas?.reduce((s,r)=>s+(r[mesAnterior]||0),0)||0) : 0;
      const custAnterior= mesAnterior ? ((df.custos?.reduce((s,r)=>s+(r[mesAnterior]||0),0)||0)+(df.despesas?.reduce((s,r)=>s+(r[mesAnterior]||0),0)||0)) : 0;

      const setKpi = (id, val) => { const e=document.getElementById(id); if(e) e.textContent=fc(val); };
      const setVar = (id, cur, prev) => {
        const e = document.getElementById(id);
        if(!e) return;
        if(!prev || prev===0) { e.textContent=''; return; }
        const pct = ((cur-prev)/prev)*100;
        e.textContent = (pct>=0?'↑ ':'↓ ')+Math.abs(pct).toFixed(1)+'%';
        e.className = 'stat-change '+(pct>=0?'positive':'negative');
      };

      setKpi('dash_receitas', receitas);
      setKpi('dash_custos', custoTotal);
      setKpi('dash_ebitda', ebitda);
      setKpi('dash_impostos', impostos);

      // Variação vs mês anterior com cor
      const setVarSpan = (id, cur, prev) => {
        const e = document.getElementById(id); if(!e) return;
        if(!prev || prev===0) { e.textContent=''; return; }
        const pct = ((cur-prev)/prev)*100;
        e.style.color = pct>=0 ? '#10b981' : '#ef4444';
        e.textContent = (pct>=0?'↑ ':'↓ ')+Math.abs(pct).toFixed(1)+'%';
      };
      setVarSpan('dash_receitas_var', receitas, recAnterior);
      setVarSpan('dash_custos_var', custoTotal, custAnterior);

      const ep = document.getElementById('dash_ebitda_pct');
      if(ep) ep.textContent = receitas>0 ? fp(ebitda/receitas) : '—';
      const ip = document.getElementById('dash_impostos_pct');
      if(ip) ip.textContent = receitas>0 ? fp(impostos/receitas) : '—';

      // === TOOLTIPS detalhamento ===
      const toRow = (nome, val, bold=false) =>
        `<div class="dash-tooltip-row${bold?' dash-tooltip-total':''}">
          <span style="color:#374151;${bold?'font-weight:700':''}">${nome}</span>
          <span style="color:${bold?'#1e293b':'#475569'};${bold?'font-weight:700':''}">${fc(val)}</span>
        </div>`;

      // Receitas tooltip
      const tooltipRec = document.getElementById('dash_tooltip_receitas');
      if(tooltipRec) {
        tooltipRec.innerHTML = (df.receitas||[])
          .filter(r=>(r[mesKey]||0)!==0)
          .map(r=>toRow(r.nome, r[mesKey]||0))
          .join('') + toRow('TOTAL', receitas, true);
      }

      // Despesas tooltip (Impostos + Custos + Despesas separados com subtotal)
      const tooltipDesp = document.getElementById('dash_tooltip_despesas');
      if(tooltipDesp) {
        let html = '<div style="font-size:0.72rem;color:#ef4444;font-weight:700;margin-bottom:0.25rem">Impostos</div>';
        html += (df.impostos||[]).filter(r=>(r[mesKey]||0)!==0).map(r=>toRow(r.nome,r[mesKey]||0)).join('');
        html += '<div style="font-size:0.72rem;color:#f97316;font-weight:700;margin:0.5rem 0 0.25rem">Custos</div>';
        html += (df.custos||[]).filter(r=>(r[mesKey]||0)!==0).map(r=>toRow(r.nome,r[mesKey]||0)).join('');
        html += '<div style="font-size:0.72rem;color:#8b5cf6;font-weight:700;margin:0.5rem 0 0.25rem">Despesas Operacionais</div>';
        html += (df.despesas||[]).filter(r=>(r[mesKey]||0)!==0).map(r=>toRow(r.nome,r[mesKey]||0)).join('');
        html += toRow('TOTAL', custoTotal, true);
        tooltipDesp.innerHTML = html;
      }

      // EBITDA tooltip
      const tooltipEbitda = document.getElementById('dash_tooltip_ebitda');
      if(tooltipEbitda) {
        tooltipEbitda.innerHTML =
          toRow('Receitas', receitas) +
          toRow('(-) Impostos', -impostos) +
          toRow('(-) Custos', -custos) +
          toRow('(-) Despesas', -despesas) +
          toRow('EBITDA Ajustado', ebitda, true);
      }

      // Impostos tooltip
      const tooltipImp = document.getElementById('dash_tooltip_impostos');
      if(tooltipImp) {
        tooltipImp.innerHTML = (df.impostos||[])
          .filter(r=>(r[mesKey]||0)!==0)
          .map(r=>toRow(r.nome, r[mesKey]||0))
          .join('') + toRow('TOTAL', impostos, true);
      }

      // Subtítulos dos gráficos
      const setSub = (id, txt) => { const e=document.getElementById(id); if(e) e.textContent=txt; };
      setSub('dash_sub_rec',   mesNome+'/'+ano+' — Distribuição por categoria');
      setSub('dash_sub_desp',  mesNome+'/'+ano+' — Por tipo');
      setSub('dash_sub_custos',mesNome+'/'+ano+' — Maiores custos');

      const CORES = ['#2563eb','#10b981','#f59e0b','#ef4444','#8b5cf6','#06b6d4','#ec4899','#84cc16','#f97316','#14b8a6'];

      // === Gráfico Receitas ===
      const recFiltrado = df.receitas?.filter(r=>(r[mesKey]||0)>0) || [];
      charts.receitas = new Chart(document.getElementById('receitasChart'),{
        type:'doughnut',
        data:{labels:recFiltrado.map(r=>r.nome),datasets:[{data:recFiltrado.map(r=>r[mesKey]||0),backgroundColor:CORES}]},
        options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{boxWidth:12,font:{size:10}}},tooltip:{callbacks:{label:ctx=>' '+fc(ctx.raw)}}}}
      });

      // === Gráfico Despesas ===
      const despFiltrado = df.despesas?.filter(d=>(d[mesKey]||0)>0 && d.nome !== 'Pró-Labore') || [];
      charts.despesas = new Chart(document.getElementById('despesasChart'),{
        type:'pie',
        data:{labels:despFiltrado.map(d=>d.nome),datasets:[{data:despFiltrado.map(d=>d[mesKey]||0),backgroundColor:CORES}]},
        options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{boxWidth:12,font:{size:10}}},tooltip:{callbacks:{label:ctx=>' '+fc(ctx.raw)}}}}
      });

      // === Gráfico Evolução Mensal ===
      const recMensal  = MESES.map(m=>df.receitas?.reduce((s,r)=>s+(r[m]||0),0)||0);
      const custMensal = MESES.map(m=>(df.custos?.reduce((s,r)=>s+(r[m]||0),0)||0)+(df.despesas?.reduce((s,r)=>s+(r[m]||0),0)||0));
      const ebitdaMensal = MESES.map(m=>{ const e=df.ebitda_ajustado?.find(r=>r.nome==='EBITDA (Ajustado)'); return e?(e[m]||0):0; });
      charts.comp = new Chart(document.getElementById('comparativoReceitasChart'),{
        type:'bar',
        data:{
          labels:MTHS_L,
          datasets:[
            {label:'Receitas',    data:recMensal,    backgroundColor:'rgba(37,99,235,0.75)', order:2},
            {label:'Cust+Desp',   data:custMensal,   backgroundColor:'rgba(239,68,68,0.75)', order:2},
            {label:'EBITDA Aj.',  data:ebitdaMensal, type:'line', borderColor:'#059669', backgroundColor:'rgba(5,150,105,0.1)', pointRadius:4, tension:0.3, fill:true, order:1, yAxisID:'y'}
          ]
        },
        options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,ticks:{callback:v=>'R$'+Math.round(v/1000)+'k'}}},plugins:{tooltip:{callbacks:{label:ctx=>ctx.dataset.label+': '+fc(ctx.raw)}}}}
      });

      // === Top 10 Custos ===
      const top10 = [...(df.custos||[])].filter(c=>(c[mesKey]||0)>0).sort((a,b)=>(b[mesKey]||0)-(a[mesKey]||0)).slice(0,10);
      charts.custos = new Chart(document.getElementById('custosChart'),{
        type:'bar',
        data:{labels:top10.map(c=>c.nome.length>22?c.nome.substr(0,20)+'…':c.nome),datasets:[{label:mesNome+'/'+ano,data:top10.map(c=>c[mesKey]||0),backgroundColor:'rgba(245,158,11,0.75)'}]},
        options:{responsive:true,maintainAspectRatio:false,indexAxis:'y',scales:{x:{beginAtZero:true,ticks:{callback:v=>'R$'+Math.round(v/1000)+'k'}}},plugins:{tooltip:{callbacks:{label:ctx=>fc(ctx.raw)}}}}
      });
    }

    // ==================== DIRETORIA ====================
    const CAMPOS = [
      { key: 'base_pf',      label: 'Base Clientes PF'      },
      { key: 'base_pj',      label: 'Base Clientes PJ +PME' },
      { key: 'base_isentos', label: 'Base Isentos'          },
      { key: 'contratos',    label: 'Base de Contratos'     },
      { key: 'os_pf',        label: 'OS Suporte PF'         },
      { key: 'os_pj',        label: 'OS Suporte PJ'         },
      { key: 'nc_pf',        label: 'Novos Clientes PF'     },
      { key: 'nc_pj',        label: 'Novos Clientes PJ'     },
      { key: 'canc_pf',      label: 'Cancelamento PF'       },
      { key: 'canc_pj',      label: 'Cancelam. PME + PJ'    },
      { key: 'retiradas',    label: 'Retiradas'             },
      { key: 'canc_sr',      label: 'Can S/ Retirada'       },
      { key: 'canc_1a',      label: 'Canc. 1a Mensalidade'  },
      { key: 'reat_ret',     label: 'Reativacoes Retirada'  },
      { key: 'nn',           label: 'Novos Negócios'        },
      { key: 'nn_pf',        label: 'Novos Negócios PF'     },
      { key: 'nn_pj',        label: 'Novos Negócios PJ'     },
      { key: 'upgrade',      label: 'Upgrade'               },
      { key: 'reat',         label: 'Reativacoes'           },
      { key: 'val_canc',     label: 'Valor Cancelamento'    },
      { key: 'val_canc_pf',  label: 'Valor Cancelamento PF' },
      { key: 'val_canc_pj',  label: 'Valor Canc. PJ + PME'  },
      { key: 'downgrade',    label: 'Downgrade'             },
      { key: 'resultado',    label: 'Resultado Liquido'     },
      { key: 'juros45',      label: 'Juros < 45'            },
      { key: 'juros45m',     label: 'Juros >45'             },
      { key: 'reajuste',     label: 'Reajuste Contratos'    },
    ];

    function parseBR(s) {
      if (!s) return null;
      s = String(s).replace(/R\$\s*/g, '').trim();
      const neg = s.startsWith('-');
      s = s.replace(/-/g, '').trim();
      if (!s || s === '(Em branco)') return null;
      if (/\d\.\d{3},/.test(s)) s = s.replace(/\./g,'').replace(',','.');
      else if (/,\d{1,2}$/.test(s)) s = s.replace(',','.');
      const v = parseFloat(s);
      return isNaN(v) ? null : (neg ? -v : v);
    }

    function lerPdf(words) {
      const linhas = [];
      for (const w of words.sort((a,b)=>a.y-b.y)) {
        const l = linhas.find(l => Math.abs(l.y - w.y) <= 12);
        if (l) l.ws.push(w);
        else linhas.push({y: w.y, ws: [w]});
      }
      const rows = linhas.map(l => {
        const ws = l.ws.sort((a,b)=>a.x-b.x);
        const LE = ws.filter(w=>w.x<530 && !/\d/.test(w.text) && !['R$','+'].includes(w.text)).map(w=>w.text).join(' ').trim();
        let VE = null;
        for (const w of ws) if (w.x>=530 && w.x<700 && /\d/.test(w.text)) { VE=parseBR(w.text); break; }
        const LD = ws.filter(w=>w.x>=800 && w.x<1080 && !['R$','(Em','branco)'].includes(w.text)).map(w=>w.text).join(' ').trim();
        const negD = ws.some(w=>w.x>=1080 && (w.text==='-R$'||w.text.startsWith('-R$')));
        let VD = null;
        for (const w of ws) {
          if (w.x>=1080 && w.text!=='R$' && w.text!=='-R$' && !w.text.startsWith('(')) {
            const v = parseBR(w.text);
            if (v!==null) { VD = negD ? -Math.abs(v) : v; break; }
          }
        }
        return {y:l.y, LE, VE, LD, VD};
      });
      const getVal = (i, side) => {
        const v = rows[i]['V'+side];
        if (v !== null) return v;
        if (i>0 && rows[i].y - rows[i-1].y <= 22) return rows[i-1]['V'+side];
        return null;
      };
      const mapa = {};
      rows.forEach((r,i)=>{
        if (r.LE) mapa[r.LE] = getVal(i,'E');
        if (r.LD) mapa[r.LD] = getVal(i,'D');
      });
      const n = s => s.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/\s+/g,' ').trim();
      const get = lbl => {
        for (const [k,v] of Object.entries(mapa)) if (n(k)===n(lbl)) return v;
        for (const [k,v] of Object.entries(mapa)) if (n(k).includes(n(lbl))||n(lbl).includes(n(k))) return v;
        return null;
      };
      return {
        base_pf: get('Basse Clientes PF'), base_pj: get('Base Clientes PJ'),
        base_isentos: get('Base Isentos'), contratos: get('Base de Contratos'),
        os_pf: get('OS Suporte PF'), os_pj: get('OS Suporte PJ'),
        nc_pf: get('Novos Clientes PF'), nc_pj: get('Novos Clientes PJ'),
        canc_pf: get('Cancelamento PF'), canc_pj: get('Cancelam.'),
        retiradas: get('Retiradas'), canc_sr: get('Can S/'), canc_1a: get('Canc. 1a'),
        reat_ret: get('Reativacoes Retirada'), nn: get('Novos Negócios'),
        nn_pf: get('Novos Negócios PF'), nn_pj: get('Novos Negócios PJ'),
        upgrade: get('Upgrade'), reat: mapa['Reativacoes'] ?? mapa['Reativações'] ?? null,
        val_canc: mapa['Valor Cancelamento'] ?? null, val_canc_pf: get('Valor Cancelamento PF'),
        val_canc_pj: get('Valor Canc.'), downgrade: get('Downgrade'),
        resultado: get('Resultado'), juros45: get('Juros < 45'),
        juros45m: get('Juros >45'), reajuste: get('Reajuste Contratos') ?? get('Reajuste') ?? null,
      };
    }

    async function diretoriaCarregarPdf(input) {
      const file = input.files[0];
      if (!file) return;
      const loading = document.getElementById('diretoriaLoadingOCR');
      const status  = document.getElementById('diretoriaOCRStatus');
      const bar     = document.getElementById('diretoriaOCRBar');
      loading.style.display = 'block';
      status.textContent = 'Lendo PDF...';
      bar.style.width = '20%';
      document.getElementById('diretoriaPreviewSection').style.display = 'none';
      document.getElementById('diretoriaPdfInfo').style.display = 'none';
      try {
        const buf = await file.arrayBuffer();
        const lib = window['pdfjs-dist/build/pdf'];
        lib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        const pdf = await lib.getDocument(new Uint8Array(buf)).promise;
        bar.style.width = '50%';
        let words = [];
        for (let p=1; p<=pdf.numPages; p++) {
          const page = await pdf.getPage(p);
          const vp   = page.getViewport({scale:1});
          const ct   = await page.getTextContent();
          ct.items.forEach(item => {
            const x = item.transform[4];
            const y = vp.height - item.transform[5];
            const t = item.str.trim();
            if (t) words.push({x,y,text:t});
          });
        }
        bar.style.width = '80%';
        const dados = lerPdf(words);
        const txt = words.map(w=>w.text).join(' ').toLowerCase();
        const MESES_NOME = ['janeiro','fevereiro','marco','abril','maio','junho','julho','agosto','setembro','outubro','novembro','dezembro'];
        const mes = MESES_NOME.findIndex(m => txt.includes(m) || txt.includes(m.normalize('NFD').replace(/[\u0300-\u036f]/g,'')));
        const anoM = txt.match(/20(\d\d)/);
        const ano = anoM ? parseInt('20'+anoM[1]) : 2026;
        bar.style.width = '100%';
        loading.style.display = 'none';
        document.getElementById('diretoriaPdfInfo').style.display = 'block';
        document.getElementById('diretoriaPdfNome').textContent = file.name;
        if (mes>=0) document.getElementById('dirMes').value = mes;
        document.getElementById('dirAno').value = ano;
        diretoriaDadosExtraidos = dados;
        diretoriaMostrarGrid(dados);
        document.getElementById('diretoriaPreviewSection').style.display = 'block';
        // Verifica se já existe registro — só atualiza o aviso, NÃO esconde o grid
        diretoriaAtualizarAviso(mes, ano);
      } catch(e) {
        loading.style.display = 'none';
        alert('Erro: '+e.message);
      }
      input.value='';
    }

    function diretoriaMostrarGrid(dados) {
      const grid = document.getElementById('diretoriaDataGrid');
      grid.innerHTML = '';
      CAMPOS.forEach(c => {
        const val = dados[c.key];
        const div = document.createElement('div');
        div.style.cssText = 'background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:0.75rem 1rem;display:flex;justify-content:space-between;align-items:center;gap:0.5rem;';
        const lbl = document.createElement('span');
        lbl.style.cssText = 'font-size:0.85rem;color:#475569;flex-shrink:0;font-weight:500;';
        lbl.textContent = c.label;
        const inp = document.createElement('input');
        inp.type = 'text';
        inp.dataset.key = c.key;
        inp.value = val !== null && val !== undefined ? val : '';
        inp.placeholder = '—';
        const cor = val===null||val===undefined ? '#94a3b8' : (val<0 ? '#b91c1c' : '#166534');
        inp.style.cssText = `width:120px;text-align:right;border:1px solid #cbd5e1;border-radius:6px;padding:0.3rem 0.6rem;font-weight:700;font-size:0.92rem;color:${cor};background:white;`;
        inp.oninput = function() { diretoriaDadosExtraidos[c.key] = parseBR(this.value); };
        div.appendChild(lbl); div.appendChild(inp); grid.appendChild(div);
      });
    }

    // ==================== STORAGE DIRETORIA ====================
    // Chave: "diretoria_YYYY_MM" — sobrescreve sempre que mesmo mes/ano é carregado
    const DIRETORIA_STORAGE_PREFIX = 'diretoria_';

    function diretoriaStorageKey(mes, ano) {
      const mm = String(parseInt(mes)+1).padStart(2,'0');
      return DIRETORIA_STORAGE_PREFIX + ano + '_' + mm;
    }

    // Só atualiza o aviso de "já existe", sem tocar no grid
    async function diretoriaAtualizarAviso(mes, ano) {
      const info = document.getElementById('dirStorageInfo');
      if (!info) return;
      const MESES_N = ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];
      const existente = await diretoriaLerDados(mes, ano);
      if (existente) {
        const dt = new Date(existente.savedAt);
        const dtStr = dt.toLocaleDateString('pt-BR') + ' ' + dt.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'});
        info.innerHTML = `<span style="color:#d97706">⚠️ Já existe dados de ${MESES_N[mes]}/${ano} salvos (${dtStr}) — ao salvar irá <strong>substituir</strong></span>`;
      } else {
        info.innerHTML = `<span style="color:#64748b">Nenhum dado salvo para ${MESES_N[mes]}/${ano} ainda</span>`;
      }
    }

    async function diretoriaSalvarDados(mes, ano, dados) {
      const key = diretoriaStorageKey(mes, ano);
      try {
        // Apaga o antigo antes de salvar (garante substituição limpa)
        await sbStorage.remove(key);
        await sbStorage.set(key, JSON.stringify({ mes, ano, dados, savedAt: new Date().toISOString() }));
        return true;
      } catch(e) { return false; }
    }

    async function diretoriaLerDados(mes, ano) {
      const key = diretoriaStorageKey(mes, ano);
      try {
        const raw = await sbStorage.get(key);
        return raw ? JSON.parse(raw) : null;
      } catch(e) { return null; }
    }

    // Ao abrir a aba, busca o mês mais recente salvo no Supabase e exibe automaticamente
    async function diretoriaCarregarUltimoMes() {
      // Se já tem dados na tela, só atualiza aviso
      if (diretoriaDadosExtraidos) {
        await diretoriaVerificarMesAno();
        return;
      }

      const ano = document.getElementById('dirAno')?.value ?? '2026';
      const mesAtual = new Date().getMonth(); // 0-11

      // Tenta do mês atual para trás até encontrar um com dados
      for (let m = mesAtual; m >= 0; m--) {
        const dados = await diretoriaLerDados(m, ano);
        if (dados && dados.dados) {
          // Achou! Seleciona esse mês no dropdown e exibe
          document.getElementById('dirMes').value = m;
          diretoriaDadosExtraidos = dados.dados;
          diretoriaMostrarGrid(dados.dados);
          document.getElementById('diretoriaPreviewSection').style.display = 'block';
          document.getElementById('diretoriaPdfInfo').style.display = 'block';
          document.getElementById('diretoriaPdfNome').textContent = `📦 Carregado do Supabase — ${['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'][m]}/${ano}`;
          const dt = new Date(dados.savedAt);
          const dtStr = dt.toLocaleDateString('pt-BR') + ' ' + dt.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'});
          const info = document.getElementById('dirStorageInfo');
          if (info) info.innerHTML = `<span style="color:#059669">✅ Dados de ${['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'][m]}/${ano} carregados (${dtStr})</span>`;
          return;
        }
      }

      // Nenhum mês encontrado — exibe mensagem
      await diretoriaVerificarMesAno();
    }

    async function diretoriaVerificarMesAno() {
      const mes = parseInt(document.getElementById('dirMes')?.value ?? 0);
      const ano = document.getElementById('dirAno')?.value ?? '2026';
      const info = document.getElementById('dirStorageInfo');
      if (!info) return;
      const MESES_N = ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];

      // Se já tem PDF carregado na tela, só atualiza o aviso sem tocar no grid
      if (diretoriaDadosExtraidos) {
        await diretoriaAtualizarAviso(mes, ano);
        return;
      }

      // Sem PDF carregado — busca do Supabase e exibe
      const existente = await diretoriaLerDados(mes, ano);
      if (existente && existente.dados) {
        const dt = new Date(existente.savedAt);
        const dtStr = dt.toLocaleDateString('pt-BR') + ' ' + dt.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'});
        info.innerHTML = `<span style="color:#059669">✅ Dados de ${MESES_N[mes]}/${ano} carregados do Supabase (${dtStr})</span>`;
        diretoriaDadosExtraidos = existente.dados;
        diretoriaMostrarGrid(existente.dados);
        document.getElementById('diretoriaPreviewSection').style.display = 'block';
        const pdfInfo = document.getElementById('diretoriaPdfInfo');
        const pdfNome = document.getElementById('diretoriaPdfNome');
        if (pdfInfo) pdfInfo.style.display = 'block';
        if (pdfNome) pdfNome.textContent = `📦 Carregado do Supabase — ${MESES_N[mes]}/${ano}`;
      } else {
        info.innerHTML = `<span style="color:#64748b">Nenhum dado salvo para ${MESES_N[mes]}/${ano} ainda</span>`;
        document.getElementById('diretoriaPreviewSection').style.display = 'none';
        document.getElementById('diretoriaPdfInfo').style.display = 'none';
      }
    }

    async function diretoriaCarregarInformacoes() {
      const dados = diretoriaGetDados();
      const mes = parseInt(document.getElementById('dirMes').value);
      const ano = document.getElementById('dirAno').value;
      const MESES_N = ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
      const foiSubstituicao = !!(await diretoriaLerDados(mes, ano));
      const ok = await diretoriaSalvarDados(mes, ano, dados);
      const msg = document.getElementById('dirSalvoMsg');
      if (ok) {
        await reajusteSincronizarDeDados(mes, dados);
        msg.style.display = 'block';
        if (foiSubstituicao) {
          msg.style.background = '#fef3c7'; msg.style.color = '#92400e'; msg.style.border = '1px solid #fde68a';
          msg.innerHTML = `🔄 Dados de <strong>${MESES_N[mes]}/${ano}</strong> substituídos com sucesso!`;
        } else {
          msg.style.background = '#f0fdf4'; msg.style.color = '#166534'; msg.style.border = '1px solid #86efac';
          msg.innerHTML = `✅ Dados de <strong>${MESES_N[mes]}/${ano}</strong> salvos no Supabase! Disponíveis para dashboards e relatórios.`;
        }
        await diretoriaAtualizarAviso(mes, ano);
        // Garante que o grid permanece visível após salvar
        document.getElementById('diretoriaPreviewSection').style.display = 'block';
        document.getElementById('diretoriaPdfInfo').style.display = 'block';
        setTimeout(() => { msg.style.display = 'none'; }, 5000);
      } else {
        msg.style.display = 'block';
        msg.style.background = '#fef2f2'; msg.style.color = '#991b1b'; msg.style.border = '1px solid #fca5a5';
        msg.innerHTML = '❌ Erro ao salvar no Supabase. Verifique a conexão.';
      }
    }

    function diretoriaGetDados() {
      const d = {};
      document.querySelectorAll('#diretoriaDataGrid input[data-key]').forEach(i => {
        d[i.dataset.key] = parseBR(i.value);
      });
      return d;
    }

    // ==================== COMISSÃO FINANCEIRO ====================
    // ==================== COMISSÃO FINANCEIRO ====================
    const MESES_KEY  = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
    const MESES_NOME = ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
    const MESES_ABREV= ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];

    // Lê parâmetro numérico da aba Parâmetros (DOM)
    // ===== FORMATAÇÃO DE PARÂMETROS =====
    function parseParamValue(el) {
      const fmt = el.dataset?.format;
      const raw = el.value.trim();
      if (!raw) return 0;
      if (fmt === 'brl') {
        // "R$ 2.401.769,91" → 2401769.91
        return parseFloat(raw.replace(/[R$\s]/g,'').replace(/\./g,'').replace(',','.')) || 0;
      } else if (fmt === 'pct') {
        // "1,9000%" → 1.9
        return parseFloat(raw.replace('%','').replace(',','.')) || 0;
      }
      return parseFloat(raw) || 0;
    }

    function formatParamInput(el) {
      const fmt = el.dataset?.format;
      if (!fmt) return;
      const num = parseParamValue(el);
      if (fmt === 'brl') {
        el.value = num.toLocaleString('pt-BR', {minimumFractionDigits:2, maximumFractionDigits:2});
      } else if (fmt === 'pct') {
        el.value = num.toLocaleString('pt-BR', {minimumFractionDigits:4, maximumFractionDigits:4}) + '%';
      }
    }

    function paramFocus(el) {
      // ao focar: mostra o número puro para edição
      const num = parseParamValue(el);
      el.value = num === 0 ? '' : String(num).replace('.',',');
      el.select();
    }

    function paramBlur(el) {
      // ao sair: reformata e salva
      const raw = el.value.trim().replace(',','.');
      const num = parseFloat(raw) || 0;
      el.value = num; // temporário
      formatParamInput(el);
      salvarParams();
    }

    function initParamFormatting() {
      document.querySelectorAll('[data-format]').forEach(el => {
        if (el.value && el.value !== '' && !el.value.includes('%') && !el.value.includes('R$')) {
          formatParamInput(el);
        }
      });
    }

    function getParam(id, fallback) {
      const el = document.getElementById(id);
      if (!el) return fallback;
      return parseParamValue(el) || fallback;
    }

    // Lê dados do Diretoria PDF — via Supabase
    // ==================== REAJUSTE CONTRATOS ====================
    const MESES_NOMES = ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];
    const MESES_KEYS  = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
    const REAJUSTE_KEY = 'reajuste_contratos_2026';

    async function reajusteCarregar() {
      const grid = document.getElementById('reajusteGrid');
      if (!grid) return;
      let dados = {};
      try {
        const raw = await sbStorage.get(REAJUSTE_KEY);
        if (raw) dados = JSON.parse(raw);
      } catch(e) {}
      grid.innerHTML = MESES_NOMES.map((nome, i) => {
        const key = MESES_KEYS[i];
        const val = dados[key] != null ? dados[key] : '';
        return `<div style="display:flex;flex-direction:column;gap:0.3rem">
          <label style="font-size:0.75rem;font-weight:600;color:#475569">${nome}</label>
          <input id="reaj_${key}" type="text" value="${val !== '' ? val.toLocaleString('pt-BR',{minimumFractionDigits:2,maximumFractionDigits:2}) : ''}"
            placeholder="R$ 0,00"
            style="padding:0.5rem;border:1px solid #e2e8f0;border-radius:6px;font-size:0.85rem;font-weight:700;color:#1e40af;text-align:right;width:100%"
            oninput="this.style.color=this.value?'#1e40af':'#94a3b8'"/>
        </div>`;
      }).join('');
    }

    async function salvarReajuste() {
      const dados = {};
      MESES_KEYS.forEach(key => {
        const el = document.getElementById('reaj_' + key);
        if (el) {
          const raw = el.value.replace(/\./g,'').replace(',','.');
          const n = parseFloat(raw);
          dados[key] = isNaN(n) ? 0 : n;
        }
      });
      try {
        await sbStorage.set(REAJUSTE_KEY, JSON.stringify(dados));
        const msg = document.getElementById('reajusteSaveMsg');
        msg.style.display = 'inline';
        setTimeout(() => msg.style.display = 'none', 2500);
      } catch(e) { alert('Erro ao salvar: ' + e.message); }
    }

    // Sincroniza reajuste de dados já extraídos (do PDF ou do Supabase)
    async function reajusteSincronizarDeDados(mesIdx, dados) {
      if (!dados) return;
      const val = dados.reajuste != null ? +dados.reajuste : null;
      if (val == null || val <= 0) return;
      try {
        const raw = await sbStorage.get(REAJUSTE_KEY);
        const rDados = raw ? JSON.parse(raw) : {};
        // Só sobrescreve se não tiver valor manual
        if (!rDados[MESES_KEYS[mesIdx]]) {
          rDados[MESES_KEYS[mesIdx]] = val;
          await sbStorage.set(REAJUSTE_KEY, JSON.stringify(rDados));
          await reajusteCarregar();
          console.log('✅ Reajuste sincronizado:', MESES_KEYS[mesIdx], '=', val);
        }
      } catch(e) { console.warn('Sync reajuste:', e); }
    }

    // Botão "Importar do PDF salvo" — varre todos os meses salvos no Supabase e sincroniza reajuste
    async function reajusteSincronizarDoPdf() {
      const ano = document.getElementById('dirAno')?.value ?? '2026';
      let count = 0;
      const raw = await sbStorage.get(REAJUSTE_KEY);
      const rDados = raw ? JSON.parse(raw) : {};
      for (let m = 0; m <= 11; m++) {
        const dir = await diretoriaLerDados(m, ano);
        if (dir && dir.dados && dir.dados.reajuste != null && dir.dados.reajuste > 0) {
          rDados[MESES_KEYS[m]] = dir.dados.reajuste;
          count++;
        }
      }
      await sbStorage.set(REAJUSTE_KEY, JSON.stringify(rDados));
      await reajusteCarregar();
      const msg = document.getElementById('reajusteSaveMsg');
      msg.textContent = count > 0 ? `✓ ${count} mês(es) importados do PDF!` : '⚠️ Nenhum valor encontrado nos PDFs salvos';
      msg.style.display = 'inline';
      msg.style.color = count > 0 ? '#166534' : '#92400e';
      setTimeout(() => { msg.style.display = 'none'; msg.style.color = '#166534'; }, 3000);
    }

    // Retorna o reajuste de um mês específico (mesIdx 0-11)
    async function getReajusteMes(mesIdx) {
      try {
        const raw = await sbStorage.get(REAJUSTE_KEY);
        if (!raw) return 0;
        const dados = JSON.parse(raw);
        return dados[MESES_KEYS[mesIdx]] || 0;
      } catch(e) { return 0; }
    }

    async function getDiretoriaDados(mes, ano) {
      const mm = String(mes + 1).padStart(2, '0');
      const key = 'diretoria_' + ano + '_' + mm;
      try {
        const raw = await sbStorage.get(key);
        return raw ? JSON.parse(raw) : null;
      } catch(e) { return null; }
    }

    // Soma um campo de receitas para um mês
    // Faturamento BASE = só Link PF + Link PJ (igual à planilha)
    function getFaturamento(mesKey) {
      const nomes = ['Link Pessoa Física', 'Link Pessoa Jurídica'];
      return dadosFinanceiros.receitas
        .filter(r => nomes.includes(r.nome))
        .reduce((s, r) => s + (r[mesKey] || 0), 0);
    }
    // Faturamento TOTAL (todas receitas) — para cards de exibição
    function getFaturamentoTotal(mesKey) {
      return dadosFinanceiros.receitas.reduce((s, r) => s + (r[mesKey] || 0), 0);
    }
    function getJuros(mesKey) {
      const j = dadosFinanceiros.receitas.find(r => r.nome === 'Juros/Multa');
      return j ? (j[mesKey] || 0) : 0;
    }
    function getTarifas(mesKey) {
      const t = dadosFinanceiros.despesas.find(r => r.nome === 'Tarifas bancárias');
      return t ? (t[mesKey] || 0) : 0;
    }
    function getEbitda(mesKey) {
      // Usa o valor direto "EBITDA (Ajustado)" da planilha — não recalcula
      const e = dadosFinanceiros.ebitda_ajustado.find(r => r.nome === 'EBITDA (Ajustado)');
      return e ? (e[mesKey] || 0) : 0;
    }

    // Badge de status
    function badgeStatus(ok, textoOk, textoFail) {
      return ok
        ? `<span style="background:#dcfce7;color:#166534;padding:0.25rem 0.75rem;border-radius:20px;font-size:0.78rem;font-weight:700">✓ ${textoOk}</span>`
        : `<span style="background:#fee2e2;color:#991b1b;padding:0.25rem 0.75rem;border-radius:20px;font-size:0.78rem;font-weight:700">✗ ${textoFail}</span>`;
    }

    // Linha de indicador da matriz
    function indicadorRow(icon, nome, detalhe, status, comissao) {
      const cor = comissao > 0 ? '#059669' : '#94a3b8';
      return `
        <div style="display:grid;grid-template-columns:2fr 3fr auto 1fr;align-items:center;gap:1rem;padding:1rem 1.25rem;background:#f8fafc;border-radius:12px;border-left:4px solid ${comissao>0?'#059669':'#e2e8f0'}">
          <div>
            <div style="font-size:0.75rem;color:#64748b;font-weight:600;margin-bottom:0.2rem">${icon} ${nome}</div>
          </div>
          <div style="font-size:0.82rem;color:#334155;line-height:1.7">${detalhe}</div>
          <div>${status}</div>
          <div style="text-align:right">
            <div style="font-size:0.7rem;color:#94a3b8;margin-bottom:0.1rem">Comissão</div>
            <div style="font-size:1.1rem;font-weight:700;color:${cor}">${comissao > 0 ? formatCurrency(comissao) : '—'}</div>
          </div>
        </div>`;
    }

    // ==================== FECHAR MÊS ====================
    async function fecharMes() {
      const mesIdx = parseInt(document.getElementById('comissaoMesFiltro')?.value ?? 0);
      const ano    = document.getElementById('comissaoAnoFiltro')?.value ?? '2026';
      const mesNome = MESES_NOME[mesIdx];
      const mesKey  = MESES_KEY[mesIdx];

      const conf = confirm(`Fechar ${mesNome}/${ano}?\n\nIsso irá CONGELAR todos os dados e cálculos deste mês.\nMesmo que os parâmetros mudem no futuro, este mês não será afetado.\n\nEsta ação pode ser desfeita clicando em "Reabrir".`);
      if (!conf) return;

      // Coleta snapshot completo dos dados e cálculos atuais
      const params = {};
      ['param_metaJuros','param_txComissaoJuros','param_txRecorrencia','param_limTarifas',
       'param_txEficiencia','param_txEbitdaMensal','param_txBonusTrim',
       'metaEbitda_'+mesKey,'metaTrim_q1','metaTrim_q2','metaTrim_q3','metaTrim_q4'
      ].forEach(id => {
        const el = document.getElementById(id);
        if (el) params[id] = parseFloat(el.value) || 0;
      });

      const fat      = getFaturamento(mesKey);
      const fatTotal = getFaturamentoTotal(mesKey);
      const juros    = getJuros(mesKey);
      const tarifas  = getTarifas(mesKey);
      const ebitda   = getEbitda(mesKey);
      const dirDados = await getDiretoriaDados(mesIdx, ano);
      const reajuste = dirDados?.dados?.reajuste || 0;

      const metaJurosPerc   = params['param_metaJuros'] / 100;
      const txComissaoJuros = params['param_txComissaoJuros'] / 100;
      const txRecorrencia   = params['param_txRecorrencia'] / 100;
      const limTarifas      = params['param_limTarifas'] / 100;
      const txBancaria      = params['param_txEficiencia'] / 100;
      const txEbitdaMensal  = params['param_txEbitdaMensal'] / 100;
      const txBonusTrim     = params['param_txBonusTrim'] / 100;
      const metaEbitdaPerc  = params['metaEbitda_'+mesKey] / 100;

      const jurosPerc    = fat > 0 ? juros / fat : 0;
      const jurosOk      = jurosPerc >= metaJurosPerc;
      const comissaoJuros = jurosOk ? juros * txComissaoJuros : 0;
      const comissaoRec  = reajuste * txRecorrencia;
      const tarifasPerc  = fat > 0 ? tarifas / fat : 0;
      const tarifasOk    = tarifasPerc <= limTarifas;
      const comissaoTar  = tarifasOk ? fat * txBancaria : 0;
      const ebitdaPerc   = fat > 0 ? ebitda / fat : 0;
      const ebitdaOk     = ebitdaPerc >= metaEbitdaPerc;
      const comissaoEbitda = ebitdaOk ? ebitda * txEbitdaMensal : 0;
      const totalMensal  = comissaoJuros + comissaoRec + comissaoTar + comissaoEbitda;

      const snapshot = {
        fechadoEm: new Date().toISOString(),
        mesIdx, ano, mesKey,
        params,
        dados: { fat, fatTotal, juros, tarifas, ebitda, reajuste },
        calculos: {
          jurosPerc, jurosOk, comissaoJuros,
          comissaoRec,
          tarifasPerc, tarifasOk, comissaoTar,
          ebitdaPerc, ebitdaOk, comissaoEbitda,
          totalMensal
        }
      };

      const key = `mes_fechado_${ano}_${String(mesIdx+1).padStart(2,'0')}`;
      await sbStorage.set(key, JSON.stringify(snapshot));

      alert(`✅ ${mesNome}/${ano} fechado com sucesso!\nDados congelados em ${new Date().toLocaleString('pt-BR')}.`);
      renderComissao();
    }

    async function reabrirMes() {
      const mesIdx = parseInt(document.getElementById('comissaoMesFiltro')?.value ?? 0);
      const ano    = document.getElementById('comissaoAnoFiltro')?.value ?? '2026';
      const mesNome = MESES_NOME[mesIdx];
      const conf = confirm(`Reabrir ${mesNome}/${ano}?\nOs cálculos voltarão a usar os parâmetros atuais.`);
      if (!conf) return;
      const key = `mes_fechado_${ano}_${String(mesIdx+1).padStart(2,'0')}`;
      await sbStorage.remove(key);
      renderComissao();
    }

    async function getMesFechado(mesIdx, ano) {
      const key = `mes_fechado_${ano}_${String(mesIdx+1).padStart(2,'0')}`;
      try {
        const raw = await sbStorage.get(key);
        return raw ? JSON.parse(raw) : null;
      } catch(e) { return null; }
    }
    // =====================================================

    // Renderiza a view de comissão a partir de um snapshot congelado
    function renderComissaoComDados(mesIdx, ano, mesKey, mesNome, dados, params, calc, fechadoEm) {
      const { fat, fatTotal, juros, tarifas, ebitda, reajuste } = dados;
      const { jurosPerc, jurosOk, comissaoJuros, comissaoRec,
              tarifasPerc, tarifasOk, comissaoTar,
              ebitdaPerc, ebitdaOk, comissaoEbitda, totalMensal } = calc;

      const txComissaoJuros = params['param_txComissaoJuros'] / 100;
      const txRecorrencia   = params['param_txRecorrencia'] / 100;
      const limTarifas      = params['param_limTarifas'] / 100;
      const txBancaria      = params['param_txEficiencia'] / 100;
      const txEbitdaMensal  = params['param_txEbitdaMensal'] / 100;
      const txBonusTrim     = params['param_txBonusTrim'] / 100;
      const metaJurosPerc   = params['param_metaJuros'] / 100;
      const metaEbitdaPerc  = params['metaEbitda_'+mesKey] / 100 || 0;
      const metaTrimQ1 = params['metaTrim_q1'] || 0;
      const metaTrimQ2 = params['metaTrim_q2'] || 0;
      const metaTrimQ3 = params['metaTrim_q3'] || 0;
      const metaTrimQ4 = params['metaTrim_q4'] || 0;

      const dtFechado = fechadoEm ? new Date(fechadoEm).toLocaleString('pt-BR') : '';
      const isFechado = !!fechadoEm;

      // Atualiza label do mês no título da matriz: cadeado se fechado
      const lbl = document.getElementById('comissaoMesLabel');
      if (lbl) {
        if (isFechado) {
          lbl.innerHTML = `🔒 ${mesNome}/${ano} <span style="font-size:0.7rem;font-weight:500;opacity:0.8">fechado em ${dtFechado}</span>`;
          lbl.style.background = '#fef3c7';
          lbl.style.color = '#92400e';
        } else {
          lbl.textContent = `${mesNome}/${ano}`;
          lbl.style.background = '#dbeafe';
          lbl.style.color = '#1e40af';
        }
      }

      const aviso = document.getElementById('comissaoAvisoDiretoria');
      if (aviso) aviso.style.display = reajuste > 0 ? 'none' : 'block';

      const cards = [
        { icon:'💰', label:'Faturamento Base',   val: fatTotal,  cor:'#2563eb', sub:'Total Receitas (Fluxo de Caixa)' },
        { icon:'📋', label:'Juros/Multa',         val: juros,     cor:'#10b981', sub:'Receita de juros' },
        { icon:'🏦', label:'Tarifas Bancárias',   val: tarifas,   cor:'#f59e0b', sub:'Despesa bancária' },
        { icon:'🔵', label:'Reajuste Contratual', val: reajuste,  cor:'#8b5cf6', sub:'Fonte: PDF Diretoria' },
        { icon:'📊', label:'EBITDA (Ajustado)',   val: ebitda,    cor:'#059669', sub:'EBITDA c/ ajustes' },
      ];
      const cardsEl = document.getElementById('comissaoCardsResumo');
      if (cardsEl) cardsEl.innerHTML = cards.map(c => `
        <div style="background:white;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,0.08);padding:1.25rem;border-top:4px solid ${c.cor}">
          <div style="font-size:0.78rem;color:#64748b;font-weight:500;margin-bottom:0.75rem">${c.icon} ${c.label}</div>
          <div style="font-size:1.4rem;font-weight:800;color:${c.val<0?'#b91c1c':c.cor}">${c.val!==0?formatCurrency(c.val):'<span style="color:#cbd5e1;font-size:1rem">Sem dados</span>'}</div>
          <div style="font-size:0.72rem;color:#94a3b8;margin-top:0.35rem">${c.sub} · ${mesNome}/${ano}</div>
        </div>`).join('');

      const pct = v => {
        const n = v * 100;
        if (n === 0) return '0%';
        if (Math.abs(n) < 0.01) return n.toFixed(4) + '%';
        if (Math.abs(n) < 0.1)  return n.toFixed(3) + '%';
        if (Math.abs(n) < 1)    return n.toFixed(3) + '%';
        return n.toFixed(2) + '%';
      };
      const tip = (txt) => `<span style="display:inline-flex;align-items:center;justify-content:center;width:15px;height:15px;background:#e2e8f0;border-radius:50%;font-size:0.65rem;color:#475569;cursor:help;margin-left:4px;vertical-align:middle;font-style:normal" title="${txt}">?</span>`;

      const matrizEl = document.getElementById('comissaoMatriz');
      if (matrizEl) matrizEl.innerHTML =
        indicadorRow('📋','Juros / Comissão',
          `Juros: <b>${formatCurrency(juros)}</b> | Juros/Fat: <b>${pct(jurosPerc)}</b>${tip('Juros ÷ Faturamento Base')} | Meta mín.: <b>${pct(metaJurosPerc)}</b> | Taxa: <b>${pct(txComissaoJuros)}</b>`,
          badgeStatus(jurosOk,'Meta atingida','Abaixo da meta'), comissaoJuros)
        + indicadorRow('🔵','Reajuste Contratual',
          `Reajuste: <b>${reajuste ? formatCurrency(reajuste) : 'Sem dados PDF'}</b> | Taxa Recorrência: <b>${pct(txRecorrencia)}</b>`,
          reajuste > 0 ? badgeStatus(true,'PDF carregado','') : `<span style="background:#fef3c7;color:#92400e;padding:0.25rem 0.75rem;border-radius:20px;font-size:0.78rem;font-weight:700">⚠️ PDF não carregado</span>`,
          comissaoRec)
        + indicadorRow('🏦','Eficiência Bancária (Tarifas)',
          `Tarifas: <b>${formatCurrency(tarifas)}</b> | Tarifas/Fat: <b>${pct(tarifasPerc)}</b> | Limite máx.: <b>${pct(limTarifas)}</b> | Taxa: <b>${pct(txBancaria)}</b>`,
          badgeStatus(tarifasOk,'Eficiente','Acima do limite'), comissaoTar)
        + indicadorRow('📊','EBITDA Mensal',
          `EBITDA: <b>${formatCurrency(ebitda)}</b> | EBITDA%: <b>${pct(ebitdaPerc)}</b> | Meta: <b>${pct(metaEbitdaPerc)}</b> | Taxa: <b>${pct(txEbitdaMensal)}</b>`,
          badgeStatus(ebitdaOk,'Meta atingida','Abaixo da meta'), comissaoEbitda)
        + `<div style="display:grid;grid-template-columns:1fr auto auto;align-items:center;gap:1rem;padding:1rem 1.25rem;background:linear-gradient(135deg,#1e3a8a,#2563eb);border-radius:12px;color:white;margin-top:0.5rem">
            <div style="font-weight:700;font-size:1rem">💼 Total Mensal — ${mesNome}/${ano}</div>
            <div style="font-size:1.4rem;font-weight:800">${formatCurrency(totalMensal)}</div>
            ${isFechado
              ? `<button onclick="reabrirMes()" title="Reabrir mês para edição" style="padding:0.45rem 1rem;background:rgba(255,255,255,0.15);border:2px solid rgba(255,255,255,0.5);color:white;border-radius:8px;cursor:pointer;font-weight:700;font-size:0.82rem;white-space:nowrap">🔓 Reabrir</button>`
              : `<button onclick="fecharMes()" title="Congelar dados deste mês" style="padding:0.45rem 1rem;background:#dc2626;border:none;color:white;border-radius:8px;cursor:pointer;font-weight:700;font-size:0.82rem;white-space:nowrap">🔒 Fechar Mês</button>`
            }
          </div>`;

      const trim = [
        { nome:'Q1 (Jan-Mar)', meses:['jan','fev','mar'], meta: metaTrimQ1 },
        { nome:'Q2 (Abr-Jun)', meses:['abr','mai','jun'], meta: metaTrimQ2 },
        { nome:'Q3 (Jul-Set)', meses:['jul','ago','set'], meta: metaTrimQ3 },
        { nome:'Q4 (Out-Dez)', meses:['out','nov','dez'], meta: metaTrimQ4 },
      ];
      const bonusEl = document.getElementById('comissaoBonusTrim');
      if (bonusEl) {
        bonusEl.innerHTML = trim.map((q, qi) => {
          const ebitdaAcum = q.meses.reduce((s, m) => s + getEbitda(m), 0);
          const trimOk     = q.meta > 0 && ebitdaAcum >= q.meta;
          const bonus      = trimOk ? ebitdaAcum * txBonusTrim : 0;
          const progresso  = q.meta > 0 ? Math.min(100, (ebitdaAcum / q.meta) * 100) : 0;
          const corProg    = trimOk ? '#059669' : progresso > 60 ? '#f59e0b' : '#e2e8f0';
          const temDados   = ebitdaAcum > 0;
          return `<div style="border:1px solid #e2e8f0;border-radius:14px;padding:1.25rem;${trimOk?'border-color:#86efac;background:#f0fdf4;':''}">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
              <div style="font-weight:700;color:#1e293b;font-size:0.9rem">${q.nome}</div>
              ${trimOk ? '<span style="background:#dcfce7;color:#166534;padding:0.2rem 0.6rem;border-radius:20px;font-size:0.75rem;font-weight:700">✓ Atingido</span>'
                        : q.meta===0 ? '<span style="background:#f1f5f9;color:#94a3b8;padding:0.2rem 0.6rem;border-radius:20px;font-size:0.75rem">Sem meta</span>'
                        : '<span style="background:#fef3c7;color:#92400e;padding:0.2rem 0.6rem;border-radius:20px;font-size:0.75rem;font-weight:700">Em andamento</span>'}
            </div>
            <div style="margin-bottom:0.6rem">
              <div style="display:flex;justify-content:space-between;font-size:0.78rem;color:#64748b;margin-bottom:0.3rem"><span>EBITDA Acumulado</span><span style="font-weight:700;color:#1e293b">${temDados ? formatCurrency(ebitdaAcum) : '—'}</span></div>
              <div style="display:flex;justify-content:space-between;font-size:0.78rem;color:#64748b;margin-bottom:0.6rem"><span>Meta</span><span style="font-weight:700;color:#1e293b">${q.meta>0 ? formatCurrency(q.meta) : 'Não definida'}</span></div>
              ${q.meta>0 ? `<div style="background:#e2e8f0;border-radius:99px;height:8px;overflow:hidden"><div style="background:${corProg};height:100%;width:${progresso.toFixed(1)}%;transition:width 0.5s;border-radius:99px"></div></div><div style="font-size:0.72rem;color:#94a3b8;margin-top:0.25rem;text-align:right">${progresso.toFixed(1)}% da meta</div>` : ''}
            </div>
            <div style="border-top:1px solid #e2e8f0;padding-top:0.75rem;display:flex;justify-content:space-between;align-items:center">
              <span style="font-size:0.78rem;color:#64748b">Bônus (${(txBonusTrim*100).toFixed(2)}%)</span>
              <span style="font-size:1.1rem;font-weight:800;color:${bonus>0?'#059669':'#94a3b8'}">${bonus>0?formatCurrency(bonus):'—'}</span>
            </div>
          </div>`;
        }).join('');
      }

      const trimAtual = Math.floor(mesIdx / 3);
      const metasTrim = [metaTrimQ1, metaTrimQ2, metaTrimQ3, metaTrimQ4];
      const ebitdaAcumTrimAtual = trim[trimAtual].meses.reduce((s,m)=>s+getEbitda(m),0);
      const bonusTrimAtual = metasTrim[trimAtual]>0 && ebitdaAcumTrimAtual>=metasTrim[trimAtual] ? ebitdaAcumTrimAtual * txBonusTrim : 0;
      const totalGeral = totalMensal + bonusTrimAtual;
      const totalEl = document.getElementById('comissaoTotalGeral');
      if (totalEl) totalEl.innerHTML = `
        <div style="background:linear-gradient(135deg,#059669,#047857);border-radius:16px;padding:2rem;color:white">
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;align-items:center">
            <div><div style="font-size:0.85rem;opacity:0.85;margin-bottom:0.25rem">💼 Total Mensal</div><div style="font-size:1.6rem;font-weight:800">${formatCurrency(totalMensal)}</div><div style="font-size:0.75rem;opacity:0.75;margin-top:0.25rem">${mesNome}/${ano}</div></div>
            <div><div style="font-size:0.85rem;opacity:0.85;margin-bottom:0.25rem">🏆 Bônus Trimestral Q${trimAtual+1}</div><div style="font-size:1.6rem;font-weight:800">${bonusTrimAtual>0?formatCurrency(bonusTrimAtual):'—'}</div><div style="font-size:0.75rem;opacity:0.75;margin-top:0.25rem">${bonusTrimAtual>0?'Meta atingida':'Em andamento'}</div></div>
            <div style="background:rgba(255,255,255,0.15);border-radius:12px;padding:1.25rem;text-align:center"><div style="font-size:0.85rem;opacity:0.85;margin-bottom:0.5rem">🎯 TOTAL GERAL</div><div style="font-size:2rem;font-weight:900">${formatCurrency(totalGeral)}</div><div style="font-size:0.75rem;opacity:0.75;margin-top:0.25rem">Mensal + Bônus Q${trimAtual+1}</div></div>
          </div>
        </div>`;
    }

    async function renderComissao() {
      const mesIdx  = parseInt(document.getElementById('comissaoMesFiltro')?.value ?? 0);
      const ano     = document.getElementById('comissaoAnoFiltro')?.value ?? '2026';
      const mesKey  = MESES_KEY[mesIdx];
      const mesNome = MESES_NOME[mesIdx];

      // Atualiza label
      const lbl = document.getElementById('comissaoMesLabel');
      if (lbl) lbl.textContent = `${mesNome}/${ano}`;

      // Verifica se mês está fechado
      const frozen = await getMesFechado(mesIdx, ano);

      if (frozen) {
        // Usa dados congelados do Supabase
        renderComissaoComDados(mesIdx, ano, mesKey, mesNome, frozen.dados, frozen.params, frozen.calculos, frozen.fechadoEm);
        return;
      }

      // === PARÂMETROS AO VIVO ===
      const metaJurosPerc    = getParam('param_metaJuros', 1.90) / 100;       // 1.9%
      const txComissaoJuros  = getParam('param_txComissaoJuros', 1.10) / 100; // 1.1%
      const txRecorrencia    = getParam('param_txRecorrencia', 14) / 100;      // 14%
      const limTarifas       = getParam('param_limTarifas', 0.38) / 100;      // 0.38%
      const txBancaria       = getParam('param_txEficiencia', 0.015) / 100;   // 0.015%
      const txEbitdaMensal   = getParam('param_txEbitdaMensal', 0.10) / 100;  // 0.1%
      const txBonusTrim      = getParam('param_txBonusTrim', 0.20) / 100;     // 0.2%
      const metaEbitdaPerc   = getParam('metaEbitda_'+mesKey, 0) / 100;
      const metaTrimQ1       = getParam('metaTrim_q1', 0);
      const metaTrimQ2       = getParam('metaTrim_q2', 0);
      const metaTrimQ3       = getParam('metaTrim_q3', 0);
      const metaTrimQ4       = getParam('metaTrim_q4', 0);

      // === DADOS DO MÊS ===
      const fat      = getFaturamento(mesKey);       // PF+PJ apenas (para cálculos de comissão)
      const fatTotal = getFaturamentoTotal(mesKey);   // todas receitas (para exibição nos cards)
      const juros    = getJuros(mesKey);
      const tarifas  = getTarifas(mesKey);
      const ebitda   = getEbitda(mesKey);

      // Diretoria (PDF Supabase)
      const dirDados = await getDiretoriaDados(mesIdx, ano);
      const hasDiretoria = !!(dirDados && dirDados.dados);
      const resultadoLiq = hasDiretoria ? (dirDados.dados.resultado || 0) : 0;
      const reajuste     = hasDiretoria ? (dirDados.dados.reajuste || 0)  : 0;

      // Aviso diretoria
      const aviso = document.getElementById('comissaoAvisoDiretoria');
      if (aviso) aviso.style.display = hasDiretoria ? 'none' : 'block';

      // Monta params e calculos no mesmo formato do snapshot para reusar renderComissaoComDados
      const params = {
        'param_metaJuros': metaJurosPerc * 100, 'param_txComissaoJuros': txComissaoJuros * 100,
        'param_txRecorrencia': txRecorrencia * 100, 'param_limTarifas': limTarifas * 100,
        'param_txEficiencia': txBancaria * 100, 'param_txEbitdaMensal': txEbitdaMensal * 100,
        'param_txBonusTrim': txBonusTrim * 100, ['metaEbitda_'+mesKey]: metaEbitdaPerc * 100,
        'metaTrim_q1': metaTrimQ1, 'metaTrim_q2': metaTrimQ2,
        'metaTrim_q3': metaTrimQ3, 'metaTrim_q4': metaTrimQ4,
      };

      const jurosPerc    = fat > 0 ? juros / fat : 0;
      const jurosOk      = jurosPerc >= metaJurosPerc;
      const comissaoJuros = jurosOk ? juros * txComissaoJuros : 0;
      const comissaoRec  = reajuste * txRecorrencia;
      const tarifasPerc  = fat > 0 ? tarifas / fat : 0;
      const tarifasOk    = tarifasPerc <= limTarifas;
      const comissaoTar  = tarifasOk ? fat * txBancaria : 0;
      const ebitdaPerc   = fat > 0 ? ebitda / fat : 0;
      const ebitdaOk     = ebitdaPerc >= metaEbitdaPerc;
      const comissaoEbitda = ebitdaOk ? ebitda * txEbitdaMensal : 0;
      const totalMensal  = comissaoJuros + comissaoRec + comissaoTar + comissaoEbitda;

      const calculos = { jurosPerc, jurosOk, comissaoJuros, comissaoRec,
                         tarifasPerc, tarifasOk, comissaoTar,
                         ebitdaPerc, ebitdaOk, comissaoEbitda, totalMensal };

      renderComissaoComDados(mesIdx, ano, mesKey, mesNome,
        { fat, fatTotal, juros, tarifas, ebitda, reajuste },
        params, calculos, null);
    }


    async function salvarParams() {
      const ids = [
        'param_metaJuros','param_txComissaoJuros','param_txRecorrencia',
        'param_limTarifas','param_txEficiencia','param_txEbitdaMensal','param_txBonusTrim',
        'metaEbitda_jan','metaEbitda_fev','metaEbitda_mar','metaEbitda_abr',
        'metaEbitda_mai','metaEbitda_jun','metaEbitda_jul','metaEbitda_ago',
        'metaEbitda_set','metaEbitda_out','metaEbitda_nov','metaEbitda_dez',
        'metaTrim_q1','metaTrim_q2','metaTrim_q3','metaTrim_q4',
        'op_metaOsPf','op_metaOsPj','op_metaChurnPf','op_metaChurnPj','op_metaRetiradas',
        'op_ticketPf','op_ticketPj',
        'op_premioOsPf','op_premioOsPj','op_premioChurnPf','op_premioChurnPj',
        'op_premioRetiradas','op_premioResPos','op_premioResNeg','op_premioEbitdaMov',
        'op_metaResultTrim','op_metaChurnFinTrim',
        'op_metaMatEquip_q1','op_metaMatEquip_q2','op_metaMatEquip_q3','op_metaMatEquip_q4',
        'op_metaFolha_q1','op_metaFolha_q2','op_metaFolha_q3','op_metaFolha_q4',
        'op_premioResultTrim','op_premioChurnFinTrim','op_premioMatEquipTrim',
        'op_premioFolhaTrim','op_premioEbitdaTrim','op_equipamento'
      ];
      const params = {};
      ids.forEach(id => {
        const el = document.getElementById(id);
        if (el) params[id] = parseParamValue(el);
      });
      await sbStorage.set('app_params_v2', JSON.stringify(params));
      const msg = document.getElementById('paramSalvoMsg');
      if (msg) { msg.style.display='block'; setTimeout(()=>msg.style.display='none', 3000); }
    }

    async function carregarParams() {
      try {
        const raw = await sbStorage.get('app_params_v2');
        if (!raw) return;
        const params = JSON.parse(raw);
        Object.entries(params).forEach(([id, val]) => {
          const el = document.getElementById(id);
          if (el) {
            // val pode ser string formatada (legado) ou número
            const num = typeof val === 'string' ? parseFloat(val.replace(/\./g,'').replace(',','.')) : parseFloat(val);
            if (!isNaN(num)) {
              el.value = num;  // temporário — formatParamInput vai formatar logo abaixo
              formatParamInput(el);
            }
          }
        });
        console.log('✅ Parâmetros carregados do Supabase');
        initParamFormatting();
      } catch(e) { console.warn('carregarParams falhou:', e); }
      await reajusteCarregar();
    }


    // ==================== CONSOLIDADO CSV SYNC ====================
    const ONEDRIVE_CSV_URL = 'https://excel.officeapps.live.com/x/_layouts/XlFileHandler.aspx?sheetName=JAN%202026&downloadAsCsvEnabled=1&WacUserType=WOPI&usid=81107527-d1ec-8889-b800-a4c8b76fe6e5&NoAuth=1&waccluster=PBR1';

    // Mapeamento: nome no CSV → chave em dadosFinanceiros + categoria
    const CSV_MAP = {
      // RECEITAS
      'link pessoa física':        { cat:'receitas', nome:'Link Pessoa Física' },
      'link pf':                   { cat:'receitas', nome:'Link Pessoa Física' },
      'link pessoa jurídica':      { cat:'receitas', nome:'Link Pessoa Jurídica' },
      'link pj':                   { cat:'receitas', nome:'Link Pessoa Jurídica' },
      'juros/multa':               { cat:'receitas', nome:'Juros/Multa' },
      'juros':                     { cat:'receitas', nome:'Juros/Multa' },
      'taxa de instalação':        { cat:'receitas', nome:'Taxa de instalação' },
      'eventos':                   { cat:'receitas', nome:'Eventos' },
      'multa fidelidade':          { cat:'receitas', nome:'Multa fidelidade e equipamento' },
      'multa fidelidade e equipamento': { cat:'receitas', nome:'Multa fidelidade e equipamento' },
      'rendimentos financeiros':   { cat:'receitas', nome:'Rendimentos financeiros' },
      'vendas canceladas':         { cat:'receitas', nome:'Vendas canceladas e estornos' },
      'vendas canceladas e estornos': { cat:'receitas', nome:'Vendas canceladas e estornos' },
      // IMPOSTOS
      'icms':                      { cat:'impostos', nome:'ICMS' },
      'cofins':                    { cat:'impostos', nome:'COFINS' },
      'pis':                       { cat:'impostos', nome:'PIS' },
      'irpj':                      { cat:'impostos', nome:'IRPJ' },
      'csll':                      { cat:'impostos', nome:'CSLL' },
      'iss':                       { cat:'impostos', nome:'ISS' },
      'fust/funttel':              { cat:'impostos', nome:'FUST/FUNTTEL' },
      'fust':                      { cat:'impostos', nome:'FUST/FUNTTEL' },
      // CUSTOS
      'kit instalação':            { cat:'custos', nome:'Kit Instalação' },
      'materiais de rede':         { cat:'custos', nome:'Materiais de Rede' },
      'links de dados':            { cat:'custos', nome:'Links de Dados / Voip' },
      'links de dados / voip':     { cat:'custos', nome:'Links de Dados / Voip' },
      'vtal':                      { cat:'custos', nome:'Vtal' },
      'alugueis de postes':        { cat:'custos', nome:'Alugueis de Postes' },
      'alugueis de torre':         { cat:'custos', nome:'Alugueis de Torre e POP' },
      'alugueis de torre e pop':   { cat:'custos', nome:'Alugueis de Torre e POP' },
      'custo com sva':             { cat:'custos', nome:'Custo com SVA' },
      'energia / pop':             { cat:'custos', nome:'Energia / POP' },
      'comissões de vendas':       { cat:'custos', nome:'Comissões de vendas' },
      'combustível técnico':       { cat:'custos', nome:'Combustível técnico' },
      'manut. veículo':            { cat:'custos', nome:'Manut. Veículo' },
      'manutenção veículo':        { cat:'custos', nome:'Manut. Veículo' },
      'folha - direta':            { cat:'custos', nome:'Folha - Direta' },
      'folha direta':              { cat:'custos', nome:'Folha - Direta' },
      'telefonia':                 { cat:'custos', nome:'Telefonia' },
      'ferramentas':               { cat:'custos', nome:'Ferramentas' },
      'custos lastmile':           { cat:'custos', nome:'Custos Lastmile' },
      // DESPESAS
      'marketing':                 { cat:'despesas', nome:'Marketing' },
      'serv. terceiros':           { cat:'despesas', nome:'Serv. Terceiros, jurídicos e consultorias' },
      'serviços terceiros':        { cat:'despesas', nome:'Serv. Terceiros, jurídicos e consultorias' },
      'aluguel de escritório':     { cat:'despesas', nome:'Desp. Aluguel de escritório' },
      'desp. aluguel':             { cat:'despesas', nome:'Desp. Aluguel de escritório' },
      'pró-labore':                { cat:'despesas', nome:'Pró-Labore' },
      'pro-labore':                { cat:'despesas', nome:'Pró-Labore' },
      'sistema':                   { cat:'despesas', nome:'Sistema' },
      'taxas boleto':              { cat:'despesas', nome:'Taxas Boleto' },
      'tarifas bancárias':         { cat:'despesas', nome:'Tarifas bancárias' },
      'tarifas bancarias':         { cat:'despesas', nome:'Tarifas bancárias' },
      // EBITDA
      'ebitda':                    { cat:'ebitda', nome:'EBITDA' },
      // EBITDA AJUSTADO
      'irpj (previsão)':           { cat:'ebitda_ajustado', nome:'IRPJ (Previsão)' },
      'cssl (previsão)':           { cat:'ebitda_ajustado', nome:'CSSL (Previsão)' },
      'trimestral':                { cat:'ebitda_ajustado', nome:'Trimestral' },
      'compra de provedor':        { cat:'ebitda_ajustado', nome:'Compra de Provedor' },
      'ajuste (postes)':           { cat:'ebitda_ajustado', nome:'Ajuste (Postes)' },
      'ajuste vtal':               { cat:'ebitda_ajustado', nome:'Ajuste Vtal Fora' },
      'ebitda (ajustado)':         { cat:'ebitda_ajustado', nome:'EBITDA (Ajustado)' },
      // AJUSTES DE CAIXA
      'investimento':              { cat:'ajustes', nome:'Investimento' },
      'empr/finac/parcel':         { cat:'ajustes', nome:'Empr/Finac/Parcel' },
      'impostos':                  { cat:'ajustes', nome:'Impostos' },
      'sócios ou retiradas':       { cat:'ajustes', nome:'Sócios ou Retiradas' },
      'retiradas':                 { cat:'ajustes', nome:'Sócios ou Retiradas' },
      // BANCOS
      'mg - itaú':                 { cat:'bancos', nome:'MG - Itaú' },
      'speed - itaú':              { cat:'bancos', nome:'Speed - Itaú + Vinc.' },
      'caixa tesouraria':          { cat:'bancos', nome:'Caixa Tesouraria' },
    };

    const MESES_CSV_KEY = { 'jan':0,'fev':1,'mar':2,'abr':3,'mai':4,'jun':5,'jul':6,'ago':7,'set':8,'out':9,'nov':10,'dez':11,
      'janeiro':0,'fevereiro':1,'março':2,'abril':3,'maio':4,'junho':5,'julho':6,'agosto':7,'setembro':8,'outubro':9,'novembro':10,'dezembro':11 };

    function syncSetStatus(msg, tipo) {
      const el = document.getElementById('syncStatusMsg');
      if (!el) return;
      const cor = tipo==='ok' ? '#059669' : tipo==='erro' ? '#b91c1c' : tipo==='warn' ? '#b45309' : '#64748b';
      el.innerHTML = `<span style="color:${cor}">${msg}</span>`;
    }
    function syncSetProgress(pct, msg) {
      const bar  = document.getElementById('syncProgressBar');
      const fill = document.getElementById('syncProgressFill');
      const txt  = document.getElementById('syncProgressMsg');
      if (!bar) return;
      if (pct === null) { bar.style.display='none'; return; }
      bar.style.display = 'block';
      fill.style.width  = pct + '%';
      txt.textContent   = msg || '';
    }

    // Sync date — mantido em localStorage por performance (não precisa persistir entre dispositivos)
    function syncJaFezHoje() {
      const ultima = localStorage.getItem('consolidado_sync_data');
      return ultima === new Date().toISOString().slice(0,10);
    }
    function syncMarcarFeito() {
      localStorage.setItem('consolidado_sync_data', new Date().toISOString().slice(0,10));
    }

    async function syncAtualizarStatusUI() {
      const raw = await sbStorage.get('consolidado_dados');
      const ultima = localStorage.getItem('consolidado_sync_data');
      if (raw) {
        const hoje = new Date().toISOString().slice(0,10);
        if (ultima === hoje) {
          syncSetStatus(`✅ Dados sincronizados hoje (${new Date().toLocaleDateString('pt-BR')})`, 'ok');
        } else {
          syncSetStatus(`⚠️ Última atualização: ${ultima ? new Date(ultima+'T12:00:00').toLocaleDateString('pt-BR') : 'desconhecida'} — faça upload para atualizar`, 'warn');
        }
      } else {
        syncSetStatus('⚡ Nenhum dado importado ainda. Faça upload do XLSX.', 'info');
      }
    }

    // Tenta buscar CSV do OneDrive automaticamente
    async function consolidadoAutoFetch() {
      const btn = document.getElementById('btnAutoFetch');
      if (btn) { btn.disabled=true; btn.textContent='⏳ Buscando...'; }
      syncSetProgress(10, 'Conectando ao OneDrive...');
      syncSetStatus('Buscando dados do OneDrive...', 'info');
      try {
        const resp = await fetch(ONEDRIVE_CSV_URL, { mode:'cors' });
        if (!resp.ok) throw new Error('HTTP ' + resp.status);
        const text = await resp.text();
        if (!text || text.trim().length < 10) throw new Error('Resposta vazia');
        syncSetProgress(50, 'Dados recebidos, processando CSV...');
        await consolidadoProcessarCsv(text, 'OneDrive');
      } catch(e) {
        syncSetProgress(null);
        syncSetStatus(`❌ Não foi possível buscar automaticamente (${e.message}). Use o upload manual.`, 'erro');
        // Destaca o botão de upload
        const label = document.querySelector('label[for="consolidadoCsvInput"], label:has(#consolidadoCsvInput)');
        if (label) label.style.background = '#fef3c7';
      }
      if (btn) { btn.disabled=false; btn.textContent='☁️ Buscar do OneDrive'; }
    }

    async function consolidadoParseXlsx(input) {
      const file = input.files[0];
      if (!file) return;
      syncSetProgress(10, 'Lendo arquivo XLSX...');
      syncSetStatus('Lendo arquivo...', 'info');
      const reader = new FileReader();
      reader.onload = async e => {
        try {
          const data = new Uint8Array(e.target.result);
          const wb = XLSX.read(data, { type: 'array' });

          // Usa aba "Anual Real - XXXX"
          const sheetName = wb.SheetNames.find(s => s.toLowerCase().includes('anual real')) || wb.SheetNames[0];
          syncSetProgress(30, `Lendo aba: ${sheetName}`);
          const ws = wb.Sheets[sheetName];
          const rows = XLSX.utils.sheet_to_json(ws, { header: 1, defval: 0 });

          const MESES = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
          const norm = s => String(s).toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/\s+/g,' ').trim();

          // Detecta header com meses
          let headerIdx = -1;
          const colMeses = {};
          for (let i = 0; i < Math.min(10, rows.length); i++) {
            rows[i].forEach((cel, ci) => {
              if (typeof cel === 'string') {
                const c = norm(cel).slice(0,3);
                if (MESES.includes(c)) { colMeses[c] = ci; headerIdx = i; }
              }
            });
            if (Object.keys(colMeses).length >= 6) break;
          }
          if (headerIdx < 0) {
            syncSetStatus('❌ Colunas de meses não encontradas. Use a aba "Anual Real".', 'erro');
            syncSetProgress(null); return;
          }

          syncSetProgress(50, `Meses: ${Object.keys(colMeses).join(', ')}`);

          // Seções do fluxo de caixa
          const SECTIONS = { 'receitas':'receitas', 'impostos':'impostos', 'custos':'custos',
            'despesas operac.':'despesas', 'despesas financ.':'despesas', 'ebitda':'ebitda_section' };
          const STOP_SECTIONS = new Set(['ajustes de caixa','saidas','entradas']);
          const SKIP_ROWS = new Set(['desembolsos','receitas','custos','impostos','despesas operac.','despesas financ.']);
          const EBITDA_AJ_STARTS = ['inclusao','irpj (previsao)','cssl (previsao)','trimestral',
            'compra de provedor','ajuste (postes)','ajuste vtal fora','credito icms',
            'ajuste (mark/equip)','datora','ebitda (ajustado)'];
          const AJUSTES_NAMES = new Set(['investimento','compra de veiculos',
            'invest. tecnico e administrativo','aq. de provedor','empr/finac/parcel',
            'investimentos pop','emprestimos para giro','reneg. debitos','socios ou retiradas']);

          // Índice dos itens existentes no dadosFinanceiros
          const itemIdx = {};
          ['receitas','impostos','custos','despesas','ebitda','ebitda_ajustado','ajustes'].forEach(cat => {
            (dadosFinanceiros[cat]||[]).forEach(item => { itemIdx[item.nome] = item; });
          });

          let cur = null, stopped = false, atualizados = 0;
          const ebitdaValuesRow = {}; // store EBITDA real row

          // First pass: main sections (receitas→ebitda_ajustado)
          for (let i = headerIdx + 1; i < rows.length; i++) {
            const row = rows[i];
            const nomeRaw = typeof row[0] === 'string' ? row[0].trim() : '';
            if (!nomeRaw) continue;
            const n = norm(nomeRaw);

            // Skip % rows
            const v0 = row[Object.values(colMeses)[0]];
            if (typeof v0 === 'number' && v0 !== 0 && Math.abs(v0) < 2) continue;

            if (STOP_SECTIONS.has(n)) { stopped = true; continue; }
            if (stopped) continue;

            if (n in SECTIONS) { cur = SECTIONS[n]; continue; }
            if (!cur || SKIP_ROWS.has(n)) continue;

            // Special: capture EBITDA real row
            if (n === 'ebitda' && cur === 'ebitda_section') {
              const v = row[colMeses['jan']];
              if (typeof v === 'number' && v > 100000) {
                MESES.forEach(m => { ebitdaValuesRow[m] = typeof row[colMeses[m]] === 'number' ? Math.round(row[colMeses[m]]*100)/100 : 0; });
                continue;
              }
            }

            const isEbitdaAj = EBITDA_AJ_STARTS.some(s => n.startsWith(s));
            const cat = isEbitdaAj ? 'ebitda_ajustado' : (cur === 'ebitda_section' ? 'ebitda_ajustado' : cur);

            const item = itemIdx[nomeRaw];
            if (!item) continue;

            MESES.forEach(m => {
              const v = row[colMeses[m]];
              item[m] = typeof v === 'number' ? Math.round(v*100)/100 : 0;
            });
            item.total = Math.round(MESES.reduce((s,m) => s+(item[m]||0), 0)*100)/100;
            atualizados++;
          }

          // Update EBITDA row
          const ebitdaItem = itemIdx['EBITDA'];
          if (ebitdaItem && Object.keys(ebitdaValuesRow).length > 0) {
            MESES.forEach(m => { ebitdaItem[m] = ebitdaValuesRow[m] || 0; });
            ebitdaItem.total = Math.round(MESES.reduce((s,m)=>s+(ebitdaItem[m]||0),0)*100)/100;
            atualizados++;
          }

          // Second pass: ajustes from SAÍDAS section
          let inSaidas = false;
          for (let i = headerIdx + 1; i < rows.length; i++) {
            const row = rows[i];
            if (!row[0]) continue;
            const n = norm(String(row[0]).trim());
            if (n === 'ajustes de caixa' || n === 'saidas') { inSaidas = true; continue; }
            if (n === 'entradas' || n === 'geracao de caixa') { inSaidas = false; continue; }
            if (!inSaidas || !AJUSTES_NAMES.has(n)) continue;
            const nomeRaw = String(row[0]).trim();
            const item = itemIdx[nomeRaw];
            if (!item) continue;
            MESES.forEach(m => {
              const v = row[colMeses[m]];
              item[m] = typeof v === 'number' ? Math.round(v*100)/100 : 0;
            });
            item.total = Math.round(MESES.reduce((s,m)=>s+(item[m]||0),0)*100)/100;
            atualizados++;
          }

          syncSetProgress(90, 'Salvando no Supabase...');
          await sbStorage.set('consolidado_dados', JSON.stringify(dadosFinanceiros));
          await sbStorage.set('consolidado_versao', DADOS_VERSION);
          syncMarcarFeito();
          showTab(document.querySelector('.tab-btn.active')?.textContent?.toLowerCase().trim() || 'receitas');
          renderComissao();
          syncSetProgress(null);
          input.value = '';
          syncSetStatus(
            atualizados > 0
              ? `✅ ${atualizados} itens importados da aba "${sheetName}"`
              : `⚠️ Nenhum item reconhecido. Verifique o arquivo.`,
            atualizados > 0 ? 'ok' : 'warn'
          );
        } catch(err) {
          syncSetProgress(null);
          syncSetStatus(`❌ Erro ao ler XLSX: ${err.message}`, 'erro');
          console.error(err);
        }
      };
      reader.readAsArrayBuffer(file);
      input.value = '';
    }

    // Parser principal do CSV — versão simples e robusta
    async function consolidadoProcessarCsv(csvText, fonte) {
      try {
        syncSetProgress(40, 'Detectando estrutura...');

        // Normaliza separador (vírgula ou ponto-e-vírgula)
        const linhas = csvText.split(/\r?\n/);
        const sep = linhas[0].includes(';') ? ';' : ',';
        const rows = linhas.map(l => l.split(sep).map(c => c.trim().replace(/^["']|["']$/g, '').trim()));

        // Detecta linha do header buscando meses
        const MESES_PT = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez',
                          'janeiro','fevereiro','março','marco','abril','maio','junho','julho',
                          'agosto','setembro','outubro','novembro','dezembro'];
        let headerIdx = -1;
        let colMeses = {}; // mesKey → colIndex

        for (let i = 0; i < Math.min(15, rows.length); i++) {
          let achou = 0;
          rows[i].forEach((cel, ci) => {
            const c = cel.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').trim();
            const idx = MESES_PT.indexOf(c);
            if (idx >= 0) {
              const mesKey = MESES_KEY[idx % 12];
              colMeses[mesKey] = ci;
              achou++;
            }
          });
          if (achou >= 2) { headerIdx = i; break; }
        }

        if (headerIdx < 0 || Object.keys(colMeses).length === 0) {
          // Tenta formato alternativo: apenas 2 colunas (nome, valor)
          syncSetStatus('⚠️ Não encontrei colunas de meses no CSV. Formato esperado: linhas com nome + colunas Jan, Fev, etc.', 'warn');
          syncSetProgress(null);
          return;
        }

        syncSetProgress(60, `Header na linha ${headerIdx+1}, meses: ${Object.keys(colMeses).join(', ')}`);

        // Mapeia nome normalizado → item de dadosFinanceiros
        const itemMap = {};
        ['receitas','impostos','custos','despesas','ebitda','ebitda_ajustado','ajustes','bancos'].forEach(cat => {
          (dadosFinanceiros[cat] || []).forEach(item => {
            const chave = item.nome.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/\s+/g,' ').trim();
            itemMap[chave] = item;
          });
        });

        let atualizados = 0;
        const log = [];

        for (let i = headerIdx + 1; i < rows.length; i++) {
          const row = rows[i];
          if (!row[0] || row[0].trim() === '') continue;

          const nomeNorm = row[0].toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/\s+/g,' ').trim();

          // Busca exata ou parcial
          let item = itemMap[nomeNorm];
          if (!item) {
            item = Object.entries(itemMap).find(([k]) =>
              nomeNorm.startsWith(k.slice(0,8)) || k.startsWith(nomeNorm.slice(0,8))
            )?.[1];
          }
          if (!item) continue;

          // Aplica valores dos meses
          let algumValor = false;
          Object.entries(colMeses).forEach(([mesKey, ci]) => {
            const raw = (row[ci] || '').replace(/\./g,'').replace(',','.').replace(/[^\d\-\.]/g,'');
            const val = parseFloat(raw);
            if (!isNaN(val)) { item[mesKey] = val; algumValor = true; }
          });

          // Total (última coluna com valor ou coluna 'total')
          if (algumValor) {
            const vals = Object.values(colMeses).map(ci => {
              const raw = (row[ci]||'').replace(/\./g,'').replace(',','.').replace(/[^\d\-\.]/g,'');
              return parseFloat(raw) || 0;
            });
            item.total = vals.reduce((s,v)=>s+v,0);
            atualizados++;
            log.push(item.nome);
          }
        }

        syncSetProgress(90, 'Salvando no Supabase...');
        await sbStorage.set('consolidado_dados', JSON.stringify(dadosFinanceiros));
        syncMarcarFeito();

        // Refresh
        showTab(document.querySelector('.tab-btn.active')?.textContent?.toLowerCase() || 'receitas');
        renderComissao();
        syncSetProgress(null);

        if (atualizados === 0) {
          syncSetStatus(`⚠️ Arquivo lido mas nenhuma categoria foi reconhecida. Verifique se os nomes batem com o sistema.`, 'warn');
        } else {
          syncSetStatus(`✅ ${atualizados} categorias atualizadas via ${fonte}: ${log.slice(0,4).join(', ')}${log.length>4?'...':''}`, 'ok');
        }

      } catch(err) {
        syncSetProgress(null);
        syncSetStatus(`❌ Erro: ${err.message}`, 'erro');
        console.error('CSV parse error:', err);
      }
    }

    // Auto-fetch na primeira visita do dia
    const DADOS_VERSION = '2026-v9'; // Incrementar sempre que os dados hardcoded mudarem

    async function consolidadoInicializar() {
      syncAtualizarStatusUI();

      // Restaura dados salvos do Supabase
      try {
        const savedVersion = await sbStorage.get('consolidado_versao');
        const saved = await sbStorage.get('consolidado_dados');

        if (savedVersion === DADOS_VERSION && saved) {
          const parsed = JSON.parse(saved);
          Object.assign(dadosFinanceiros, parsed);
          syncSetStatus(`✅ Dados carregados do Supabase (versão ${DADOS_VERSION})`, 'ok');
        } else {
          // Versão nova — salva versão atual, usa dados hardcoded
          await sbStorage.set('consolidado_versao', DADOS_VERSION);
          syncSetStatus('⚡ Dados atualizados. Faça upload do XLSX para sincronizar meses futuros.', 'info');
        }
      } catch(e) {
        console.warn('consolidadoInicializar erro:', e);
      }
    }

    // ==================== INIT ====================
    document.addEventListener('DOMContentLoaded', async () => {
      // Define mês e ano atual como padrão nos seletores da Comissão
      const hoje = new Date();
      const mesFiltro = document.getElementById('comissaoMesFiltro');
      const anoFiltro = document.getElementById('comissaoAnoFiltro');
      if (mesFiltro) mesFiltro.value = String(hoje.getMonth()); // 0=Jan, 1=Fev...
      if (anoFiltro) anoFiltro.value = String(hoje.getFullYear());
      const opMesFiltro = document.getElementById('opMesFiltro');
      const opAnoFiltro = document.getElementById('opAnoFiltro');
      if (opMesFiltro) opMesFiltro.value = String(hoje.getMonth());
      if (opAnoFiltro) opAnoFiltro.value = String(hoje.getFullYear());

      await carregarParams();
      renderizarGraficos();
      consolidadoInicializar();
      initParamFormatting();
    });
    // ==================== COMISSÃO OPERACIONAL ====================
    function renderComissaoOp() {
      const mesIdx  = parseInt(document.getElementById('opMesFiltro')?.value || '0');
      const ano     = parseInt(document.getElementById('opAnoFiltro')?.value || '2026');
      const MESES   = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
      const MESES_N = ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
      const mesKey  = MESES[mesIdx];
      const mesNome = MESES_N[mesIdx];
      const fc  = v => v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
      const fp  = v => (v*100).toFixed(2).replace('.',',') + '%';
      // getParam usa parseParamValue — lida corretamente com "0,0600%" → 0.06
      const gpPct = id => getParam(id, 0) / 100;  // campo em % (ex: 0.06) → decimal (0.0006)
      const gp    = id => getParam(id, 0);

      const lbl = document.getElementById('opMesLabel');
      if(lbl) lbl.textContent = mesNome + ' ' + ano;

      // === PARÂMETROS (lidos da aba Parâmetros) ===
      const META_OS_PF      = gpPct('op_metaOsPf');
      const META_OS_PJ      = gpPct('op_metaOsPj');
      const META_CHURN_PF   = gpPct('op_metaChurnPf');
      const META_CHURN_PJ   = gpPct('op_metaChurnPj');
      const META_RETIRADAS  = gpPct('op_metaRetiradas');
      const TICKET_PF       = gp('op_ticketPf');
      const TICKET_PJ       = gp('op_ticketPj');
      const EQUIPAMENTO     = gp('op_equipamento') || 250;  // R$ por retirada

      const PREMIO_OS_PF    = gpPct('op_premioOsPf');    // 0.060% → divide by 100 via gpPct
      const PREMIO_OS_PJ    = gpPct('op_premioOsPj');
      const PREMIO_CHURN_PF = gpPct('op_premioChurnPf');
      const PREMIO_CHURN_PJ = gpPct('op_premioChurnPj');
      const PREMIO_RETIRADAS= gpPct('op_premioRetiradas');
      const PREMIO_RES_POS  = gpPct('op_premioResPos');
      const PREMIO_RES_NEG  = gpPct('op_premioResNeg');
      const PREMIO_EBITDA_MOV= gpPct('op_premioEbitdaMov');

      const META_RESULT_TRIM  = gp('op_metaResultTrim');
      const META_CHURN_FIN_TRIM = gpPct('op_metaChurnFinTrim');
      const Q = [1,2,3,4];
      const META_MAT_EQUIP_Q  = Q.map(q => gpPct('op_metaMatEquip_q'+q));
      const META_FOLHA_Q      = Q.map(q => gpPct('op_metaFolha_q'+q));
      const PREMIO_RESULT_TRIM  = gpPct('op_premioResultTrim');
      const PREMIO_CHURN_FIN_TRIM= gpPct('op_premioChurnFinTrim');
      const PREMIO_MAT_TRIM     = gpPct('op_premioMatEquipTrim');
      const PREMIO_FOLHA_TRIM   = gpPct('op_premioFolhaTrim');
      const PREMIO_EBITDA_TRIM  = gpPct('op_premioEbitdaTrim');

      // === FLUXO DE CAIXA ===
      const ebitdaItem = dadosFinanceiros?.ebitda_ajustado?.find(r => r.nome === 'EBITDA (Ajustado)');
      const ebitda = ebitdaItem ? (ebitdaItem[mesKey] || 0) : 0;
      const fat    = dadosFinanceiros?.receitas?.reduce((s,r)=> s + (r[mesKey]||0), 0) || 0;
      // Meta EBITDA Móvel mensal (% — usa metaEbitda_ da aba Parâmetros)
      const metaEbitdaMov = parseFloat(document.getElementById('metaEbitda_'+mesKey)?.value || '0') / 100;
      const ebitdaPct     = fat > 0 ? ebitda / fat : 0;

      // Mat-Equip = Kit Instalação + Materiais de Rede + Man. Equipamento + Moveis e equip. TI
      const MAT_EQUIP_NOMES = ['Kit Instalação','Materiais de Rede','Man. Equipamento','Moveis e equipamentos escritório TI'];
      const matEquip = dadosFinanceiros?.custos?.filter(c=>MAT_EQUIP_NOMES.includes(c.nome))
                        .reduce((s,c)=>s+(c[mesKey]||0),0) || 0;
      const folhaItem = dadosFinanceiros?.custos?.find(c=>c.nome==='Folha - Direta');
      const folha = folhaItem ? (folhaItem[mesKey]||0) : 0;

      (async () => {
        try {
        const dirEntry = await getDiretoriaDados(mesIdx, ano);
        const D = (dirEntry && dirEntry.dados) ? dirEntry.dados : {};
        const get = (k, fb=0) => (D[k] !== null && D[k] !== undefined && D[k] !== '') ? +D[k] : fb;
        // Reajuste: usa campo dedicado (Parâmetros), fallback para PDF
        const reajusteDedicado = await getReajusteMes(mesIdx);

        const base_pf      = get('base_pf');
        const base_pj      = get('base_pj');
        const base_isentos = get('base_isentos');
        const contratos    = get('contratos', base_pf + base_pj);
        const os_pf        = get('os_pf');
        const os_pj        = get('os_pj');
        const canc_pf      = get('canc_pf');
        const canc_pj      = get('canc_pj');
        const retiradas    = get('retiradas');
        const canc_sr      = get('canc_sr');   // Canc. S/ Retirada
        const canc_1a      = get('canc_1a');   // Canc. 1a Mensalidade
        const reat_ret     = get('reat_ret');  // Reativações Retirada
        const nn_pf        = get('nn_pf');
        const nn_pj        = get('nn_pj');
        const upgrade      = get('upgrade');
        const reat         = get('reat');
        const val_canc_pf  = get('val_canc_pf', canc_pf * TICKET_PF);
        const val_canc_pj  = get('val_canc_pj', canc_pj * TICKET_PJ);
        const downgrade    = Math.abs(get('downgrade'));  // sempre positivo
        const reajuste_op  = reajusteDedicado > 0 ? reajusteDedicado : (D['reajuste'] != null ? +D['reajuste'] : 0);

        // === INDICADORES ===
        const pct_os_pf     = contratos  > 0 ? os_pf   / contratos : 0;
        const pct_os_pj     = base_pj    > 0 ? os_pj   / base_pj   : 0;
        const pct_churn_pf  = base_pf    > 0 ? canc_pf / base_pf   : 0;
        const pct_churn_pj  = base_pj    > 0 ? canc_pj / base_pj   : 0;
        const total_canc_qtd= canc_pf + canc_pj;
        // % Retiradas = Retiradas / (Canc.PF + Canc.PJ - Canc.S/Retirada - Reativação)
        // Fórmula planilha: =IF(B22=0,0,B22/(B18+B20-Base!B18-Base!B19))
        const denom_retiradas = Math.max(total_canc_qtd - canc_sr - reat_ret, 0);
        const pct_retiradas = denom_retiradas > 0 ? retiradas / denom_retiradas : 0;

        // Churn Financeiro = valor cancelado / faturamento base
        const churnFin = fat > 0 ? (val_canc_pf + val_canc_pj) / fat : 0;

        // Resultado R$
        const nn_total   = nn_pf + nn_pj + upgrade + reat + reajuste_op;
        const canc_total = val_canc_pf + val_canc_pj + downgrade;
        const resultado  = nn_total - canc_total;

        // === COMISSÕES MENSAIS ===
        const comOS_PF    = pct_os_pf    <= META_OS_PF    ? ebitda * PREMIO_OS_PF    : 0;
        const comOS_PJ    = pct_os_pj    <= META_OS_PJ    ? ebitda * PREMIO_OS_PJ    : 0;
        const comChurn_PF = pct_churn_pf <= META_CHURN_PF ? ebitda * PREMIO_CHURN_PF : 0;
        const comChurn_PJ = pct_churn_pj <= META_CHURN_PJ ? ebitda * PREMIO_CHURN_PJ : 0;
        // Retiradas: =IF(pct%>=meta, pct%*Premio*Equipamento*qtd, 0)  [planilha: B23*Q11*P12*B22]
        const comRetiradas = pct_retiradas >= META_RETIRADAS
          ? pct_retiradas * PREMIO_RETIRADAS * EQUIPAMENTO * retiradas : 0;
        const comResPOS   = resultado > 0 ? resultado * PREMIO_RES_POS : 0;
        const comResNEG   = resultado < 0 ? Math.abs(resultado) * PREMIO_RES_NEG * -1 : 0;
        // 1a Mensalidade: penalidade se % canc 1a > 2,7% de contratos
        // Planilha: =IF(B25>P13, B25*Q13*B26, 0) onde Q13=-0.05
        const META_1A_MENS  = gpPct('op_meta1aMens') || 0.027;
        const PREMIO_1A_MENS = -0.05;
        const pct_1a  = contratos > 0 ? canc_1a / contratos : 0;
        const com1aMens = pct_1a > META_1A_MENS
          ? pct_1a * PREMIO_1A_MENS * nn_total : 0;
        // EBITDA Móvel: só paga se EBITDA% >= meta mensal  [planilha: IF(B41>=B42, B40*Q16, 0)]
        const comEbitda = (metaEbitdaMov > 0 && ebitdaPct >= metaEbitdaMov)
          ? ebitda * PREMIO_EBITDA_MOV : 0;
        const totalMensal = comOS_PF + comOS_PJ + comChurn_PF + comChurn_PJ +
                            comRetiradas + comResPOS + comResNEG + com1aMens + comEbitda;

        // === BÔNUS TRIMESTRAL ===
        const TRIMS = [
          {n:'1º Trim',meses:['jan','fev','mar'],idx:[0,1,2],qi:0},
          {n:'2º Trim',meses:['abr','mai','jun'],idx:[3,4,5], qi:1},
          {n:'3º Trim',meses:['jul','ago','set'],idx:[6,7,8], qi:2},
          {n:'4º Trim',meses:['out','nov','dez'],idx:[9,10,11],qi:3},
        ];
        const trim = TRIMS.find(t => t.idx.includes(mesIdx));
        const isTrimFim = trim && trim.idx[2] === mesIdx;
        const mesesAte  = trim ? trim.meses.slice(0, trim.idx.indexOf(mesIdx)+1) : [];

        const soma = (cat, nome, ms) => ms.reduce((s,m) => {
          const item = dadosFinanceiros?.[cat]?.find(r=>r.nome===nome);
          return s + (item ? (item[m]||0) : 0);
        }, 0);
        const somaMulti = (cat, nomes, ms) => ms.reduce((s,m) => {
          return s + (dadosFinanceiros?.[cat]?.filter(r=>nomes.includes(r.nome)).reduce((a,r)=>a+(r[m]||0),0)||0);
        }, 0);

        const ebitdaAcum    = soma('ebitda_ajustado','EBITDA (Ajustado)', mesesAte);
        const fatAcum       = mesesAte.reduce((s,m)=>s+(dadosFinanceiros?.receitas?.reduce((a,r)=>a+(r[m]||0),0)||0),0);
        const matEquipAcum  = somaMulti('custos', MAT_EQUIP_NOMES, mesesAte);
        const folhaAcum     = soma('custos','Folha - Direta', mesesAte);

        // Acumula resultado do trimestre lendo PDF de cada mês (simplificado: usa valor do mês atual * nMeses)
        const nMeses        = mesesAte.length;
        const resultadoAcum = resultado * nMeses;  // aproximação; idealmente buscaria cada mês

        const qi = trim ? trim.qi : 0;
        const metaMatEquip  = META_MAT_EQUIP_Q[qi] || 0;
        const metaFolha     = META_FOLHA_Q[qi] || 0;
        const matEquipPct   = fatAcum > 0 ? matEquipAcum / fatAcum : 0;
        const folhaPct      = fatAcum > 0 ? folhaAcum    / fatAcum : 0;

        // Churn Fin acumulado trimestre
        // Simplificado: média dos meses disponíveis
        const churnFinAcum  = churnFin;  // usa o do mês atual

        const bonResOk    = isTrimFim && resultadoAcum >= META_RESULT_TRIM;
        const bonChurnOk  = isTrimFim && churnFinAcum  <= META_CHURN_FIN_TRIM;
        const bonMatOk    = isTrimFim && metaMatEquip > 0 && matEquipPct <= metaMatEquip;
        const bonFolhaOk  = isTrimFim && metaFolha    > 0 && folhaPct    <= metaFolha;
        const bonEbitdaOk = isTrimFim && ebitdaAcum > 0;  // Ebitda sempre pago se positivo no fim do trim

        const bonRes    = bonResOk    ? ebitdaAcum * PREMIO_RESULT_TRIM   : 0;
        const bonChurn  = bonChurnOk  ? ebitdaAcum * PREMIO_CHURN_FIN_TRIM: 0;
        const bonMat    = bonMatOk    ? ebitdaAcum * PREMIO_MAT_TRIM      : 0;
        const bonFolha  = bonFolhaOk  ? ebitdaAcum * PREMIO_FOLHA_TRIM    : 0;
        const bonEbitda = bonEbitdaOk ? ebitdaAcum * PREMIO_EBITDA_TRIM   : 0;
        const totalTrim = bonRes + bonChurn + bonMat + bonFolha + bonEbitda;

        // ======== HELPERS DE RENDER ========
        const badge = (ok, tOk, tNo) =>
          `<span style="background:${ok?'#d1fae5':'#fee2e2'};color:${ok?'#065f46':'#991b1b'};padding:0.2rem 0.65rem;border-radius:12px;font-size:0.78rem;font-weight:700">${ok?'✓ '+tOk:'✗ '+tNo}</span>`;

        const rowInd = (icon, label, qtd, meta, real, ok, isMax=true) => {
          const dir = isMax ? '≤' : '≥';
          return `<div style="background:${ok?'#f0fdf4':'#fff7f7'};border:1px solid ${ok?'#bbf7d0':'#fecaca'};border-radius:12px;padding:1rem 1.25rem;display:flex;justify-content:space-between;align-items:center;gap:1rem">
            <div style="display:flex;align-items:center;gap:0.75rem">
              <span style="font-size:1.4rem">${icon}</span>
              <div>
                <div style="font-weight:700;color:#1e293b;font-size:0.92rem">${label} <span style="font-weight:400;color:#64748b;font-size:0.8rem">(${qtd})</span></div>
                <div style="font-size:0.8rem;color:#64748b;margin-top:0.1rem">Meta ${dir} <strong>${fp(meta)}</strong> &nbsp;|&nbsp; Real: <strong>${fp(real)}</strong></div>
              </div>
            </div>
            ${badge(ok,'Meta atingida','Fora da meta')}
          </div>`;
        };

        const rowComissao = (label, valor, ok, detalhe='') =>
          `<div style="display:flex;justify-content:space-between;align-items:center;padding:0.75rem 1rem;border-radius:10px;background:${ok?'#f0fdf4':valor<0?'#fff7f7':'#f8fafc'};margin-bottom:0.5rem">
            <div>
              <span style="font-weight:600;color:#1e293b;font-size:0.9rem">${label}</span>
              ${detalhe?`<span style="font-size:0.75rem;color:#64748b;margin-left:0.5rem">${detalhe}</span>`:''}
            </div>
            <strong style="color:${valor===0?'#94a3b8':ok?'#065f46':'#dc2626'};font-size:0.95rem">${fc(valor)}</strong>
          </div>`;

        const rowLine = (label, valor, cor='#374151', hint='') =>
          `<div style="display:flex;justify-content:space-between;align-items:center;padding:0.6rem 0;border-bottom:1px solid #f1f5f9">
            <span style="color:#374151;font-size:0.88rem">${label}${hint ? ` <em style="font-size:0.73rem;color:#94a3b8;font-style:italic">${hint}</em>` : ''}</span>
            <strong style="color:${cor}">${fc(valor)}</strong>
          </div>`;

        const bonCard = (icon, titulo, metaStr, realStr, premio, ok) => {
          const wait = !isTrimFim;
          return `<div style="background:${ok?'#f0fdf4':wait?'#fefce8':'#fff7f7'};border:1px solid ${ok?'#bbf7d0':wait?'#fde68a':'#fecaca'};border-radius:14px;padding:1.25rem">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:0.75rem">
              <span style="font-size:1.1rem">${icon}</span>
              ${ok?badge(true,'Atingido',''):wait?'<span style="background:#fef3c7;color:#92400e;padding:0.2rem 0.6rem;border-radius:12px;font-size:0.75rem;font-weight:700">⏳ Aguardando fim do trimestre</span>':badge(false,'','Não atingido')}
            </div>
            <div style="font-weight:700;color:#1e293b;margin-bottom:0.35rem;font-size:0.92rem">${titulo}</div>
            <div style="font-size:0.8rem;color:#64748b">Meta: ${metaStr} &nbsp;|&nbsp; Real: ${realStr}</div>
            <div style="margin-top:0.75rem;font-size:1.1rem;font-weight:800;color:${ok?'#065f46':'#94a3b8'}">${fc(premio)}</div>
          </div>`;
        };

        // ── Indicadores ──
        document.getElementById('opIndicadores').innerHTML =
          rowInd('📞','OS Suporte PF', os_pf+' OS',     META_OS_PF,   pct_os_pf,    pct_os_pf  <=META_OS_PF)  +
          rowInd('📞','OS Suporte PJ', os_pj+' OS',     META_OS_PJ,   pct_os_pj,    pct_os_pj  <=META_OS_PJ)  +
          rowInd('📉','Churn PF',      canc_pf+' canc.',META_CHURN_PF,pct_churn_pf, pct_churn_pf<=META_CHURN_PF)+
          rowInd('📉','Churn PJ',      canc_pj+' canc.',META_CHURN_PJ,pct_churn_pj, pct_churn_pj<=META_CHURN_PJ)+
          rowInd('↩️','Retiradas', retiradas+' ret.',META_RETIRADAS,pct_retiradas,pct_retiradas>=META_RETIRADAS,false)+
          `<div style="background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:1rem 1.25rem">
            <div style="font-size:0.75rem;color:#64748b;margin-bottom:0.5rem;font-weight:600">📋 BASE DE CLIENTES</div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.4rem;font-size:0.85rem">
              <span>👤 PF: <strong>${base_pf.toLocaleString('pt-BR')}</strong></span>
              <span>🏢 PJ: <strong>${base_pj.toLocaleString('pt-BR')}</strong></span>
              <span>🆓 Isentos: <strong>${base_isentos.toLocaleString('pt-BR')}</strong></span>
              <span>📋 Contratos: <strong>${contratos.toLocaleString('pt-BR')}</strong></span>
            </div>
          </div>` +
          `<div style="background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:1rem 1.25rem">
            <div style="font-size:0.75rem;color:#64748b;margin-bottom:0.5rem;font-weight:600">📊 FLUXO DE CAIXA — ${mesNome}</div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.4rem;font-size:0.85rem">
              <span>💰 Faturamento: <strong>${fc(fat)}</strong></span>
              <span>📊 EBITDA Aj.: <strong>${fc(ebitda)}</strong></span>
              <span>🔧 Mat-Equip: <strong>${fc(matEquip)}</strong> <em style="color:#64748b">(${fp(fat>0?matEquip/fat:0)})</em></span>
              <span>👥 Folha: <strong>${fc(folha)}</strong> <em style="color:#64748b">(${fp(fat>0?folha/fat:0)})</em></span>
            </div>
          </div>`;

        // ── Novos Negócios ──
        document.getElementById('opNovosNegocios').innerHTML =
          rowLine('Novos PF', nn_pf, '#065f46') +
          rowLine('Novos PJ', nn_pj, '#065f46') +
          rowLine('UpGrade', upgrade, '#065f46') +
          rowLine('Reativação', reat, '#065f46') +
          (reajuste_op > 0 ? rowLine('Reajuste Contratos', reajuste_op, '#065f46') : '') +
          `<div style="display:flex;justify-content:space-between;padding:0.75rem 0;font-size:0.95rem">
            <strong style="color:#065f46">TOTAL NOVOS</strong>
            <strong style="color:#065f46">${fc(nn_total)}</strong>
          </div>`;

        // ── Cancelamentos ──
        document.getElementById('opCancelamentos').innerHTML =
          rowLine('Cancelamentos PF', val_canc_pf, '#991b1b') +
          rowLine('Cancelamentos PJ', val_canc_pj, '#991b1b') +
          rowLine('DownGrade', downgrade, '#991b1b') +  /* downgrade já é positivo via Math.abs */
          `<div style="display:flex;justify-content:space-between;padding:0.75rem 0;font-size:0.95rem">
            <strong style="color:#991b1b">TOTAL CANC.</strong>
            <strong style="color:#991b1b">${fc(canc_total)}</strong>
          </div>`;

        // ── Resultado ──
        const resOk = resultado > 0;
        document.getElementById('opResultadoCard').innerHTML =
          `<div style="background:${resOk?'linear-gradient(135deg,#065f46,#059669)':'linear-gradient(135deg,#991b1b,#dc2626)'};border-radius:16px;padding:1.25rem 1.75rem;color:white;display:flex;justify-content:space-between;align-items:center">
            <div>
              <div style="font-size:0.85rem;opacity:0.85;font-weight:600">${resOk?'📈':'📉'} RESULTADO LÍQUIDO (Novos − Cancelamentos)</div>
              <div style="font-size:1.75rem;font-weight:800;margin-top:0.25rem">${fc(resultado)}</div>
            </div>
            <div style="text-align:right;font-size:0.82rem;opacity:0.85">
              <div>Novos: ${fc(nn_total)}</div>
              <div>Canc.: ${fc(canc_total)}</div>
              <div style="margin-top:0.35rem">Churn Fin.: <strong>${fp(churnFin)}</strong></div>
            </div>
          </div>`;

        // ── Comissões Mensais ──
        document.getElementById('opComissoesMensais').innerHTML =
          rowComissao('OS Suporte PF',     comOS_PF,    pct_os_pf   <=META_OS_PF,    fp(PREMIO_OS_PF)+'% EBITDA') +
          rowComissao('OS Suporte PJ',     comOS_PJ,    pct_os_pj   <=META_OS_PJ,    fp(PREMIO_OS_PJ)+'% EBITDA') +
          rowComissao('Churn PF',          comChurn_PF, pct_churn_pf<=META_CHURN_PF,  fp(PREMIO_CHURN_PF)+'% EBITDA') +
          rowComissao('Churn PJ',          comChurn_PJ, pct_churn_pj<=META_CHURN_PJ,  fp(PREMIO_CHURN_PJ)+'% EBITDA') +
          rowComissao('Retiradas',         comRetiradas,pct_retiradas>=META_RETIRADAS,fp(PREMIO_RETIRADAS)+'% EBITDA') +
          rowComissao('Resultado Positivo',comResPOS,   comResPOS>0, fp(PREMIO_RES_POS)+'% do resultado') +
          rowComissao('Resultado Negativo',comResNEG,   false,       '-'+fp(PREMIO_RES_NEG)+'% do resultado') +
          rowComissao('1a Mensalidade (penalidade)', com1aMens, com1aMens===0, pct_1a<=META_1A_MENS ? '✓ Dentro do limite ('+fp(META_1A_MENS)+')' : '-5% Novos Negócios') +
          rowComissao('EBITDA Móvel',      comEbitda,   comEbitda>0, fp(PREMIO_EBITDA_MOV)+'% EBITDA');

        document.getElementById('opTotalMensal').innerHTML =
          `<div style="background:linear-gradient(135deg,#1e3a8a,#7c3aed);border-radius:14px;padding:1.25rem 1.75rem;color:white;display:flex;justify-content:space-between;align-items:center">
            <div style="font-size:0.9rem;font-weight:600;opacity:0.9">💼 TOTAL MENSAL — ${mesNome} ${ano}</div>
            <div style="font-size:1.6rem;font-weight:800">${fc(totalMensal)}</div>
          </div>`;

        // ── Bônus Trimestral ──
        const trimNome = trim ? trim.n : '';
        document.getElementById('opBonusTrimestral').innerHTML =
          bonCard('📊','Resultado Acumulado ≥ '+fc(META_RESULT_TRIM),
            fc(META_RESULT_TRIM), fc(resultadoAcum), bonRes, bonResOk) +
          bonCard('📉','Churn Financeiro Acumulado ≤ '+fp(META_CHURN_FIN_TRIM),
            fp(META_CHURN_FIN_TRIM), fp(churnFinAcum), bonChurn, bonChurnOk) +
          bonCard('🔧', 'Mat-Equip % Fat. ≤ '+fp(metaMatEquip),
            fp(metaMatEquip), fp(matEquipPct), bonMat, bonMatOk) +
          bonCard('👥','Folha % Fat. ≤ '+fp(metaFolha),
            fp(metaFolha), fp(folhaPct), bonFolha, bonFolhaOk) +
          bonCard('💹','EBITDA Trim. positivo',
            '> 0', fc(ebitdaAcum), bonEbitda, bonEbitdaOk);

        if(isTrimFim) {
          document.getElementById('opBonusTrimestral').innerHTML +=
            `<div style="grid-column:1/-1;background:linear-gradient(135deg,#d97706,#f59e0b);border-radius:14px;padding:1.25rem 1.75rem;color:white;display:flex;justify-content:space-between;align-items:center">
              <div style="font-size:0.9rem;font-weight:600;opacity:0.9">🏅 TOTAL BÔNUS TRIMESTRAL — ${trimNome}</div>
              <div style="font-size:1.6rem;font-weight:800">${fc(totalTrim)}</div>
            </div>`;
        }

        } catch(err) {
          console.error('renderComissaoOp erro:', err);
          ['opIndicadores','opNovosNegocios','opCancelamentos','opResultadoCard',
           'opComissoesMensais','opTotalMensal','opBonusTrimestral'].forEach(id => {
            const el = document.getElementById(id);
            if(el && !el.innerHTML) el.innerHTML = '<div style="color:#dc2626;padding:1rem">Erro: '+err.message+'</div>';
          });
        }
      })(); // end async
    }


    // ═══════════════════════════════════════════════════════
    // MARCOS — IA por aba
    // ═══════════════════════════════════════════════════════
    let marcosContext = 'dashboard';
    let marcosHistory = [];

    function abrirMarcos(context) {
      marcosContext = context;
      const modal = document.getElementById('marcosModal');
      modal.classList.add('open');
      const subtitles = {
        dashboard:    '💰 Analisando Dashboard',
        financeiro:   '💼 Analisando Comissão Financeiro',
        operacional:  '📈 Analisando Comissão Operacional'
      };
      document.getElementById('marcosPanelSubtitle').textContent = subtitles[context] || 'Análise em andamento';
      if(marcosHistory.length === 0) marcosAnalisarAba();
    }

    function fecharMarcos() {
      document.getElementById('marcosModal').classList.remove('open');
    }

    function marcosMontarContexto() {
      const df = dadosFinanceiros;
      const MESES = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
      const MESES_N = ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
      const fc = v => 'R$ '+Number(v).toLocaleString('pt-BR',{minimumFractionDigits:2,maximumFractionDigits:2});
      const fp = v => (Number(v)*100).toFixed(2)+'%';

      if(marcosContext === 'dashboard') {
        const mesIdx = parseInt(document.getElementById('dashMesFiltro')?.value||'0');
        const mesKey = MESES[mesIdx];
        const mesNome = MESES_N[mesIdx];
        const receitas = df.receitas?.reduce((s,r)=>s+(r[mesKey]||0),0)||0;
        const custos   = df.custos?.reduce((s,r)=>s+(r[mesKey]||0),0)||0;
        const despesas = df.despesas?.reduce((s,r)=>s+(r[mesKey]||0),0)||0;
        const impostos = df.impostos?.reduce((s,r)=>s+(r[mesKey]||0),0)||0;
        const ebitdaItem = df.ebitda_ajustado?.find(r=>r.nome==='EBITDA (Ajustado)');
        const ebitda = ebitdaItem ? (ebitdaItem[mesKey]||0) : 0;
        const lines = ['=== DASHBOARD FINANCEIRO — '+mesNome+'/2026 ===',
          'Receitas: '+fc(receitas), 'Impostos: '+fc(impostos),
          'Custos: '+fc(custos), 'Despesas: '+fc(despesas),
          'EBITDA Ajustado: '+fc(ebitda)+' ('+fp(receitas>0?ebitda/receitas:0)+')',
          '', '--- RECEITAS DETALHADAS ---'];
        (df.receitas||[]).filter(r=>(r[mesKey]||0)>0).forEach(r=>lines.push(r.nome+': '+fc(r[mesKey])));
        lines.push('', '--- TOP 8 CUSTOS ---');
        [...(df.custos||[])].sort((a,b)=>(b[mesKey]||0)-(a[mesKey]||0)).slice(0,8).forEach(c=>lines.push(c.nome+': '+fc(c[mesKey]||0)));
        return lines.join('\n');
      }

      if(marcosContext === 'financeiro') {
        const mesIdx = parseInt(document.getElementById('comissaoMesFiltro')?.value||'0');
        const mesKey = MESES[mesIdx];
        const mesNome = MESES_N[mesIdx];
        const receitas = df.receitas?.reduce((s,r)=>s+(r[mesKey]||0),0)||0;
        const ebitdaItem = df.ebitda_ajustado?.find(r=>r.nome==='EBITDA (Ajustado)');
        const ebitda = ebitdaItem?(ebitdaItem[mesKey]||0):0;
        const lines = ['=== COMISSÃO FINANCEIRO — '+mesNome+'/2026 ===',
          'Faturamento Base: '+fc(receitas),
          'EBITDA Ajustado: '+fc(ebitda)+' (margem '+fp(receitas>0?ebitda/receitas:0)+')',
          '', '--- DADOS DE COMISSÃO ---'];
        // Collect visible comissão rows from DOM
        document.querySelectorAll('#comissaoFinanceiroView .comissao-row, #comissaoFinanceiroView [data-indicador]').forEach(el=>{
          lines.push(el.innerText?.replace(/\s+/g,' ').trim());
        });
        // fallback: get table text
        const tbl = document.querySelector('#comissaoFinanceiroView .comissao-matrix, #comissaoFinanceiroView table');
        if(tbl) lines.push('', '--- MATRIZ ---', tbl.innerText?.replace(/\t/g,' | ').trim());
        return lines.join('\n');
      }

      if(marcosContext === 'operacional') {
        const mesIdx = parseInt(document.getElementById('opMesFiltro')?.value||'0');
        const mesKey = MESES[mesIdx];
        const mesNome = MESES_N[mesIdx];
        const lines = ['=== COMISSÃO OPERACIONAL — '+mesNome+'/2026 ==='];
        const view = document.getElementById('comissaoOperacionalView');
        if(view) lines.push(view.innerText?.replace(/\s{3,}/g,'\n').trim().slice(0,3000));
        return lines.join('\n');
      }

      return 'Contexto não identificado.';
    }

    async function marcosAnalisarAba() {
      const apiKey = localStorage.getItem('openaiKey')||'';
      if(!apiKey || !apiKey.startsWith('sk-')) {
        marcosAddMsg('bot', 'Oi! Para eu funcionar, você precisa configurar sua **API Key do ChatGPT** na aba 🤖 Estratégico. É só colar lá e salvar!');
        return;
      }
      const ctx = marcosMontarContexto();
      const tabNames = {dashboard:'Dashboard Financeiro', financeiro:'Comissão Financeiro', operacional:'Comissão Operacional'};
      const prompts = {
        dashboard: 'Faça uma análise executiva completa do Dashboard Financeiro da TEXNET. Destaque: pontos fortes, pontos de atenção, a margem EBITDA vs benchmark ISP (25-35%), os maiores custos e 3 recomendações práticas. Seja direto e use markdown.',
        financeiro: 'Analise a Comissão Financeiro da TEXNET. Avalie cada indicador de comissão, quais metas foram atingidas ou não, qual o total da comissão calculada e o que poderia ser melhorado para aumentar o resultado. Use markdown com seções claras.',
        operacional: 'Analise a Comissão Operacional da TEXNET. Avalie os indicadores de OS, Churn, Retiradas e resultados. Identifique onde estão os pontos críticos, o que está bem e o que precisa de atenção. Dê recomendações operacionais concretas.'
      };
      const typing = marcosAddTyping();
      try {
        const res = await fetch('https://api.openai.com/v1/chat/completions', {
          method:'POST',
          headers:{'Content-Type':'application/json','Authorization':'Bearer '+apiKey},
          body: JSON.stringify({
            model:'gpt-4o', max_tokens:1500, temperature:0.7,
            messages:[
              {role:'system', content:'Você é Marcos, analista financeiro senior especialista em ISPs brasileiro. Responda sempre em português do Brasil com markdown formatado. Seja direto, cite os números reais e use emojis com moderação.'},
              {role:'user', content: prompts[marcosContext]+'\n\nDADOS DA ABA:\n'+ctx}
            ]
          })
        });
        typing.remove();
        if(!res.ok) { const e=await res.json().catch(()=>({})); throw new Error(e.error?.message||'Erro '+res.status); }
        const data = await res.json();
        const texto = data.choices?.[0]?.message?.content||'Sem resposta.';
        marcosHistory.push({role:'assistant',content:texto});
        marcosAddMsg('bot', texto);
      } catch(e) {
        typing.remove();
        marcosAddMsg('bot', 'Erro ao consultar a API: '+e.message);
      }
    }

    async function marcosEnviar() {
      const input = document.getElementById('marcosInput');
      const pergunta = input.value.trim();
      if(!pergunta) return;
      input.value = '';
      const apiKey = localStorage.getItem('openaiKey')||'';
      if(!apiKey || !apiKey.startsWith('sk-')) {
        marcosAddMsg('bot', 'Configure sua API Key na aba 🤖 Estratégico primeiro!');
        return;
      }
      marcosAddMsg('user', pergunta);
      marcosHistory.push({role:'user', content:pergunta});
      const ctx = marcosMontarContexto();
      const typing = marcosAddTyping();
      try {
        const msgs = [
          {role:'system', content:'Você é Marcos, analista financeiro da TEXNET (ISP). Responda em português do Brasil com markdown. Os dados da aba atual:\n\n'+ctx},
          ...marcosHistory.slice(-6)
        ];
        const res = await fetch('https://api.openai.com/v1/chat/completions', {
          method:'POST',
          headers:{'Content-Type':'application/json','Authorization':'Bearer '+apiKey},
          body: JSON.stringify({model:'gpt-4o', max_tokens:800, temperature:0.7, messages:msgs})
        });
        typing.remove();
        if(!res.ok) { const e=await res.json().catch(()=>({})); throw new Error(e.error?.message||'Erro '+res.status); }
        const data = await res.json();
        const texto = data.choices?.[0]?.message?.content||'Sem resposta.';
        marcosHistory.push({role:'assistant',content:texto});
        marcosAddMsg('bot', texto);
      } catch(e) {
        typing.remove();
        marcosAddMsg('bot', 'Erro: '+e.message);
      }
    }

    function marcosAddMsg(from, text) {
      const container = document.getElementById('marcosMsgs');
      const div = document.createElement('div');
      div.className = from==='bot' ? 'msg-marcos' : 'msg-user';
      div.innerHTML = from==='bot' ? iaMarkdown(text) : text.replace(/&/g,'&amp;').replace(/</g,'&lt;');
      container.appendChild(div);
      container.scrollTop = container.scrollHeight;
      return div;
    }

    function marcosAddTyping() {
      const container = document.getElementById('marcosMsgs');
      const div = document.createElement('div');
      div.className = 'msg-typing';
      div.innerHTML = '<div class="dot-typing" style="animation-delay:0s"></div><div class="dot-typing" style="animation-delay:0.2s"></div><div class="dot-typing" style="animation-delay:0.4s"></div>';
      container.appendChild(div);
      container.scrollTop = container.scrollHeight;
      return div;
    }


    function toggleSidebar() {
      const sb = document.querySelector('.sidebar');
      const ov = document.getElementById('sidebarOverlay');
      const btn = document.getElementById('menuToggle');
      sb.classList.toggle('open');
      ov.classList.toggle('open');
      btn.textContent = sb.classList.contains('open') ? '✕' : '☰';
    }
    // Close sidebar when nav item clicked on mobile
    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', () => {
        if(window.innerWidth <= 768) {
          const sb = document.querySelector('.sidebar');
          if(sb.classList.contains('open')) toggleSidebar();
        }
      });
    });

  </script>  

  <!-- Marcos Modal -->
  <div id="marcosModal" onclick="if(event.target===this)fecharMarcos()">
    <div id="marcosPanel">
      <div id="marcosPanelHeader">
        <div style="width:70px;height:70px;overflow:hidden;border-radius:50%;border:3px solid rgba(255,255,255,0.5);background:rgba(255,255,255,0.05)"><svg width="80" height="128" viewBox="0 0 100 165"><use href="#marcosSymbol"/></svg></div>
        <div>
          <div style="color:white;font-weight:800;font-size:1rem">Marcos</div>
          <div style="color:rgba(255,255,255,0.65);font-size:0.75rem" id="marcosPanelSubtitle">Analisando seus dados...</div>
        </div>
        <button onclick="fecharMarcos()" style="margin-left:auto;background:rgba(255,255,255,0.12);border:1px solid rgba(255,255,255,0.25);color:white;border-radius:8px;padding:0.3rem 0.75rem;cursor:pointer;font-size:0.8rem">✕</button>
      </div>
      <div id="marcosMsgs"></div>
      <div id="marcosChatInput">
        <input id="marcosInput" type="text" placeholder="Pergunte algo sobre esta aba..." onkeydown="if(event.key==='Enter')marcosEnviar()">
        <button onclick="marcosEnviar()">→</button>
      </div>
    </div>
  </div>

</body>
</html>
